
//__________________________________________________________________________________
//__________________________________________________________________________________
//
//								REVISED BARDS
//__________________________________________________________________________________
//__________________________________________________________________________________

/* 
still to do: 
 -- ...have SoB remove the lvl 8/12/16/20 ones; leave the lvl 2 bonus intact

thiefscl:
PP	OL	FT	MS	HiS	DI	ST	Stealth
*/


//COPY MARKER FILE__________________________________________________________________
//
COPY ~might_and_guile/lib/markers/d5_bards.d5~ ~override~
//__________________________________________________________________________________


LAM JOINABLE_NPC_ARRAYS


//BARD ABILITY FILES_________________________________________________________________
//
COPY ~might_and_guile/misc/d5_1hp.spl~ ~override~				//	1 hit point bonus
	SAY NAME1 ~ ~
	SAY UNIDENTIFIED_DESC ~ ~
COPY ~might_and_guile/misc/d5lor05.spl~ ~override~				//	5-point lore bonus
	SAY NAME1 ~ ~
	SAY UNIDENTIFIED_DESC ~ ~
COPY ~might_and_guile/misc/d5lor20.spl~ ~override~				//	20-point lore bonus
	SAY NAME1 ~ ~
	SAY UNIDENTIFIED_DESC ~ ~
COPY ~might_and_guile/misc/d5_bab1.spl~ ~override~				//	thac0 bonus
	SAY NAME1 ~ ~
	SAY UNIDENTIFIED_DESC ~ ~
COPY ~might_and_guile/misc/d5_bab2.spl~ ~override~				//	thac0 bonus
	SAY NAME1 ~ ~
	SAY UNIDENTIFIED_DESC ~ ~
COPY ~might_and_guile/feats/d5_rfe8b.bam~ ~override~
COPY ~might_and_guile/misc/d5swash.spl~ ~override~				//	swashbuckling ability
	SAY NAME1 @3112
	SAY UNIDENTIFIED_DESC @3113
	WRITE_ASCII 0x3a ~d5_rfe8b~ #8
	LPF ALTER_SPELL_HEADER STR_VAR icon = ~d5_rfe8b~ END
COPY ~might_and_guile/misc/d5swshb.eff~ ~override~
COPY ~might_and_guile/misc/d5swshc.spl~ ~override~
COPY ~might_and_guile/misc/d5swshx.spl~ ~override~
	SAY NAME1 @3114
	SAY UNIDENTIFIED_DESC @3114
COPY ~might_and_guile/misc/d5swshx.bam~ ~override~
COPY ~might_and_guile/misc/d5_notu.spl~ ~override~				//	disable turn undead
	SAY NAME1 ~ ~
	SAY UNIDENTIFIED_DESC ~ ~
	
//disable skill buttons_______________________________________________________________
//
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5noppb.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 144 target = 1 parameter2 = 1 timing = 9 END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5nomsb.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 144 target = 1 parameter2 = 0 timing = 9 END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5noftb.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 144 target = 1 parameter2 = 14 timing = 9 END

//base HLA table______________________________________________________________________
//
COPY ~might_and_guile/nubards/lud5brd.2da~ ~override~
//____________________________________________________________________________________


//NEW "TRUECLASS" BARD________________________________________________________________
//
ADD_KIT ~D5_BARD~

//WEAPON PROFICIENCIES________________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_BARD       0 0 0 0 0 0 0 0~
~D5_BARD       0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_BARD    	   0   12  0   9   0   15~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_BARD           0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_BARD           0   17  0   17  0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_BARD  	       0   15  0   15  0   15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_BARD           1  1  1  1  1  1  1  1  1~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_BARD           1  1  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_bard.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_MT_H K_MT_E K_MT_HE K_MT_G~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00800200 13~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21801
SAY @21802
SAY @21803
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21803)
		STR_VAR
			kit_name = D5_BARD
			clswpbon = ~0 0 3~
			sneakatt = ~1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1~
			backstab = ~1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1~
			thiefskl = ~25 15~
			thiefscl = ~100 100 100 0 0 100 0 0~
			clsrcreq = ~1 1 1 0 0 1 0~
	END
END
//___________________________________________________________________________________

//BARD ABILITY FILES_________________________________________________________________
//
COPY_EXISTING ~might_and_guile/nubards/d5_bard.2da~ ~override~
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_bard.2da~) BEGIN
	APPEND ~d5_bard.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________



//ADD BLADE AS MAGE/THIEF_____________________________________________________________
//
ADD_KIT ~D5_BLADE~

//WEAPON PROFICIENCIES________________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_BLADE      0 0 0 0 0 0 0 0~
~D5_BLADE      0 0 0 0 0 0 0 0 0 2 2 0 0 0 2 2 1 1 0 0 1 1 1 1 0 1 1 1 0 0 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_BLADE          9   12  0   9   0   9~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_BLADE          0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_BLADE          0   17  0   17  0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_BLADE          0   15  0   15  0   15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_BLADE          1  1  1  1  1  1  1  1  1~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_BLADE          1  1  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_blade.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_MT_H K_MT_E K_MT_HE~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00800200 13~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21806
SAY @21807
SAY @21808
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21808)
		STR_VAR
			kit_name = D5_BLADE
			sneakatt = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			backstab = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			clswpbon = ~0 0 3~
			thiefskl = ~25 15~
			thiefscl = ~100 100 100 100 100 100 0 0~
			clsrcreq = ~1 1 1 0 0 0 0~
	END
END
//____________________________________________________________________________________

//BLADE ABILITY FILES_________________________________________________________________
//
COPY ~might_and_guile/nubards/d5_blade.2da~ ~override~

//____________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_blade.2da~) BEGIN
	APPEND ~d5_blade.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD JESTER AS MAGE/THIEF_____________________________________________________________
//
ADD_KIT ~D5_JESTER~

//WEAPON PROFICIENCIES________________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_JESTER     0 1 0 0 1 1 1 0~
~D5_JESTER     0 0 0 0 0 0 0 0 1 1 1 1 0 1 1 1 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_JESTER          0   12  0   9   0   12~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_JESTER          0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_JESTER          0   17  0   17  0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_JESTER          0   15  0   15  0   15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_JESTER          0  0  0  1  1  1  1  1  1~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_JESTER          1  0  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_jstr.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_MT_H K_MT_E K_MT_HE K_MT_G~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00800200 13~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21811
SAY @21812
SAY @21813
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21813)
		STR_VAR
			kit_name = D5_JESTER
			clswpbon = ~0 0 3~
			sneakatt = ~1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1~
			backstab = ~1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1~
			thiefskl = ~25 15~
			thiefscl = ~100 100 100 0 0 100 0 0~
			clsrcreq = ~1 1 1 0 0 1 0~
	END
END
//____________________________________________________________________________________

//JESTER ABILITY FILES________________________________________________________________
//
COPY ~might_and_guile/nubards/d5_jstr.2da~ ~override~
//____________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_jstr.2da~) BEGIN
	APPEND ~d5_jstr.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD SKALD AS FIGHTER/MAGE___________________________________________________________
//
ADD_KIT ~D5_SKALD~

//WEAPON PROFICIENCIES________________________________________________________________
//11           	                        T   S           F   Q             S S
//10           	L S                     W   C           L   U             W I
//9            	A M             B L S   O   I   W       A   A             O N
//8            	R A             A O H   H   M   A       I   R C   S       R G
//7            	G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            	E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            	S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            	W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            	O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            	R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            	D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_SKALD       2 2 2 2 2 2 2 2~
~D5_SKALD       0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_SKALD          12  0   0   9   0   12~

//KIT STAT MODIFIERS________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_SKALD          0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT__________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_SKALD          17  0   0   0   0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_SKALD  	       15  0   0   0   0   15~

//ALIGNMENT RESTRICTIONS____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_SKALD          1  1  1  1  1  1  1  1  1~

//DUAL CLASS OPTIONS________________________________________________________________
//                 FT CL MA TH DR RA
~D5_SKALD          0  0  0  0  0  0~

//KIT ABILITIES 2DA FILE____________________________________________________________
~might_and_guile/nubards/d5_skld.2da~

//RACIAL KIT AVAILABILITY___________________________________________________________
~K_FM_D K_FM_H K_FM_HE~

//UNUSABLE FLAGS AND KIT BASE CLASS_________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20, FM = 7, FC = 8, FT = 9, MT = 13, CM = 14, CT = 15, CR = 18
~0x00800200 7~

//HIGH LEVEL ABILITIES ABBREVIATION_________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21816
SAY @21817
SAY @21818
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21818)
		STR_VAR
			kit_name = D5_SKALD
			clswpbon = ~1 0 3~
			hpclass = ~HPFT~
			clsrcreq = ~1 1 1 0 0 0 0~
	END
END
//___________________________________________________________________________________

//SKALD ABILITY FILES________________________________________________________________
//
COPY ~might_and_guile/nubards/d5_skld.2da~ ~override~
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_skld.2da~) BEGIN
	APPEND ~d5_skld.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD GALLANT AS FIGHTER/MAGE________________________________________________________
//
ADD_KIT ~D5_GALLANT~

//WEAPON PROFICIENCIES_______________________________________________________________
//11           	                        T   S           F   Q             S S
//10           	L S                     W   C           L   U             W I
//9            	A M             B L S   O   I   W       A   A             O N
//8            	R A             A O H   H   M   A       I   R C   S       R G
//7            	G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            	E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            	S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            	W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            	O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            	R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            	D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_GALLANT     2 2 2 2 2 2 2 2~
~D5_GALLANT     0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_GALLANT        0   0   12  0   0   15~

//KIT STAT MODIFIERS________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_GALLANT        0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT__________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_GALLANT        0   0   17  0   0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_GALLANT    	   0   0   15  0   0   15~

//ALIGNMENT RESTRICTIONS____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_GALLANT        1  1  0  1  1  0  1  1  0~

//DUAL CLASS OPTIONS________________________________________________________________
//                 FT CL MA TH DR RA
~D5_GALLANT        0  0  0  0  0  0~

//KIT ABILITIES 2DA FILE____________________________________________________________
~might_and_guile/nubards/d5_glnt.2da~

//RACIAL KIT AVAILABILITY___________________________________________________________
~K_FM_E K_FM_H K_FM_HE~

//UNUSABLE FLAGS AND KIT BASE CLASS_________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00800200 7~

//HIGH LEVEL ABILITIES ABBREVIATION_________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION________________________________________________
SAY @21821
SAY @21822
SAY @21823
//__________________________________________________________________________________

//EE KIT EXTRAS_____________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21823)
		STR_VAR
			kit_name = D5_GALLANT 
			clswpbon = ~1 0 3~
			hpclass = ~HPFT~
			clsrcreq = ~1 1 1 0 0 0 0~
	END
END
//___________________________________________________________________________________

//GALLANT ABILITY FILES______________________________________________________________
//
COPY ~might_and_guile/nubards/d5_glnt.2da~ ~override~
COPY ~might_and_guile/misc/d5dsvbo.spl~ ~override~
COPY_EXISTING ~sppr409.spl~ ~override/d5galdw.spl~
	LPM spell_to_innate
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_glnt.2da~) BEGIN
	APPEND ~d5_glnt.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD MEISTERSINGER AS MAGE/THIEF____________________________________________________
//
ADD_KIT ~D5_MEISTER~

//WEAPON PROFICIENCIES_______________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_MEISTER    0 1 1 0 1 0 1 1~
~D5_MEISTER    0 0 0 0 0 0 0 0 0 1 1 1 0 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_MEISTER         0   12  0   9   9   12~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_MEISTER         0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_MEISTER         0   17  0   0   17  17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_MEISTER         0   15  0   0   17  15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_MEISTER         0  0  0  1  1  1  1  1  1~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_MEISTER         1  1  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_mstr.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_MT_H K_MT_E K_MT_HE K_MT_HL K_MT_G~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00800200 13~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21831
SAY @21832
SAY @21833
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21833)
		STR_VAR
			kit_name = D5_MEISTER
			clswpbon = ~0 0 3~
			sneakatt = ~1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1~
			backstab = ~1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1~
			thiefskl = ~25 15~
			thiefscl = ~0 0 100 100 100 100 0 0~
			clsrcreq = ~1 1 1 0 1 1 0~
	END
END
//___________________________________________________________________________________

//MEISTERSINGER ABILITY FILES________________________________________________________
//
COPY ~might_and_guile/nubards/d5_mstr.2da~ ~override~
COPY ~might_and_guile/nubards/d5meis1.bam~ ~override~
COPY ~might_and_guile/misc/d5_base.spl~ ~override/d5meis1.spl~
  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~d5meis1~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 67 target = 1 parameter2 = 2 timing = 0 duration = 30 probability1 = 100 STR_VAR resource = ~d5ratsu~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 67 target = 1 parameter2 = 2 timing = 0 duration = 30 probability1 = 85 STR_VAR resource = ~d5ratsu~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 67 target = 1 parameter2 = 2 timing = 0 duration = 30 probability1 = 70 STR_VAR resource = ~d5ratsu~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 67 target = 1 parameter2 = 2 timing = 0 duration = 30 probability1 = 55 STR_VAR resource = ~d5ratsu~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 67 target = 1 parameter2 = 2 timing = 0 duration = 30 probability1 = 40 STR_VAR resource = ~d5ratsu~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 67 target = 1 parameter2 = 2 timing = 0 duration = 30 probability1 = 25 STR_VAR resource = ~d5ratsu~ END
COPY ~might_and_guile/nubards/d5ratsu.cre~ ~override~
  WRITE_BYTE 0x275 0

//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_mstr.2da~) BEGIN
	APPEND ~d5_mstr.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD JINXER AS MAGE/THIEF____________________________________________________________
//
ADD_KIT ~D5_JINXER~

//WEAPON PROFICIENCIES________________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_JINXER     0 0 0 0 0 0 0 0~
~D5_JINXER     0 0 0 0 0 0 0 0 0 1 1 1 0 1 1 1 1 1 0 0 0 1 1 1 0 1 1 1 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_JINXER          0   12  0   12  0   12~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_JINXER          0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_JINXER          0   17  0   17  0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_JINXER          0   15  0   15  0   15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_JINXER          0  0  0  1  1  1  1  1  1~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_JINXER          1  0  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_jinx.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_MT_H K_MT_E K_MT_HE K_MT_HL K_MT_G~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00800200 13~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21836
SAY @21837
SAY @21838
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21838)
		STR_VAR
			kit_name = D5_JINXER
			sneakatt = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			backstab = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			clswpbon = ~0 0 3~
			thiefskl = ~30 20~
			thiefscl = ~100 100 100 100 100 100 0 0~
			clsrcreq = ~1 1 1 0 1 0 0~
	END
END
//____________________________________________________________________________________

//JINXER ABILITY FILES________________________________________________________________
//
COPY ~might_and_guile/nubards/d5_jinx.2da~ ~override~

//____________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_jinx.2da~) BEGIN
	APPEND ~d5_jinx.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD ELEGIST AS MAGE/THIEF____________________________________________________________
//
ADD_KIT ~D5_ELEGIST~

//WEAPON PROFICIENCIES________________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_ELEGIST    0 0 0 0 0 0 0 0~
~D5_ELEGIST    0 0 0 0 0 0 0 0 0 1 1 1 0 1 1 1 1 1 0 0 0 1 1 1 0 1 1 1 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_ELEGIST         0   12  0   12  0   12~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_ELEGIST         0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_ELEGIST         0   17  0   17  0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_ELEGIST         0   15  0   15  0   15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_ELEGIST         0  0  0  1  1  1  1  1  1~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_ELEGIST         1  0  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_eleg.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_MT_H K_MT_E K_MT_HE K_MT_HL K_MT_G~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00009000 13~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21841
SAY @21842
SAY @21843
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21843)
		STR_VAR
			kit_name = D5_ELEGIST
			sneakatt = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			backstab = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			clswpbon = ~0 0 3~
			thiefskl = ~30 20~
			thiefscl = ~100 100 100 100 100 100 0 0~
			clsrcreq = ~1 1 1 0 1 0 0~
	END
END
//____________________________________________________________________________________

//ELEGIST ABILITY FILES________________________________________________________________
//
COPY ~might_and_guile/nubards/d5_eleg.2da~ ~override~

//____________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_eleg.2da~) BEGIN
	APPEND ~d5_eleg.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________

//ARCHERS USE ELVEN CHAIN____________________________________________________________
//
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5_echan.d5~ BEGIN
  INCLUDE ~might_and_guile/lib/elven_chain.tpa~
END
//___________________________________________________________________________________


//ADD AGENT AS FIGHTER/MAGE/THIEF_____________________________________________________
//
ADD_KIT ~D5_AGENT~

//WEAPON PROFICIENCIES________________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_AGENT      0 0 0 0 0 0 0 0~
~D5_AGENT      0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_AGENT           0   12  0   12  0   12~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_AGENT           0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_AGENT           0   17  0   17  0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_AGENT           0   15  0   15  0   15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_AGENT           1  1  1  1  1  1  1  1  1~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_AGENT           1  0  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_agnt.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_FMT_H K_FMT_E K_FMT_HE~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00800200 10~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21851
SAY @21852
SAY @21853
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21838)
		STR_VAR
			kit_name = D5_AGENT
			sneakatt = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			backstab = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			clswpbon = ~0 0 3~
			thiefskl = ~30 20~
			thiefscl = ~100 100 100 100 100 100 0 0~
			clsrcreq = ~1 1 1 0 1 0 0~
	END
END
//____________________________________________________________________________________

//AGENT ABILITY FILES_________________________________________________________________
//
COPY ~might_and_guile/nubards/d5_agnt.2da~ ~override~
//____________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_agnt.2da~) BEGIN
	APPEND ~d5_agnt.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD LORESINGER AS CLERIC, and C/T_______________________________________________________
//
// cleric with songs... basically, a demibard

ACTION_IF !(FILE_EXISTS_IN_GAME ~d5_cleric_umd.d5~) BEGIN
  LAF clerics_use_magical_devices END
  LAF cleric_clabs_umd END
END

ADD_KIT ~D5_LORESINGER~

//WEAPON PROFICIENCIES_______________________________________________________________
//11           		                        T   S           F   Q             S S
//10           		L S                     W   C           L   U             W I
//9            		A M             B L S   O   I   W       A   A             O N
//8            		R A             A O H   H   M   A       I   R C   S       R G
//7            		G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            		E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            		S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            		W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            		O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            		R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            		D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_LORESINGER      0 0 0 0 0 0 0 0~
~D5_LORESINGER      0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 1 1 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_LORESINGER     0   0   0   9   12  15~

//KIT STAT MODIFIERS________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_LORESINGER     0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT__________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_LORESINGER     0   0   0   0   017  17~

//REQUIREMENTS TO DUAL FROM THIS KIT________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_LORESINGER     0   0   0   0   15  15~

//ALIGNMENT RESTRICTIONS____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_LORESINGER     1  1  0  1  1  0  1  1  0~

//DUAL CLASS OPTIONS________________________________________________________________
//                 FT CL MA TH DR RA
~D5_LORESINGER     0  0  0  0  0  0~

//KIT ABILITIES 2DA FILE____________________________________________________________
~might_and_guile/nubards/d5_lors.2da~

//RACIAL KIT AVAILABILITY___________________________________________________________
~K_C_D K_C_E K_C_G K_C_H K_C_HE K_C_HL K_C_HO~

//UNUSABLE FLAGS AND KIT BASE CLASS_________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20, FT = 9, FC = 8, CT = 15, CR = 18, FM = 7, CM = 14, MT = 13
~0x00800000 3~

//HIGH LEVEL ABILITIES ABBREVIATION_________________________________________________
~CL0~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21866
SAY @21867
SAY @21868
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21868)
		STR_VAR
			kit_name = D5_LORESINGER
			clswpbon = ~0 0 3~
			clsrcreq = ~1 1 1 0 0 1 0~
	END
END
//___________________________________________________________________________________

//LORESINGER ABILITY FILES___________________________________________________________
//
COPY ~might_and_guile/nubards/d5_lors.2da~ ~override~
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_lors.2da~) BEGIN
	APPEND ~d5_lors.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________

//DEFINE SPHERE ACCESS_______________________________________________________________
//
LAF ~DEFINE_FNP_KIT_INFO~
  INT_VAR
	u_leather_armor 	= 1
	u_chain_armor 		= 1
	u_plate_armor 		= 0
	u_club_staff	 	= 1
	u_hammers	 		= 1
	u_maces 	 		= 1
	u_flails 			= 0
	u_axes 				= 0
	u_daggers 			= 1
	u_short_swords		= 1
	u_long_swords		= 1
	u_scimitars 		= 1
	u_katanas 			= 0
	u_bastard_swords 	= 0
	u_2hand_swords 		= 0
	u_halberds 			= 0
	u_spears 			= 0
	u_darts 			= 1
	u_slings 			= 1
	u_bows 				= 0
	u_crossbows 		= 1  
  STR_VAR
    clab_name 		= ~d5_lors~
	class 			= ~cleric~
	sphere_list 	= ~milil_spheres~
END

LAM ~READ_FNP_KIT_INFO~

ACTION_IF FILE_EXISTS_IN_GAME ~d5_spheres.d5~ BEGIN
  LAF apply_fnp_spheres STR_VAR clab_name = ~d5_lors~ END
END

ACTION_IF FILE_EXISTS_IN_GAME ~d5_fnp_usability.d5~ BEGIN
  LAF apply_fnp_usability STR_VAR clab_name = ~d5_lors~ END
END

ACTION_IF (FILE_EXISTS ~override/d5_fnp_settings.ini~) && (FILE_CONTAINS_EVALUATED (~d5_fnp_settings.ini~ ~d5_spont_option~)) BEGIN
  INCLUDE ~override/d5_fnp_settings.ini~
  LAM d5_spont_option
  ACTION_IF (d5_spell_spontaneous > 0) BEGIN
	APPEND ~d5_lors.2da~ ~SPNT_SPLS    GA_D5FPSP2  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END

ACTION_IF (FILE_EXISTS_IN_GAME ~d5_cleric_umd.d5~) BEGIN
  APPEND ~d5_lors.2da~ ~NO_UMD      AP_D5_NUMD  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
END
//__________________________________________________________________________________

COPY ~might_and_guile/nubards/d5_lors.2da~ ~override/d5_lort.2da~

ADD_KIT ~D5_LORESINGER_CT~

//WEAPON PROFICIENCIES_______________________________________________________________
//11           		                          T   S           F   Q             S S
//10           		  L S                     W   C           L   U             W I
//9            		  A M             B L S   O   I   W       A   A             O N
//8            		  R A             A O H   H   M   A       I   R C   S       R G
//7            		  G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            		  E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            		  S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            		  W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            		  O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            		  R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            		  D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_LORESINGER_CT     0 0 0 0 0 0 0 0~
~D5_LORESINGER_CT     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 1 1 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS_________________________________________________________________
//                  STR DEX CON INT WIS CHR
~D5_LORESINGER_CT    0   0   0   9   12  15~

//KIT STAT MODIFIERS________________________________________________________________
//                  STR DEX CON INT WIS CHR
~D5_LORESINGER_CT    0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT__________________________________________________
//                  STR DEX CON INT WIS CHR
~D5_LORESINGER_CT    0   0   0   0   017  17~

//REQUIREMENTS TO DUAL FROM THIS KIT________________________________________________
//                  STR DEX CON INT WIS CHR
~D5_LORESINGER_CT    0   0   0   0   15  15~

//ALIGNMENT RESTRICTIONS____________________________________________________________
//                  LG LN LE NG TN NE CG CN CE
~D5_LORESINGER_CT    1  1  0  1  1  0  1  1  0~

//DUAL CLASS OPTIONS________________________________________________________________
//                  FT CL MA TH DR RA
~D5_LORESINGER_CT    0  0  0  0  0  0~

//KIT ABILITIES 2DA FILE____________________________________________________________
~override/d5_lort.2da~

//RACIAL KIT AVAILABILITY___________________________________________________________
~K_CT_D K_CT_E K_CT_G K_CT_H K_CT_HE K_CT_HL K_CT_HO~

//UNUSABLE FLAGS AND KIT BASE CLASS_________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20, FT = 9, FC = 8, CT = 15, CR = 18, FM = 7, CM = 14, MT = 13
~0x00800000 15~

//HIGH LEVEL ABILITIES ABBREVIATION_________________________________________________
~CT0~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21866
SAY @21867
SAY @21868
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21868)
		STR_VAR
			kit_name = D5_LORESINGER_CT
			clswpbon = ~0 0 3~
			clsrcreq = ~1 1 1 0 0 1 0~
	END
END
//___________________________________________________________________________________

//LORESINGER ABILITY FILES___________________________________________________________
//
//COPY ~might_and_guile/nubards/d5_lort.2da~ ~override~
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_lort.2da~) BEGIN
	APPEND ~d5_lort.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________

//DEFINE SPHERE ACCESS_______________________________________________________________
//
LAF ~DEFINE_FNP_KIT_INFO~
  INT_VAR
	u_leather_armor 	= 1
	u_chain_armor 		= 0
	u_plate_armor 		= 0
	u_club_staff	 	= 1
	u_hammers	 		= 1
	u_maces 	 		= 1
	u_flails 			= 0
	u_axes 				= 0
	u_daggers 			= 1
	u_short_swords		= 1
	u_long_swords		= 1
	u_scimitars 		= 1
	u_katanas 			= 0
	u_bastard_swords 	= 0
	u_2hand_swords 		= 0
	u_halberds 			= 0
	u_spears 			= 0
	u_darts 			= 1
	u_slings 			= 1
	u_bows 				= 0
	u_crossbows 		= 1  
  STR_VAR
    clab_name 		= ~d5_lort~
	class 			= ~cleric_thief~
	sphere_list 	= ~milil_spheres~
END

LAM ~READ_FNP_KIT_INFO~

ACTION_IF FILE_EXISTS_IN_GAME ~d5_spheres.d5~ BEGIN
  LAF apply_fnp_spheres STR_VAR clab_name = ~d5_lort~ END
END

ACTION_IF FILE_EXISTS_IN_GAME ~d5_fnp_usability.d5~ BEGIN
  LAF apply_fnp_usability STR_VAR clab_name = ~d5_lort~ END
END

/* already done when copied d5_lors to this one
ACTION_IF (FILE_EXISTS ~override/d5_fnp_settings.ini~) && (FILE_CONTAINS_EVALUATED (~d5_fnp_settings.ini~ ~d5_spont_option~)) BEGIN
  INCLUDE ~override/d5_fnp_settings.ini~
  LAM d5_spont_option
  ACTION_IF (d5_spell_spontaneous > 0) BEGIN
	APPEND ~d5_lort.2da~ ~SPNT_SPLS    GA_D5FPSP2  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END

ACTION_IF (FILE_EXISTS_IN_GAME ~d5_cleric_umd.d5~) BEGIN
  APPEND ~d5_lort.2da~ ~NO_UMD      AP_D5_NUMD  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
END
*/
//__________________________________________________________________________________


//ADD HEXBLADE AS F/M________________________________________________________________
//
ADD_KIT ~D5_HEXBLADE~

//WEAPON PROFICIENCIES________________________________________________________________
//11           	                        T   S           F   Q             S S
//10           	L S                     W   C           L   U             W I
//9            	A M             B L S   O   I   W       A   A             O N
//8            	R A             A O H   H   M   A       I   R C   S       R G
//7            	G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            	E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            	S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            	W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            	O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            	R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            	D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_HEXBLADE    0 0 0 0 0 0 0 0~
~D5_HEXBLADE    0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_HEXBLADE       9   0   0   9   0   12~

//KIT STAT MODIFIERS________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_HEXBLADE       0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT__________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_HEXBLADE       15  0   0   0   0   15~

//REQUIREMENTS TO DUAL FROM THIS KIT________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_HEXBLADE  	   15  0   0   0   0   15~

//ALIGNMENT RESTRICTIONS____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_HEXBLADE       0  0  0  1  1  1  1  1  1~

//DUAL CLASS OPTIONS________________________________________________________________
//                 FT CL MA TH DR RA
~D5_HEXBLADE       0  0  0  1  0  0~

//KIT ABILITIES 2DA FILE____________________________________________________________
~might_and_guile/nubards/d5_hxbl.2da~

//RACIAL KIT AVAILABILITY___________________________________________________________
~K_FM_H K_FM_HE~

//UNUSABLE FLAGS AND KIT BASE CLASS_________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00800200 7~

//HIGH LEVEL ABILITIES ABBREVIATION_________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21846
SAY @21847
SAY @21848
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21848)
		STR_VAR
			kit_name = D5_HEXBLADE
			clswpbon = ~1 0 3~
			hpclass = ~HPFT~
	END
END
//___________________________________________________________________________________

//HEXBLADE ABILITY FILES_____________________________________________________________
//
COPY ~might_and_guile/nubards/d5_hxbl.2da~ ~override~
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_hxbl.2da~) BEGIN
	APPEND ~d5_hxbl.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD BLADESINGER AS F/M______________________________________________________________
//
ADD_KIT ~D5_BLADESINGER~

//WEAPON PROFICIENCIES________________________________________________________________
//11            	                        T   S           F   Q             S S
//10            	L S                     W   C           L   U             W I
//9             	A M             B L S   O   I   W       A   A             O N
//8             	R A             A O H   H   M   A       I   R C   S       R G
//7             	G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6             	E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5             	S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4             	W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3             	O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2             	R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1             	D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_BLADESINGER     0 0 0 0 0 0 0 0~
~D5_BLADESINGER     0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0 2 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS_________________________________________________________________
//                  STR DEX CON INT WIS CHR
~D5_BLADESINGER     9   12  0   12  0   12~

//KIT STAT MODIFIERS________________________________________________________________
//                  STR DEX CON INT WIS CHR
~D5_BLADESINGER     0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT__________________________________________________
//                  STR DEX CON INT WIS CHR
~D5_BLADESINGER     0   17  0   17  0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT________________________________________________
//                  STR DEX CON INT WIS CHR
~D5_BLADESINGER     0   15  0   15  0   15~

//ALIGNMENT RESTRICTIONS____________________________________________________________
//                  LG LN LE NG TN NE CG CN CE
~D5_BLADESINGER     1  1  1  1  1  1  0  0  0~

//DUAL CLASS OPTIONS________________________________________________________________
//                  FT CL MA TH DR RA
~D5_BLADESINGER     0  0  0  0  0  0~

//KIT ABILITIES 2DA FILE____________________________________________________________
~might_and_guile/nubards/d5_blads.2da~

//RACIAL KIT AVAILABILITY___________________________________________________________
~K_FM_E~

//UNUSABLE FLAGS AND KIT BASE CLASS_________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20
~0x00004000 7~

//HIGH LEVEL ABILITIES ABBREVIATION_________________________________________________
~D5BRD~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21856
SAY @21857
SAY @21858
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21858)
		STR_VAR
			kit_name = D5_BLADESINGER
			clswpbon = ~1 0 3~
			hpclass = ~HPFT~
	END
END
//___________________________________________________________________________________

//BLADESINGER ABILITY FILES__________________________________________________________
//
COPY ~might_and_guile/nubards/d5_blads.2da~ ~override~

ACTION_IF !(FILE_EXISTS_IN_GAME ~d5_rfe9b.bam~) BEGIN
  INCLUDE ~might_and_guile/lib/extra_prof_dialogue.tpa~
  COPY ~might_and_guile/feats/d5_rfe9b.bam~ ~override~
  COPY ~might_and_guile/feats/d5ftprof.spl~ ~override/d5blwpf.spl~
	SAY NAME1 @20496
	SAY UNIDENTIFIED_DESC @20497
	WRITE_ASCII 0x3a ~d5_rfe9~ #8
	LPF ALTER_SPELL_HEADER STR_VAR icon = ~d5_rfe9~ END
  COPY ~might_and_guile/feats/d5ftprof.eff~ ~override~
  COPY ~might_and_guile/feats/d5ftprof.cre~ ~override~
END

ACTION_IF (FILE_EXISTS_IN_GAME ~d5_rfeat.d5~) BEGIN
  COPY_EXISTING ~d5_blads.2da~ ~override~
	REPLACE_TEXTUALLY ~GA_D5BSWPF~ ~****      ~
  BUT_ONLY
END

// imp. alacrity must cancel bladesong
COPY_EXISTING ~spwi921.spl~ ~override~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd51b~ END
  LPF CLONE_EFFECT INT_VAR match_opcode = 188 opcode = 206 parameter1 = 0 parameter2 = (0 - 1) STR_VAR resource = ~d5bd51b~ END
IF_EXISTS BUT_ONLY
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_blads.2da~) BEGIN
	APPEND ~d5_blads.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD HERALD AS FIGHTER/THIEF________________________________________________________
//
ADD_KIT ~D5_HERALD~

//WEAPON PROFICIENCIES_______________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_HERALD     2 2 2 2 2 2 2 2~
~D5_HERALD     0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_HERALD         9   9  0   12  0   12~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_HERALD         0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_HERALD         0   17  0   17  0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_HERALD         0   15  0   15  0   15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_HERALD         1  1  1  1  1  1  0  0  0~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_HERALD         0  0  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_hrld.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_FT_D K_FT_E K_FT_H K_FT_HE K_FT_G K_FT_HL K_FT_HO~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20, FT = 9, FC = 8, CT = 15, CR = 18, FM = 7, CM = 14, MT = 13
~0x00004000 9~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~FT0~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21826
SAY @21827
SAY @21828
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21828)
		STR_VAR
			kit_name = D5_HERALD
			clswpbon = ~1 0 3~
			hpclass = ~HPFT~
			clsrcreq = ~1 1 1 0 0 0 0~
			sneakatt = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			backstab = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			thiefskl = ~40 20~
			thiefscl = ~100 100 100 100 100 100 0 0~
	END
END
//___________________________________________________________________________________

//HERALD ABILITY FILES_______________________________________________________________
//
COPY ~might_and_guile/nubards/d5_hrld.2da~ ~override~
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_hrld.2da~) BEGIN
	APPEND ~d5_hrld.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________


//ADD WHISTLER AS THIEF______________________________________________________________
//
// ***** make this a druid/thief kit...???
// if so, add the kit, but not in menu; only if FnP installed add to menu

ADD_KIT ~D5_WHISTLER~

//WEAPON PROFICIENCIES_______________________________________________________________
//11                                   T   S           F   Q             S S
//10           L S                     W   C           L   U             W I
//9            A M             B L S   O   I   W       A   A             O N
//8            R A             A O H   H   M   A       I   R C   S       R G
//7            G L           M S N O   A   I   R     H L   T R L H     2 D L 2                 E E E E E E E E E E E
//6            E L       S   I T G R   N K T D H     A M   E O O O     H A E W E E E E E E E E X X X X X X X X X X X
//5            S S   S B P   S A S T   D A A A A   S L O   R S N R   S A N W E X X X X X X X X T T T T T T T T T T T
//4            W W   P L I   S R W S   E T R G M C P B R M S S G T D L N D E A T T T T T T T T R R R R R R R R R R R
//3            O O B E U K A I D O W A D A W G M L E E N A T B B B A I D S A P R R R R R R R R A A A A A A A A A A A
//2            R R O A N E X L S R O X S N A E E U A R I C A O O O R N E H P O A A A A A A A A 1 1 1 1 1 1 1 1 1 1 2
//1            D D W R T D E E W D R E W A K R R B R D N E F W W W T G D I O N 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0
~D5_WHISTLER   1 1 1 1 1 1 1 1~
~D5_WHISTLER   0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0~

//MINIMUM KIT STATS__________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_WHISTLER       0   12  0   0   9   12~

//KIT STAT MODIFIERS_________________________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_WHISTLER       0   0   0   0   0   0~

//REQUIREMENTS TO DUAL TO THIS KIT___________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_WHISTLER       0   17  0   0   0   17~

//REQUIREMENTS TO DUAL FROM THIS KIT_________________________________________________
//                 STR DEX CON INT WIS CHR
~D5_WHISTLER       0   15  0   0   0   15~

//ALIGNMENT RESTRICTIONS_____________________________________________________________
//                 LG LN LE NG TN NE CG CN CE
~D5_WHISTLER       1  1  0  1  1  1  1  1  0~

//DUAL CLASS OPTIONS_________________________________________________________________
//                 FT CL MA TH DR RA
~D5_WHISTLER       0  0  0  0  0  0~

//KIT ABILITIES 2DA FILE_____________________________________________________________
~might_and_guile/nubards/d5_whsl.2da~

//RACIAL KIT AVAILABILITY____________________________________________________________
~K_T_HL~

//UNUSABLE FLAGS AND KIT BASE CLASS__________________________________________________
//CLASSES: Mage = 1, Fighter = 2, Cleric=3, Thief = 4, Bard = 5
//         Paladin 6, Druid = 11, Ranger = 12, Sorcerer = 19
//         Monk = 20, FT = 9, FC = 8, CT = 15, CR = 18, FM = 7, CM = 14, MT = 13
~0x00004000 4~

//HIGH LEVEL ABILITIES ABBREVIATION__________________________________________________
~Th0~

//TOB STARTING EQUIPMENT_____________________________________________________________
~LEAT14	* HELM07 BAG25 RING06 RING31 CLCK02 BOOT01 AMUL19 BRAC16 BELT06 AROW11,40 BULL03,40 BOLT06,40 POTN52,5 POTN04,2 POTN14,5 BOW18 SW1H39 STAF08~

//CHARACTER CREATION KIT DESCRIPTION_________________________________________________
SAY @21861
SAY @21862
SAY @21863
//___________________________________________________________________________________

//EE KIT EXTRAS______________________________________________________________________
// 
ACTION_IF GAME_IS ~bgee bg2ee eet iwdee~ THEN BEGIN
	LAF fl#add_kit_ee
		INT_VAR
			briefdesc = RESOLVE_STR_REF (@21863)
		STR_VAR
			kit_name = D5_WHISTLER
			clswpbon = ~0 0 3~
			hpclass = ~HPROG~
			clsrcreq = ~0 0 0 0 1 0 0~
			sneakatt = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			backstab = ~1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2~
			thiefskl = ~40 20~
			thiefscl = ~100 100 100 0 0 100 0 0~
	END
END
//___________________________________________________________________________________

//WHISTLER ABILITY FILES_____________________________________________________________
//
COPY ~might_and_guile/nubards/d5_whsl.2da~ ~override~

COPY ~might_and_guile/misc/d5_xp75.spl~ ~override~
  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 104 parameter1 = 75 END

COPY_EXISTING ~sppr106.spl~ ~override/d5rt106.spl~ // magic stone
	LPM spell_to_innate
COPY_EXISTING ~sppr109.spl~ ~override/d5rt109.spl~ // sanctuary
	LPM spell_to_innate
COPY_EXISTING ~sppr110.spl~ ~override/d5rt110.spl~ // shillelagh
	LPM spell_to_innate
COPY_EXISTING ~sppr207.spl~ ~override/d5rt207.spl~ // goodberry
	LPM spell_to_innate
COPY ~might_and_guile/nubards/d5whsp1.2da~ ~override~
COPY ~might_and_guile/misc/d5indr1.bam~ ~override~
COPY ~might_and_guile/nubards/d5whsp1.spl~ ~override~ // spell to cast from list
	SAY NAME1 ~Nature Magic~
	SAY UNIDENTIFIED_DESC ~Nature Magic~
COPY_EXISTING ~sppr202.spl~ ~override/d5rt202.spl~ // barkskin
	LPM spell_to_innate
COPY_EXISTING ~sppr212.spl~ ~override/d5rt212.spl~ // slow poison
	LPM spell_to_innate
COPY_EXISTING ~sppr317.spl~ ~override/d5rt317.spl~ // cure disease
	LPM spell_to_innate
COPY_EXISTING ~sppr402.spl~ ~override/d5rt402.spl~ // 4th-level animal summoning
	LPM spell_to_innate
COPY ~might_and_guile/nubards/d5whsp2.2da~ ~override~
COPY ~might_and_guile/misc/d5indr2.bam~ ~override~
COPY ~might_and_guile/nubards/d5whsp2.spl~ ~override~ // spell to cast from list
	SAY NAME1 ~Nature Magic~
	SAY UNIDENTIFIED_DESC ~Nature Magic~
COPY_EXISTING ~sppr318.spl~ ~override/d5rt318.spl~ // zone of sweet air
	LPM spell_to_innate
COPY_EXISTING ~sppr302.spl~ ~override/d5rt302.spl~ // call lightning
	LPM spell_to_innate
COPY_EXISTING ~sppr501.spl~ ~override/d5rt501.spl~ // 5th-level animal summoning
	LPM spell_to_innate
COPY ~might_and_guile/nubards/d5whsp3.2da~ ~override~
COPY ~might_and_guile/misc/d5indr3.bam~ ~override~
COPY ~might_and_guile/nubards/d5whsp3.spl~ ~override~ // spell to cast from list
	SAY NAME1 ~Nature Magic~
	SAY UNIDENTIFIED_DESC ~Nature Magic~
//___________________________________________________________________________________

//WILD TALENT_________________________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5_psionics.d5~) BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5_whsl.2da~) BEGIN
	APPEND ~d5_whsl.2da~ ~WILD_TLNT   AP_D5PSWT_  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
//____________________________________________________________________________________



// get kit identifiers________________________________________________________________
//
OUTER_SET nu_bard_code = (0x4000 + %D5_BARD%)
OUTER_SET nu_blade_code = (0x4000 + %D5_BLADE%)
OUTER_SET nu_jester_code = (0x4000 + %D5_JESTER%)
OUTER_SET nu_skald_code = (0x4000 + %D5_SKALD%)
OUTER_SET nu_gallant_code = (0x4000 + %D5_GALLANT%)
OUTER_SET nu_herald_code = (0x4000 + %D5_HERALD%)
OUTER_SET nu_meister_code = (0x4000 + %D5_MEISTER%)
OUTER_SET nu_jinxer_code = (0x4000 + %D5_JINXER%)
OUTER_SET nu_elegist_code = (0x4000 + %D5_ELEGIST%)
OUTER_SET nu_agent_code = (0x4000 + %D5_AGENT%)
OUTER_SET nu_hexblade_code = (0x4000 + %D5_HEXBLADE%)
OUTER_SET nu_loresinger_code = (0x4000 + %D5_LORESINGER%)
OUTER_SET nu_loresinger_ct_code = (0x4000 + %D5_LORESINGER_CT%)
OUTER_SET nu_bladesinger_code = (0x4000 + %D5_BLADESINGER%)
OUTER_SET nu_whistler_code = (0x4000 + %D5_WHISTLER%)

APPEND ~splprot.2da~ ~D5_KIT_IS%TAB%152%TAB%-1%TAB%1~ UNLESS ~D5_KIT_IS~
COPY_EXISTING ~splprot.2da~ ~override~
	COUNT_2DA_COLS cols
	READ_2DA_ENTRIES_NOW rows cols
	FOR (row = 1; row < rows; ++row) BEGIN
	  READ_2DA_ENTRY_FORMER rows row 0 ~stat~
	  PATCH_IF ~%stat%~ STRING_EQUAL_CASE ~D5_KIT_IS~ BEGIN
	    SET kit_is_row = %row%
	  END
	END
BUT_ONLY
//___________________________________________________________________________________


// bladesinger weapon focus gives APR_________________________________________________
//
// patch all weapons to have 177 targeting bladesinger
COPY_EXISTING_REGEXP GLOB ~^.+\.itm$~ ~override~
  PATCH_IF (SOURCE_SIZE > 0x71) BEGIN
	READ_BYTE 0x31 proficiency
	PATCH_IF (proficiency = 89) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5bswob~ END
	END
	PATCH_IF (proficiency = 90) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5lswob~ END
	END
	PATCH_IF (proficiency = 91) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5sswob~ END
	END
	PATCH_IF (proficiency = 93) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d52swob~ END
	END
	PATCH_IF (proficiency = 92) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5baxeb~ END
	END
	PATCH_IF (proficiency = 94) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5katab~ END
	END
	PATCH_IF (proficiency = 95) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5scimb~ END
	END
	PATCH_IF (proficiency = 96) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5daggb~ END
	END
	PATCH_IF (proficiency = 97) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5hammb~ END
	END
	PATCH_IF (proficiency = 98) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5speab~ END
	END
	PATCH_IF (proficiency = 99) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5halbb~ END
	END
	PATCH_IF (proficiency = 100) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5flaib~ END
	END
	PATCH_IF (proficiency = 101) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5maceb~ END
	END
	PATCH_IF (proficiency = 115) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5clubb~ END
	END
	PATCH_IF (proficiency = 102) BEGIN
	  LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% paramater2 = 9 timing = 2 STR_VAR resource = ~d5stafb~ END
	END
  END
BUT_ONLY

// make EFFs giving extra APR
ACTION_FOR_EACH prof IN ~bswo~ ~lswo~ ~sswo~ ~2swo~ ~baxe~ ~kata~ ~scim~ ~dagg~ ~hamm~ ~spea~ ~halb~ ~flai~ ~mace~ ~club~ ~staf~ BEGIN
  CREATE EFF ~d5%prof%b~
	WRITE_LONG 0x10 1
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 6
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5%PROF%B~ #8
END

// make spells with 206 against those EFFs
ACTION_FOR_EACH prof IN ~bswo~ ~lswo~ ~sswo~ ~2swo~ ~baxe~ ~kata~ ~scim~ ~dagg~ ~hamm~ ~spea~ ~halb~ ~flai~ ~mace~ ~club~ ~staf~ BEGIN
  COPY ~might_and_guile/misc/d5_base.spl~ ~override/d5%prof%6.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~D5%PROF%B~ END
  BUT_ONLY
END

// have weapon focus spells cancel those 206 spells
ACTION_FOR_EACH spec IN ~a~ ~b~ ~c~ ~d~ ~e~ BEGIN
  ACTION_FOR_EACH prof IN ~bswo~ ~lswo~ ~sswo~ ~2swo~ ~baxe~ ~kata~ ~scim~ ~dagg~ ~hamm~ ~spea~ ~halb~ ~flai~ ~mace~ ~club~ ~staf~ BEGIN
	COPY_EXISTING ~d5%spec%%prof%.spl~ ~override~
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = EVAL ~d5%prof%6~ END
	IF_EXISTS BUT_ONLY
  END
END

// make spell to cast those 206 spells
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bs206.spl~
  PATCH_FOR_EACH prof IN ~bswo~ ~lswo~ ~sswo~ ~2swo~ ~baxe~ ~kata~ ~scim~ ~dagg~ ~hamm~ ~spea~ ~halb~ ~flai~ ~mace~ ~club~ ~staf~ BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = EVAL ~d5%prof%6~ END
  END
BUT_ONLY

//___________________________________________________________________________________


// item usability_____________________________________________________________________
//
// ***** this will mess up all C/Ts and F/Ts... and F/Cs 
// need to do new one for C/T
// and run the ...nuse spells through 177
// NOTE: 180 effects like this this do not play nice with FnP

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bdnuse.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = 7 parameter2 = 105 timing = 9 STR_VAR resource = ~d5fmnuse~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = 13 parameter2 = 105 timing = 9 STR_VAR resource = ~d5mtnuse~ END
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = 15 parameter2 = 105 timing = 9 STR_VAR resource = ~d5ctnuse~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5fmnuse.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5mtnuse.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ctnuse.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bnuse.spl~

COPY_EXISTING_REGEXP GLOB ~^.+\.itm$~ ~override~
  READ_SHORT 0x1c item_type
  READ_BYTE 0x1e bard_use
  READ_BYTE 0x1f f_c_use
  READ_BYTE 0x20 m_t_use
//  PATCH_IF NOT (item_type = 11) && NOT (item_type = 35) BEGIN
	PATCH_IF ((%bard_use% BOR 0b10111111) = 0b10111111) && ((%f_c_use% BAND 0b00100000) = 0b00100000) BEGIN 	// if usable by bards but not by F/M...
	  WRITE_BYTE 0x1f (THIS BAND 0b11011111)						// make usable by fighter/mages
	  SPRINT item_res ~%SOURCE_RES%~
	  INNER_ACTION BEGIN
		COPY_EXISTING ~d5fmnuse.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 180 target = 1 parameter1 = (0 - 1) parameter2 = 0 timing = 9 STR_VAR resource = EVAL ~%item_res%~ END
		BUT_ONLY
	  END
	END
	PATCH_IF ((%bard_use% BOR 0b10111111) = 0b10111111) && ((%m_t_use% BAND 0b00001000) = 0b00001000) BEGIN 	// if usable by bards but not by M/T...
	  WRITE_BYTE 0x20 (THIS BAND 0b11110111)						// make usable by mage/thieves
	  SPRINT item_res ~%SOURCE_RES%~
	  INNER_ACTION BEGIN
		COPY_EXISTING ~d5mtnuse.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 180 target = 1 parameter1 = (0 - 1) parameter2 = 0 timing = 9 STR_VAR resource = EVAL ~%item_res%~ END
		BUT_ONLY
	  END
	END
	PATCH_IF ((%bard_use% BOR 0b10111111) = 0b10111111) && ((%f_c_use% BAND 0b00000010) = 0b00000010) BEGIN 	// if usable by bards but not by C/T...
	  WRITE_BYTE 0x1f (THIS BAND 0b11011111)						// make usable by fighter/mages
	  SPRINT item_res ~%SOURCE_RES%~
	  INNER_ACTION BEGIN
		COPY_EXISTING ~d5ctnuse.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 180 target = 1 parameter1 = (0 - 1) parameter2 = 0 timing = 9 STR_VAR resource = EVAL ~%item_res%~ END
		BUT_ONLY
	  END
	END
	PATCH_IF ((%bard_use% BAND 0b01000000) = 0b01000000) && ((%f_c_use% BOR 0b11011111) = 0b11011111) && ((%m_t_use% BOR 0b11110111) = 0b11110111) BEGIN 	// if usable by F/M + M/T but not by bards...
	  SPRINT item_res ~%SOURCE_RES%~
	  INNER_ACTION BEGIN
		COPY_EXISTING ~d5bnuse.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 180 target = 1 parameter1 = (0 - 1) parameter2 = 0 timing = 9 STR_VAR resource = EVAL ~%item_res%~ END
		BUT_ONLY
	  END
	END
//  END
BUT_ONLY

ACTION_FOR_EACH usability_spell IN ~d5fmnuse~ ~d5mtnuse~ ~d5ctnuse~ BEGIN
  COPY_EXISTING   ~%usability_spell%.spl~ ~override~
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_bard_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_blade_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_jester_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_skald_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_gallant_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_herald_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_meister_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_jinxer_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_elegist_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_agent_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_hexblade_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
//	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_loresinger_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = %nu_bladesinger_code% parameter2 = %kit_is_row% timing = 9 STR_VAR resource = EVAL ~%usability_spell%~ END
END

APPEND ~clabfi01.2da~ ~BARD_USE    AP_D5BDNUSE ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
APPEND ~clabth01.2da~ ~BARD_USE    AP_D5BDNUSE ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
//APPEND ~clabth01.2da~ ~BARD_USE    AP_D5CTNUSE ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

/* don't need to do this since only worried about multiclasses (for now?)
COPY_EXISTING ~kitlist.2da~ ~override~
  COUNT_2DA_ROWS ~9~ "rows"
  FOR ( index = 2 ; index < rows ; index = index + 1 ) BEGIN
	READ_2DA_ENTRY %index% 5 9 modclab
	READ_2DA_ENTRY %index% 8 9 modclass
	DEFINE_ASSOCIATIVE_ARRAY d5_180_array BEGIN "%modclab%" => "%modclass%" END
  END
BUT_ONLY

ACTION_PHP_EACH d5_180_array AS bo => zo BEGIN
// omit bard kits
  ACTION_IF (%zo% = 4) && FILE_EXISTS_IN_GAME ~%bo%.2da~ && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_bard~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_blade~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_jstr~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_skld~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_glnt~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_hrld~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_mstr~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_jinx~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_eleg~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_hxbl~) && NOT (~%bo%~ STRING_EQUAL_CASE ~d5_agnt~) BEGIN
	APPEND ~%bo%.2da~ ~BARD_USE    AP_D5TNUSE  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
  END
END
*/
//____________________________________________________________________________________


// fix UAI_____________________________________________________________________________
//
// if UAI is in the game, have it 321 d5mtnuse and d5fmnuse 
ACTION_IF FILE_EXISTS_IN_GAME ~spcl915.spl~ BEGIN
  COPY_EXISTING ~spcl915.spl~ ~override~
  	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5mtnuse~ END
  	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5fmnuse~ END
END
//____________________________________________________________________________________


// define spell access________________________________________________________________
//
// restrict access to schools of... necromancy, evocation, conjuration, wild
// ...and restrict all 8th/9th level spells
// ...and also restrict sequencers and contingency (unless TnB option #5)
// need kits to have the usability flag for both a specialist kit and the skald kit
// spells just need to be restricted from skalds

COPY_EXISTING_REGEXP GLOB ~^.+\.spl$~ ~override~
  READ_SHORT 0x1c spell_type
  PATCH_IF spell_type = 1 BEGIN
	READ_BYTE 0x25 spell_school
	READ_LONG 0x34 spell_level
	READ_BYTE 0x20 bard_excludes
	PATCH_IF spell_school = 7 	OR 		//	necromancy
			spell_school = 6 	OR 		//	invocation
			spell_school = 2 	OR 		//	conjuration
			spell_school = 9 	OR		//	wild magic
			spell_level = 8 	OR
			spell_level = 9 	BEGIN
	  WRITE_BYTE 0x20 (%bard_excludes% BOR ~0b10000000~) 		// unusable by skalds
	END
	PATCH_IF !(MOD_IS_INSTALLED ~TomeAndBlood.tp2~ ~55~) BEGIN
	  PATCH_IF  ~%SOURCE_RES%~ STRING_EQUAL_CASE ~spwi420~	OR		// minor sequencer
				~%SOURCE_RES%~ STRING_EQUAL_CASE ~spwi710~	OR 		// sequencer
				~%SOURCE_RES%~ STRING_EQUAL_CASE ~spwi617~	BEGIN 	// contingency
		WRITE_BYTE 0x20 (%bard_excludes% BOR ~0b10000000~)  // unusable by skalds
	  END
	END
	PATCH_IF !(MOD_IS_INSTALLED ~TomeAndBlood.tp2~ ~16~) BEGIN
	  PATCH_IF ~%SOURCE_RES%~ STRING_EQUAL_CASE ~spwi110~ 	BEGIN	// identify
		WRITE_BYTE 0x20 (%bard_excludes% BOR ~0b10000000~)  // unusable by skalds
	  END
	END
  END
BUT_ONLY

// ***** need to shift the base skald to treuclass usability... I guess?  Maybe not.  Who cares?

// use the... archer kit for elegiasts
COPY_EXISTING_REGEXP GLOB ~^.+\.spl$~ ~override~
  READ_SHORT 0x1c spell_type
  PATCH_IF spell_type = 1 BEGIN
	READ_BYTE 0x25 spell_school
	READ_LONG 0x34 spell_level
	READ_BYTE 0x1f bard_excludes
	PATCH_IF spell_school = 5 	OR 		//	illusion
			spell_school = 6 	OR 		//	invocation
			spell_school = 2 	OR 		//	conjuration
			spell_school = 9 	OR		//	wild magic
			spell_level = 8 	OR
			spell_level = 9 	BEGIN
//	  WRITE_BYTE 0x1f (%bard_excludes% BOR ~0b10000000~) 		// unusable by archers
	  WRITE_BYTE 0x1f (THIS BOR ~0b10000000~) 				// better way to do this...?
	END
	PATCH_IF !(MOD_IS_INSTALLED ~TomeAndBlood.tp2~ ~55~) BEGIN
	  PATCH_IF  ~%SOURCE_RES%~ STRING_EQUAL_CASE ~spwi420~	OR		// minor sequencer
				~%SOURCE_RES%~ STRING_EQUAL_CASE ~spwi710~	OR 		// sequencer
				~%SOURCE_RES%~ STRING_EQUAL_CASE ~spwi617~	BEGIN 	// contingency
		WRITE_BYTE 0x1f (%bard_excludes% BOR ~0b10000000~)  // unusable by archers
	  END
	END
	PATCH_IF !(MOD_IS_INSTALLED ~TomeAndBlood.tp2~ ~16~) BEGIN
	  PATCH_IF ~%SOURCE_RES%~ STRING_EQUAL_CASE ~spwi110~ 	BEGIN	// identify
		WRITE_BYTE 0x1f (%bard_excludes% BOR ~0b10000000~)  // unusable by archers
	  END
	END
  END
BUT_ONLY


// make .2da file for shared effects__________________________________________________
//
//COPY ~might_and_guile/nubards/d5_bard.2da~ ~override/d5nubard.2da~
<<<<<<<< d5/d5nubard.2da

NU_BARDS    AP_D5_1HP   AP_D5_1HP   AP_D5_1HP   AP_D5_1HP   AP_D5_1HP   AP_D5_1HP   AP_D5_1HP   AP_D5_1HP   AP_D5_1HP   AP_D5_1HP   ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 

>>>>>>>> 
COPY ~d5/d5nubard.2da~ ~override/d5nubard.2da~


// immunity to backstab bonus_________________________________________________________
//
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5nbstb.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 101 target = 1 parameter2 = 263 END

APPEND ~d5nubard.2da~ ~NOBKSTAB    AP_D5NBSTB  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~


//ARMORED CASTING FOR BARDS__________________________________________________________
//
// ***** NOTE: this is not currently compatible with broader armored casting mods
/*
INCLUDE ~%MOD_FOLDER%/lib/d5_armored_casting.tpa~

LAM D5_ARMORED_CASTING

APPEND ~d5nubard.2da~ ~ARMOR_CAST  AP_D5ARCA1  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
*/

CREATE EFF ~d5bncast~										// 	disable casting button
	WRITE_LONG 0x10 144
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 2
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100

COPY_EXISTING_REGEXP GLOB ~^.+\.itm$~ ~override~
  PATCH_IF (SOURCE_SIZE > 0x71) BEGIN
	READ_SHORT 0x1c type
	READ_LONG 0x22 appearance
	PATCH_IF (type = 2) BEGIN 								// armor
	  PATCH_IF (appearance = 16691) BEGIN 					// chain appearance
		PATCH_IF NOT FILE_EXISTS_IN_GAME ~d5_armcast.d5~ BEGIN
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_bard_code%    parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_blade_code%   parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_jester_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_skald_code%   parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_gallant_code% parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_agent_code%   parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_meister_code% parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_jinxer_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_elegist_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_hexblade_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_bladesinger_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		END
		PATCH_IF FILE_EXISTS_IN_GAME ~d5_armcast.d5~ BEGIN
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_bard_code%    parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_blade_code%   parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_jester_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_skald_code%   parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_gallant_code% parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_agent_code%   parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_meister_code% parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_jinxer_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_elegist_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_hexblade_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_bladesinger_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcac~ resource = ~d5bncast~ END
		END
	  END
	  PATCH_IF (appearance = 16692) BEGIN 					// plate appearance
		PATCH_IF NOT FILE_EXISTS_IN_GAME ~d5_armcast.d5~ BEGIN
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_bard_code%    parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_blade_code%   parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_jester_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_skald_code%   parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_gallant_code% parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_agent_code%   parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_meister_code% parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_jinxer_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_elegist_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_hexblade_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 145 opcode = 177 parameter1 = %nu_bladesinger_code%  parameter2 = 9 STR_VAR resource = ~d5bncast~ END
		END
		PATCH_IF FILE_EXISTS_IN_GAME ~d5_armcast.d5~ BEGIN
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_bard_code%    parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_blade_code%   parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_jester_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_skald_code%   parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_gallant_code% parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_agent_code%   parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_meister_code% parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_jinxer_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_elegist_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_hexblade_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 opcode = 177 parameter1 = %nu_bladesinger_code%  parameter2 = 9 STR_VAR match_resource = ~d5arcap~ resource = ~d5bncast~ END
		END
	  END
	END
  END
BUT_ONLY
//___________________________________________________________________________________


//INSTALL NEW BARD AURAS_____________________________________________________________
//
// set these up as innate abilities. 
// need 206 spells for each, and an overarching 206 spell to apply them
// and learn spells to cancel the 206 spells
// and a 'stop song' ability
// 'stop song' has 171 effects for every song
// every song activation has 172 effects for every song

//bard inspirations___________________________________________________________________
//
COPY ~might_and_guile/nubards/d5bdmusx.bam~ ~override~			//		no song icon
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bdxxx.spl~	//		stop song
  SAY NAME1 @21003
  SAY UNIDENTIFIED_DESC @21003
  LPF ALTER_ITEM_HEADER INT_VAR target = 7 STR_VAR icon = ~d5bdmusx~ END
  PATCH_FOR_EACH nu_song_a IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song_a%~ END
  END
  PATCH_FOR_EACH nu_song_y IN ~01y~ ~02y~ ~03y~ ~05y~ ~06y~ ~07y~ ~08y~ ~20y~ ~21y~ ~22y~ ~23y~ ~24y~ ~25y~ ~41y~ ~42y~ ~43y~ ~46y~ ~47y~ ~48y~ ~49y~ ~51y~ ~61y~ BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = 0 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song_y%~ END
  END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bdyyy.spl~	//		add new learned songs
  PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
  END
  PATCH_FOR_EACH nu_song_y IN ~01y~ ~02y~ ~03y~ ~05y~ ~06y~ ~07y~ ~08y~ ~20y~ ~21y~ ~22y~ ~23y~ ~24y~ ~25y~ ~41y~ ~42y~ ~43y~ ~46y~ ~47y~ ~48y~ ~49y~ ~51y~ ~61y~ BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = 0 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song_y%~ END
  END

OUTER_SET spell_op38_ind = 0
OUTER_SPRINT $opcode_38_spells(~%spell_op38_ind%~) ~opcode_38_spell~
COPY_EXISTING_REGEXP GLOB ~^.+\.spl$~ ~override~
  PATCH_IF (%SOURCE_SIZE% > 0x71) BEGIN
  	SET opcode_38 = 0
	READ_BYTE     0x2f current ELSE 0
	READ_BYTE     0x2b current2 ELSE 0
	READ_LONG 0x64 headoffset  ELSE 0
	READ_SHORT 0x68 headcount  ELSE 0
	READ_LONG 0x6a effectsoffset  ELSE 0
	FOR (headcyc = 0; headcyc < headcount ; headcyc = headcyc + 1) BEGIN
      this_head = 0
	  READ_SHORT (headoffset + (headcyc * 0x28) + 0x1e) effcount  ELSE 0
	  READ_SHORT (headoffset + (headcyc * 0x28) + 0x20) effectsindex  ELSE 0
	  FOR (effcyc = 0; effcyc < effcount; effcyc = effcyc + 1) BEGIN
		READ_SHORT (effectsoffset + (effectsindex + effcyc)* 0x30) opcode ELSE 0
		PATCH_IF (opcode = 38) AND (this_head = 0) BEGIN
		  SET opcode_38 = 1
		  SET this_head = 1
		END
	  END
	END
	PATCH_IF (opcode_38 = 1) BEGIN
	  SPRINT $opcode_38_spells(~%spell_op38_ind%~) ~%SOURCE_RES%~
	  SET ++spell_op38_ind
	END
  END
BUT_ONLY

ACTION_PHP_EACH opcode_38_spells AS ind => op38_spell BEGIN
  COPY_EXISTING ~%op38_spell%.spl~ ~override~
	PATCH_FOR_EACH nu_song_a IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 38 opcode = 321 timing = 1 duration = 0 STR_VAR resource = ~d5bd%nu_song_a%~ END
	END
  BUT_ONLY
END

//bard inspirations___________________________________________________________________
//
COPY ~might_and_guile/nubards/d5_bd01b.bam~ ~override~			//		song icon
COPY ~might_and_guile/nubards/d5bd01a.spl~ ~override~			//		luck inspiration
	SAY NAME1 @21011
	SAY UNIDENTIFIED_DESC @21012
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd01b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 4096 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd01b.eff~ ~override~			//		232 eff triggered by song
COPY ~might_and_guile/nubards/d5bd01b.spl~ ~override~			//		aura triggered by 232 eff
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub01.spl~	//		learn song
	SAY NAME1 @21011
	SAY UNIDENTIFIED_DESC @21012
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd01b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd01b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd01z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd01z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD01Y~ END
// 146 to cast new spell
// new spell removes all songs and gives all songs
// all songs, while in effect, should protect from new spell (in 'a' spells?)
//	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
//	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd01z.spl~	//		206 vs. give song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD01Y~ END
CREATE EFF ~d5bd01y~											// 		give song
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd01a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD01Y~ #8
COPY_EXISTING ~d5ub01.spl~ ~override/d5vb01.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd02b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd02a.spl~ ~override~			//		courage inspiration
	SAY NAME1 @21021
	SAY UNIDENTIFIED_DESC @21022
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd02b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd02b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd02b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub02.spl~
	SAY NAME1 @21021
	SAY UNIDENTIFIED_DESC @21022
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd02b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd02b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd02z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd02z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD02Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd02z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD02Y~ END
CREATE EFF ~d5bd02y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd02a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD02Y~ #8
COPY_EXISTING ~d5ub02.spl~ ~override/d5vb02.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd03b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd03a.spl~ ~override~			//		power inspiration
	SAY NAME1 @21031
	SAY UNIDENTIFIED_DESC @21032
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd03b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd03b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd03b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub03.spl~
	SAY NAME1 @21031
	SAY UNIDENTIFIED_DESC @21032
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd03b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd03b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd03z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd03z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD03Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd03z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD03Y~ END
CREATE EFF ~d5bd03y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd03a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD03Y~ #8
COPY_EXISTING ~d5ub03.spl~ ~override/d5vb03.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd05b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd05a.spl~ ~override~			//		RI inspiration
	SAY NAME1 @21051
	SAY UNIDENTIFIED_DESC @21052
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd05b~ END
	WRITE_SHORT 0x1c 1
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd05b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd05b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub05.spl~
	SAY NAME1 @21051
	SAY UNIDENTIFIED_DESC @21052
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd05b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd05b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd05z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd05z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD05Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd05z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD05Y~ END
CREATE EFF ~d5bd05y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd05a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD05Y~ #8
COPY_EXISTING ~d5ub05.spl~ ~override/d5vb05.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd06b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd06a.spl~ ~override~			//		bless inspiration
	SAY NAME1 @21061
	SAY UNIDENTIFIED_DESC @21062
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd06b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd06b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd06b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub06.spl~
	SAY NAME1 @21061
	SAY UNIDENTIFIED_DESC @21062
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd06b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd06b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd06z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd06z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD06Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd06z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD06Y~ END
CREATE EFF ~d5bd06y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd06a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD06Y~ #8
COPY_EXISTING ~d5ub06.spl~ ~override/d5vb06.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd07b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd07a.spl~ ~override~			//		NPP inspiration
	SAY NAME1 @21071
	SAY UNIDENTIFIED_DESC @21072
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd07b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd07b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd07b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub07.spl~
	SAY NAME1 @21071
	SAY UNIDENTIFIED_DESC @21072
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd07b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd07b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd07z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd07z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD07Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd07z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD07Y~ END
CREATE EFF ~d5bd07y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd07a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD07Y~ #8
COPY_EXISTING ~d5ub07.spl~ ~override/d5vb07.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd08b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd08a.spl~ ~override~			//		mind shield inspiration
	SAY NAME1 @21081
	SAY UNIDENTIFIED_DESC @21082
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd08b~ END
	WRITE_SHORT 0x1c 1
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd08b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd08b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub08.spl~
	SAY NAME1 @21081
	SAY UNIDENTIFIED_DESC @21082
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd08b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd08b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd08z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd08z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD08Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd08z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD08Y~ END
CREATE EFF ~d5bd08y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd08a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD08Y~ #8
COPY_EXISTING ~d5ub08.spl~ ~override/d5vb08.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd09b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd09a.spl~ ~override~			//		death ward inspiration
	SAY NAME1 @21091
	SAY UNIDENTIFIED_DESC @21092
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd09b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd09b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd09b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub09.spl~
	SAY NAME1 @21091
	SAY UNIDENTIFIED_DESC @21092
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd09b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd09b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd09z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd09z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD09Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd09z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD09Y~ END
CREATE EFF ~d5bd09y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd09a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD09Y~ #8
COPY_EXISTING ~d5ub09.spl~ ~override/d5vb09.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd20b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd20a.spl~ ~override~			//		casting interference emanation
	SAY NAME1 @21201
	SAY UNIDENTIFIED_DESC @21202
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd20b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd20b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd20b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub20.spl~
	SAY NAME1 @21201
	SAY UNIDENTIFIED_DESC @21202
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd20b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd20b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd20z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd20z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD20Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd20z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD20Y~ END
CREATE EFF ~d5bd20y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd20a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD20Y~ #8
COPY_EXISTING ~d5ub20.spl~ ~override/d5vb20.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd21b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd21a.spl~ ~override~			//		combat penalties emanation
	SAY NAME1 @21211
	SAY UNIDENTIFIED_DESC @21212
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd21b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd21b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd21b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub21.spl~
	SAY NAME1 @21211
	SAY UNIDENTIFIED_DESC @21212
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd21b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd21b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd21z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd21z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD21Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd21z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD21Y~ END
CREATE EFF ~d5bd21y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd21a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD21Y~ #8
COPY_EXISTING ~d5ub21.spl~ ~override/d5vb21.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd22b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd22a.spl~ ~override~			//		save penalties emanation
	SAY NAME1 @21221
	SAY UNIDENTIFIED_DESC @21222
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd22b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd22b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd22b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub22.spl~
	SAY NAME1 @21221
	SAY UNIDENTIFIED_DESC @21222
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd22b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd22b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd22z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd22z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD22Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd22z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD22Y~ END
CREATE EFF ~d5bd22y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd22a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD22Y~ #8
COPY_EXISTING ~d5ub22.spl~ ~override/d5vb22.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd23b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd23a.spl~ ~override~			//		confusion emanation
	SAY NAME1 @21231
	SAY UNIDENTIFIED_DESC @21232
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd23b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd23b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd23b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub23.spl~
	SAY NAME1 @21231
	SAY UNIDENTIFIED_DESC @21232
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd23b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd23b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd23z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd23z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD23Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd23z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD23Y~ END
CREATE EFF ~d5bd23y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd23a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD23Y~ #8
COPY_EXISTING ~d5ub23.spl~ ~override/d5vb23.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd24b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd24a.spl~ ~override~			//		hold undead emanation
	SAY NAME1 @21241
	SAY UNIDENTIFIED_DESC @21242
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd24b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd24b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd24b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub24.spl~
	SAY NAME1 @21241
	SAY UNIDENTIFIED_DESC @21242
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd24b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd24b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd24z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd24z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD24Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd24z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD24Y~ END
CREATE EFF ~d5bd24y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd24a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD24Y~ #8
COPY_EXISTING ~d5ub24.spl~ ~override/d5vb24.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd25b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd25a.spl~ ~override~			//		entangle emanation
	SAY NAME1 @21251
	SAY UNIDENTIFIED_DESC @21252
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd25b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd25b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd25b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub25.spl~
	SAY NAME1 @21251
	SAY UNIDENTIFIED_DESC @21252
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd25b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd25b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd25z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd25z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD25Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd25z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD25Y~ END
CREATE EFF ~d5bd25y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd25a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD25Y~ #8
COPY_EXISTING ~d5ub25.spl~ ~override/d5vb25.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd41b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd41a.spl~ ~override~			//		blur aura
	SAY NAME1 @21411
	SAY UNIDENTIFIED_DESC @21412
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd41b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
//COPY ~might_and_guile/nubards/d5bd41a.eff~ ~override~
COPY ~might_and_guile/nubards/d5bd41b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd41b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub41.spl~
	SAY NAME1 @21411
	SAY UNIDENTIFIED_DESC @21412
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd41b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd41b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd41z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd41z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD41Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd41z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD41Y~ END
CREATE EFF ~d5bd41y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd41a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD41Y~ #8
COPY_EXISTING ~d5ub41.spl~ ~override/d5vb41.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd42b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd42a.spl~ ~override~			//		mind blank aura
	SAY NAME1 @21421
	SAY UNIDENTIFIED_DESC @21422
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd42b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd42b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd42b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub42.spl~
	SAY NAME1 @21421
	SAY UNIDENTIFIED_DESC @21422
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 2
	END ELSE BEGIN
	  WRITE_LONG 0x34 1
	END
	WRITE_ASCII 0x3a ~d5_bd42b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd42b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd42z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd42z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD42Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd42z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD42Y~ END
CREATE EFF ~d5bd42y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd42a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD42Y~ #8
COPY_EXISTING ~d5ub42.spl~ ~override/d5vb42.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd43b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd43a.spl~ ~override~			//		MGOI aura
	SAY NAME1 @21431
	SAY UNIDENTIFIED_DESC @21432
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd43b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd43b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd43b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub43.spl~
	SAY NAME1 @21431
	SAY UNIDENTIFIED_DESC @21432
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd43b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd43b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd43z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd43z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD43Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd43z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD43Y~ END
CREATE EFF ~d5bd43y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd43a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD43Y~ #8
COPY_EXISTING ~d5ub43.spl~ ~override/d5vb43.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd46b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd46a.spl~ ~override~			//		fear aura
	SAY NAME1 @21461
	SAY UNIDENTIFIED_DESC @21462
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd46b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd46b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd46b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub46.spl~
	SAY NAME1 @21461
	SAY UNIDENTIFIED_DESC @21462
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd46b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd46b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd46z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd46z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD46Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd46z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD46Y~ END
CREATE EFF ~d5bd46y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd46a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD46Y~ #8
COPY_EXISTING ~d5ub46.spl~ ~override/d5vb46.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd47b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd47a.spl~ ~override~			//		slow aura
	SAY NAME1 @21471
	SAY UNIDENTIFIED_DESC @21472
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd47b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd47b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd47b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub47.spl~
	SAY NAME1 @21471
	SAY UNIDENTIFIED_DESC @21472
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd47b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd47b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd47z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd47z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD47Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd47z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD47Y~ END
CREATE EFF ~d5bd47y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd47a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD47Y~ #8
COPY_EXISTING ~d5ub47.spl~ ~override/d5vb47.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd48b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd48a.spl~ ~override~			//		dispel illusions aura
	SAY NAME1 @21481
	SAY UNIDENTIFIED_DESC @21482
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd48b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd48b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd48b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub48.spl~
	SAY NAME1 @21481
	SAY UNIDENTIFIED_DESC @21482
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd48b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd48b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd48z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd48z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD48Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd48z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD48Y~ END
CREATE EFF ~d5bd48y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd48a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD48Y~ #8
COPY_EXISTING ~d5ub48.spl~ ~override/d5vb48.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd49b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd49a.spl~ ~override~			//		hex aura
	SAY NAME1 @21491
	SAY UNIDENTIFIED_DESC @21492
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd49b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd49b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd49b.eff~ ~override~
COPY ~might_and_guile/nubards/d5bd49c.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd49c.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub49.spl~
	SAY NAME1 @21491
	SAY UNIDENTIFIED_DESC @21492
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd49b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd49b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd49z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd49z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD49Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd49z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD49Y~ END
CREATE EFF ~d5bd49y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd49a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD49Y~ #8
COPY_EXISTING ~d5ub49.spl~ ~override/d5vb49.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd51b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd51a.spl~ ~override~			//		bladesong
	SAY NAME1 @21511
	SAY UNIDENTIFIED_DESC @21512
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd51b~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
//COPY ~might_and_guile/nubards/d5bd51a.eff~ ~override~
COPY ~might_and_guile/nubards/d5bd51b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd51b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub51.spl~
	SAY NAME1 @21511
	SAY UNIDENTIFIED_DESC @21512
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd51b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd51b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd51z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd51z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD51Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd51z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD51Y~ END
CREATE EFF ~d5bd51y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd51a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD51Y~ #8
COPY_EXISTING ~d5ub51.spl~ ~override/d5vb51.spl~
	WRITE_SHORT 0x1c 1

COPY ~might_and_guile/nubards/d5_bd61b.bam~ ~override~
COPY ~might_and_guile/nubards/d5bd61a.spl~ ~override~			//		maze aura
	SAY NAME1 @21611
	SAY UNIDENTIFIED_DESC @21612
	LPF ALTER_SPELL_HEADER INT_VAR target = 5 location = 4 STR_VAR icon = ~d5_bd61~ END
	WRITE_SHORT 0x1c 4
	PATCH_FOR_EACH nu_song IN ~01a~ ~02a~ ~03a~ ~05a~ ~06a~ ~07a~ ~08a~ ~20a~ ~21a~ ~22a~ ~23a~ ~24a~ ~25a~ ~41a~ ~42a~ ~43a~ ~46a~ ~47a~ ~48a~ ~49a~ ~51a~ ~61a~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song%~ END
	END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bdxxx~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 1 STR_VAR resource = ~d5bdyyy~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 0x00001000 parameter2 = 138 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 38 parameter2 = 110 timing = 0 duration = 1 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
COPY ~might_and_guile/nubards/d5bd61b.spl~ ~override~
COPY ~might_and_guile/nubards/d5bd61b.eff~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ub61.spl~
	SAY NAME1 @21611
	SAY UNIDENTIFIED_DESC @21612
	WRITE_SHORT 0x1c 2
	PATCH_IF GAME_IS ~iwdee~ BEGIN
	  WRITE_LONG 0x34 4
	END ELSE BEGIN
	  WRITE_LONG 0x34 2
	END
	WRITE_ASCII 0x3a ~d5_bd61b~ #8
	LPF ALTER_SPELL_HEADER INT_VAR location = 4 STR_VAR icon = ~d5_bd61b~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd61z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd61z~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bdyyy~ END
//	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~D5BD61Y~ END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd61z.spl~	//		206 song
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~D5BD61Y~ END
CREATE EFF ~d5bd61y~
	WRITE_LONG 0x10 171
	WRITE_LONG 0x14 1
	WRITE_LONG 0x24 9
	WRITE_LONG 0x28 0
	WRITE_SHORT 0x2c 100
	WRITE_EVALUATED_ASCII 0x30 ~d5bd61a~ #8
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5BD61Y~ #8
COPY_EXISTING ~d5ub61.spl~ ~override/d5vb61.spl~
	WRITE_SHORT 0x1c 1
//___________________________________________________________________________________


// add new auras to world_____________________________________________________________
//
COPY ~might_and_guile/nubards/d5bd05.itm~ ~override~			//		mirror images
  SAY NAME2 @21051
  SAY IDENTIFIED_DESC @21052
  LPF ALTER_ITEM_HEADER INT_VAR target = 5 END
  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 177 parameter1 = %nu_bard_code% parameter2 = 9 STR_VAR resource = ~d5bd05ib~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_blade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jester_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_skald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_gallant_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_herald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_meister_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jinxer_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_elegist_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_hexblade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_agent_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_code% STR_VAR resource = ~d5bd05ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_ct_code% STR_VAR resource = ~d5bd05ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_bladesinger_code% END
CREATE EFF ~d5bd05ib~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd05~ #8
	WRITE_ASCII 0x30 ~d5ub05l~ #8
CREATE EFF ~d5bd05ic~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd05~ #8
	WRITE_ASCII 0x30 ~d5vb05l~ #8
/*
ACTION_IF FILE_EXISTS_IN_GAME ~pwarden.cre~ BEGIN
  COPY_EXISTING ~pwarden.cre~ ~override~
	ADD_CRE_ITEM ~d5bd05~ #1 #0 #0 ~IDENTIFIED~ ~INV~
END
*/
ACTION_IF FILE_EXISTS_IN_GAME ~raelis.dlg~ BEGIN
  COMPILE ~might_and_guile/nubards/raelisadd.d~
END
ACTION_IF (FILE_EXISTS_IN_GAME ~edion.sto~)THEN BEGIN
  COPY_EXISTING ~edion.sto~ ~override~
	ADD_STORE_ITEM ~d5bd05~ #1 #0 #0 ~identified~ #1
END

COPY ~might_and_guile/nubards/d5bd08.itm~ ~override~			//		mind shield
  SAY NAME2 @21081
  SAY IDENTIFIED_DESC @21082
  LPF ALTER_ITEM_HEADER INT_VAR target = 5 END
  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 177 parameter1 = %nu_bard_code% parameter2 = 9 STR_VAR resource = ~d5bd08ib~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_blade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jester_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_skald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_gallant_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_herald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_meister_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jinxer_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_elegist_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_hexblade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_agent_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_code% STR_VAR resource = ~d5bd08ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_ct_code% STR_VAR resource = ~d5bd08ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_bladesinger_code% END
CREATE EFF ~d5bd08ib~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd08~ #8
	WRITE_ASCII 0x30 ~d5ub08l~ #8
CREATE EFF ~d5bd08ic~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd08~ #8
	WRITE_ASCII 0x30 ~d5vb08l~ #8

ACTION_IF FILE_EXISTS_IN_GAME ~pirmur01.cre~ BEGIN
  COPY_EXISTING ~pirmur01.cre~ ~override~
	ADD_CRE_ITEM ~d5bd08~ #1 #0 #0 ~IDENTIFIED~ ~INV~
END

COPY ~might_and_guile/nubards/d5bd24.itm~ ~override~			//		hold undead
  SAY NAME2 @21241
  SAY IDENTIFIED_DESC @21242
  LPF ALTER_ITEM_HEADER INT_VAR target = 5 END
  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 177 parameter1 = %nu_bard_code% parameter2 = 9 STR_VAR resource = ~d5bd24ib~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_blade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jester_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_skald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_gallant_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_herald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_meister_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jinxer_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_elegist_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_hexblade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_agent_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_code% STR_VAR resource = ~d5bd24ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_ct_code% STR_VAR resource = ~d5bd24ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_bladesinger_code% END
CREATE EFF ~d5bd24ib~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd24~ #8
	WRITE_ASCII 0x30 ~d5ub24l~ #8
CREATE EFF ~d5bd24ic~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd24~ #8
	WRITE_ASCII 0x30 ~d5vb24l~ #8

ACTION_IF FILE_EXISTS_IN_GAME ~theshal.cre~ BEGIN
  COPY_EXISTING ~theshal.cre~ ~override~
	ADD_CRE_ITEM ~d5bd24~ #0 #0 #0 ~IDENTIFIED~ ~INV~
END
ACTION_IF (FILE_EXISTS_IN_GAME ~shlehlan.sto~)THEN BEGIN
  COPY_EXISTING ~shlehlan.sto~ ~override~
	ADD_STORE_ITEM ~d5bd24~ #1 #0 #0 ~identified~ #1
END

COPY ~might_and_guile/nubards/d5bd25.itm~ ~override~			//		entangle
  SAY NAME2 @21251
  SAY IDENTIFIED_DESC @21252
  LPF ALTER_ITEM_HEADER INT_VAR target = 5 END
  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 177 parameter1 = %nu_bard_code% parameter2 = 9 STR_VAR resource = ~d5bd25ib~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_blade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jester_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_skald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_gallant_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_herald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_meister_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jinxer_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_elegist_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_hexblade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_agent_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_code% STR_VAR resource = ~d5bd25ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_ct_code% STR_VAR resource = ~d5bd25ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_bladesinger_code% END
CREATE EFF ~d5bd25ib~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd25~ #8
	WRITE_ASCII 0x30 ~d5ub25l~ #8
CREATE EFF ~d5bd25ic~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd25~ #8
	WRITE_ASCII 0x30 ~d5vb25l~ #8

ACTION_IF FILE_EXISTS_IN_GAME ~jugmim01.cre~ BEGIN
  COPY_EXISTING ~jugmim01.cre~ ~override~
	ADD_CRE_ITEM ~d5bd25~ #1 #0 #0 ~IDENTIFIED~ ~INV~
END

COPY ~might_and_guile/nubards/d5bd48.itm~ ~override~			//		dispel illusions
  SAY NAME2 @21481
  SAY IDENTIFIED_DESC @21482
  LPF ALTER_ITEM_HEADER INT_VAR target = 5 END
  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 177 parameter1 = %nu_bard_code% parameter2 = 9 STR_VAR resource = ~d5bd48ib~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_blade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jester_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_skald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_gallant_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_herald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_meister_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jinxer_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_elegist_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_hexblade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_agent_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_code% STR_VAR resource = ~d5bd48ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_ct_code% STR_VAR resource = ~d5bd48ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_bladesinger_code% END
CREATE EFF ~d5bd48ib~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd48~ #8
	WRITE_ASCII 0x30 ~d5ub48l~ #8
CREATE EFF ~d5bd48ic~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd48~ #8
	WRITE_ASCII 0x30 ~d5vb48l~ #8

ACTION_IF (FILE_EXISTS_IN_GAME ~stoblack.sto~)THEN BEGIN
  COPY_EXISTING ~stoblack.sto~ ~override~
	ADD_STORE_ITEM ~d5bd48~ #0 #0 #0 ~identified~ #1
END

/*
COPY ~might_and_guile/nubards/d5bd51.itm~ ~override~			//		bladesong
  SAY NAME2 @21511
  SAY IDENTIFIED_DESC @21512
  LPF ALTER_ITEM_HEADER INT_VAR target = 5 END
  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 177 parameter1 = %nu_bard_code% parameter2 = 9 STR_VAR resource = ~d5bd51ib~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_blade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jester_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_skald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_gallant_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_herald_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_meister_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_jinxer_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_elegist_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_hexblade_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_agent_code% END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_code% STR_VAR resource = ~d5bd51ic~ END
  LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 177 match_parameter1 = %nu_bard_code% match_parameter2 = 9 parameter1 = %nu_loresinger_ct_code% STR_VAR resource = ~d5bd51ic~ END
CREATE EFF ~d5bd51ib~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd51~ #8
	WRITE_ASCII 0x30 ~d5ub51l~ #8
CREATE EFF ~d5bd51ic~
	WRITE_LONG 0x10 146
	WRITE_LONG 0x14 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
//	WRITE_ASCII 0x30 ~d5bd51~ #8
	WRITE_ASCII 0x30 ~d5vb51l~ #8
	
// need to put the scroll somewhere...
*/
//___________________________________________________________________________________


// add support for feat system________________________________________________________
//
ACTION_DEFINE_ASSOCIATIVE_ARRAY feat_nums_lets BEGIN
	1	=> a
	2	=> b
	3	=> c
	4	=> d
	5	=> e
	6	=> f
	7	=> g
	8	=> h
	9	=> i
	10	=> j
	11	=> k
	12	=> l
	13	=> m
	14	=> n
	15	=> o
	16	=> p
	17	=> q
	18	=> r
	19	=> s
	20	=> t
END

INCLUDE ~might_and_guile/lib/sequencer_menu_d5.tpa~

COPY ~might_and_guile/feats/d5flstb.2da~ ~override~

ACTION_IF !(FILE_EXISTS_IN_GAME ~d5ftskn.2da~) BEGIN
 ACTION_IF !(GAME_IS ~iwdee~) BEGIN
  COPY ~might_and_guile/feats/d5ftskn.2da~ ~override~
 END
 ACTION_IF (GAME_IS ~iwdee~) BEGIN
  COPY ~might_and_guile/feats/d5ftskn_iwd.2da~ ~override/d5ftskn.2da~
 END
END

OUTER_SPRINT feat_select_string @20011 // ~Feat Selection~ 
OUTER_SET feat_select_strref = RESOLVE_STR_REF (%feat_select_string%)
OUTER_SPRINT feat_title_string @20012 
OUTER_SPRINT feat_label_string @20013 

/*
ACTION_FOR_EACH high_level_feat IN 
	~d5ub08~ 
	~d5vb08~ 
	~d5ub23~ 
	~d5vb23~ 
	~d5ub43~ 
	~d5vb43~  
	~d5ub47~ 
	~d5vb47~ BEGIN
  COPY_EXISTING ~%high_level_feat%.spl~ ~override~
	WRITE_LONG 0x34 4
  IF_EXISTS BUT_ONLY
END
*/

ACTION_IF !(FILE_EXISTS_IN_GAME ~d5_rfeat.d5~) BEGIN

  COPY ~might_and_guile/feats/d5_feat.bam~ ~override~

  ACTION_PHP_EACH feat_nums_lets AS num => let BEGIN
	ACTION_IF !(FILE_EXISTS_IN_GAME ~d5feat%num%.spl~) BEGIN
	  COPY ~might_and_guile/feats/d5feat1.spl~ ~override/d5feat%num%.spl~ 
		LPF DELETE_EFFECT INT_VAR match_opcode = 206 END
		LPF ALTER_EFFECT INT_VAR match_opcode = 177 STR_VAR match_resource = ~d5feat1~ resource = EVAL ~d5feat%num%~ END
	END
	ACTION_IF !(FILE_EXISTS_IN_GAME ~d5feat%num%.eff~) BEGIN
	  COPY ~might_and_guile/feats/d5feat1.eff~ ~override/d5feat%num%.eff~ 
		WRITE_EVALUATED_ASCII 0x30 ~d5feat%let%~ #8
	END
	ACTION_IF !(FILE_EXISTS_IN_GAME ~d5feat%let%.spl~) BEGIN
	  COPY ~might_and_guile/misc/d5_base.spl~ ~override/d5feat%let%.spl~
		SAY NAME1 @20099
		SAY UNIDENTIFIED_DESC @20100
		WRITE_ASCII 0x3a ~d5_feat~ #8
		LPF ALTER_SPELL_HEADER INT_VAR target = 7 STR_VAR icon = ~d5_feat~ END
		LPF ADD_SPELL_CFEFFECT INT_VAR insert_point = 0 opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~d5feat%let%~ END
		LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5feat%num%~ END
	END
  END

  COPY_EXISTING ~kitlist.2da~ ~override~
	READ_2DA_ENTRIES_NOW r2en_kitlist 10
	FOR (row = 2; row < r2en_kitlist; ++row) BEGIN
	  READ_2DA_ENTRY_FORMER r2en_kitlist row 5 kitlist_2da
	  PATCH_IF (~%kitlist_2da%~ STRING_EQUAL_CASE ~d5_bard~) BEGIN
		READ_2DA_ENTRY_FORMER r2en_kitlist row 0 kitlist_index
		READ_2DA_ENTRY_FORMER r2en_kitlist row 3 kitlist_name
		READ_2DA_ENTRY_FORMER r2en_kitlist row 9 kitids_num
		GET_STRREF %kitlist_name% kit_name_strref
		SPRINT feat_select_name ~%kit_name_strref% %feat_select_string%~
		SET kit_seq_name = RESOLVE_STR_REF (~%feat_select_name%~) 
		SET kit_seq_tip = RESOLVE_STR_REF (~%feat_select_name%~) 
		SET kit_seq_index = %kitlist_index% 
		INNER_ACTION BEGIN
		  COPY_EXISTING ~d5flstb.2da~ ~override~
			COUNT_2DA_COLS cols
			COUNT_2DA_ROWS cols rows
			FOR (col = 1; col < (cols - 1); ++col) BEGIN
			  READ_2DA_ENTRY 0 (col - 1) (cols - 1) feat_kit_2da
			  PATCH_IF (~%feat_kit_2da%~ STRING_EQUAL_CASE ~d5_bard~) BEGIN
				SET this_col = %col%
				INNER_ACTION BEGIN
				  LAF CREATE_SEQUENCER_MENU 
				   INT_VAR 
					name = %kit_seq_name%
					tip = %kit_seq_tip%
					desc = RESOLVE_STR_REF (~blah~) 
					column = %this_col% 
					class = 2
				   STR_VAR 
					resref = EVAL ~d5ft%kit_seq_index%~
					icon = ~spcl919b~
					spelltable = ~d5ftskn~ 
					spelllist = ~d5flstb~
					title = EVAL ~%feat_title_string%~
					label = EVAL ~%feat_label_string%~
				  END
				  COPY_EXISTING ~d5ft%kit_seq_index%.spl~ ~override~
					LPF DELETE_EFFECT INT_VAR match_opcode = 171 STR_VAR match_resource = EVAL ~d5ft%kit_seq_index%~ END
				  BUT_ONLY IF_EXISTS
				END
			  END
			END
		  BUT_ONLY
		  ACTION_FOR_EACH letter IN ~A~ ~B~ ~C~ ~D~ ~E~ ~F~ ~G~ ~H~ ~I~ ~J~ ~K~ ~L~ ~M~ ~N~ ~O~ ~P~ ~Q~ ~R~ ~S~ ~T~ BEGIN
			COPY_EXISTING ~d5feat%letter%.spl~ ~override~
			  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = %kitids_num% parameter2 = %kit_is_row% timing = 1 STR_VAR resource = EVAL ~d5ft%kit_seq_index%~ END
			IF_EXISTS BUT_ONLY
		  END
		END
	  END
	END
  BUT_ONLY
  COPY_EXISTING ~d5flstb.2da~ ~override~
	COUNT_2DA_COLS cols
	COUNT_2DA_ROWS cols rows
	FOR (row = 1; row < rows; ++row) BEGIN
  	  READ_2DA_ENTRY row 0 cols ~book_feat~
	  INNER_ACTION BEGIN
		COPY_EXISTING ~%book_feat%.spl~ ~override/%book_feat%L.spl~
		  WRITE_SHORT 0x1c 4
		  WRITE_LONG 0x34 1
		  LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 171 target = 1 timing = 9 STR_VAR resource = EVAL ~%book_feat%~ END
		IF_EXISTS BUT_ONLY
	  END
	END
  BUT_ONLY

 ACTION_PHP_EACH feat_bard_list AS ind => ids BEGIN
  COPY_EXISTING ~d5ft%ind%.spl~ ~override~
	LPF DELETE_EFFECT INT_VAR match_opcode = 171 STR_VAR match_resource = EVAL ~d5ft%ind%~ END
  IF_EXISTS BUT_ONLY
 END

  APPEND ~d5_bard.2da~ ~D5_SONGS    ****        ****        GA_D5FEATD  ****        ****        GA_D5FEATE  ****        ****        GA_D5FEATF  ****        ****        GA_D5FEATG  ****        ****        GA_D5FEATH  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~

END

ACTION_IF (FILE_EXISTS_IN_GAME ~d5_rfeat.d5~) BEGIN
 COPY ~might_and_guile/feats/d5flstbf.2da~ ~override~
 COPY_EXISTING ~d5flstbf.2da~ ~override~
  COUNT_2DA_COLS cols
  COUNT_2DA_ROWS cols rows
  FOR (col = 1; col < cols; ++col) BEGIN
	READ_2DA_ENTRY 0 (col - 1) (cols - 1) feat_kit_2da
	INNER_ACTION BEGIN
	  COPY_EXISTING ~kitlist.2da~ ~override~
		READ_2DA_ENTRIES_NOW rows 10
		FOR (row = 1; row < rows; ++row) BEGIN
	      READ_2DA_ENTRY_FORMER rows row 0 kitlist_index
	      READ_2DA_ENTRY_FORMER rows row 3 kitlist_name
	      READ_2DA_ENTRY_FORMER rows row 5 kitlist_2da
	      READ_2DA_ENTRY_FORMER rows row 9 kitids_num
	      PATCH_IF (~%kitlist_2da%~ STRING_EQUAL_CASE ~%feat_kit_2da%~) BEGIN
	        SPRINT $feat_bard_list(~%kitlist_index%~)~%kitids_num%~
			GET_STRREF %kitlist_name% kit_name_strref
			SPRINT feat_select_name ~%kit_name_strref% %feat_select_string%~
			SET kit_seq_name = RESOLVE_STR_REF (~%feat_select_name%~) 
			SET kit_seq_tip = RESOLVE_STR_REF (~%feat_select_name%~) 
			SET kit_seq_index = %kitlist_index% 
			INNER_ACTION BEGIN
			  LAF CREATE_SEQUENCER_MENU 
			   INT_VAR 
				name = %kit_seq_name%
				tip = %kit_seq_tip%
				desc = RESOLVE_STR_REF (~blah~) 
				column = %col% 
				class = 2
			   STR_VAR 
				resref = EVAL ~d5ft%kit_seq_index%~
				icon = ~spcl919b~
				spelltable = ~d5ftskn~ 
				spelllist = ~d5flstbf~
				title = EVAL ~%feat_title_string%~
				label = EVAL ~%feat_label_string%~
			  END
			END
		  END
		END
	  BUT_ONLY
	END
  END
 BUT_ONLY
 COPY_EXISTING ~d5flstbf.2da~ ~override~
	COUNT_2DA_COLS cols
	COUNT_2DA_ROWS cols rows
	FOR (row = 1; row < rows; ++row) BEGIN
  	  READ_2DA_ENTRY row 0 cols ~book_feat~
	  INNER_ACTION BEGIN
		COPY_EXISTING ~%book_feat%.spl~ ~override/%book_feat%L.spl~
		  WRITE_SHORT 0x1c 4
		  WRITE_LONG 0x34 1
		  LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 171 target = 1 timing = 9 STR_VAR resource = EVAL ~%book_feat%~ END
		IF_EXISTS BUT_ONLY
	  END
	END
 BUT_ONLY

 ACTION_PHP_EACH feat_nums_lets AS num => let BEGIN
/*
  COPY_EXISTING ~d5feat%num%.spl~ ~override~
	PATCH_FOR_EACH nu_bard_kit IN ~%nu_bard_code%~ ~%nu_blade_code%~ ~%nu_jester_code%~ ~%nu_skald_code%~ ~%nu_gallant_code%~ ~%nu_herald_code%~ ~%nu_meister_code%~ ~%nu_jinxer_code%~ ~%nu_elegist_code%~ ~%nu_agent_code%~ ~%nu_hexblade_code%~ ~%nu_bladesinger_code%~ ~%nu_loresinger_code%~ ~%nu_loresinger_ct_code%~ BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 177 target = 1 parameter1 = %nu_bard_kit% parameter2 = 9 STR_VAR resource = EVAL ~d5feat%num%~ END
	END
  IF_EXISTS BUT_ONLY
*/
  COPY_EXISTING ~d5feat%let%.spl~ ~override~
	PHP_EACH feat_bard_list AS ind => ids BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = %ids% parameter2 = %kit_is_row% timing = 1 STR_VAR resource = EVAL ~d5ft%ind%~ END
	END
  IF_EXISTS BUT_ONLY
 END

COPY ~might_and_guile/feats/d5mcft1.spl~ ~override/d5mcfb1.spl~
  LPF ALTER_EFFECT INT_VAR match_opcode = 318 parameter2 = %kit_is_row% END
  LPF CLONE_EFFECT INT_VAR match_opcode = 177 match_parameter1 = 15 parameter1 = 10 END
  LPF CLONE_EFFECT INT_VAR match_opcode = 177 match_parameter1 = 9 parameter1 = 7 END
  LPF CLONE_EFFECT INT_VAR match_opcode = 177 match_parameter1 = 9 parameter1 = 3 END
  LPF ALTER_EFFECT INT_VAR match_opcode = 206 STR_VAR resource = ~d5mcfb1~ END
COPY ~might_and_guile/feats/d5mcft1.eff~ ~override~

ACTION_PHP_EACH feat_nums_lets AS num => let BEGIN
  ACTION_IF (num > 1) && (num < 10) BEGIN
	ACTION_IF !(FILE_EXISTS_IN_GAME ~d5mcft%num%.eff~) BEGIN
	  COPY_EXISTING ~d5mcft1.eff~ ~override/d5mcft%num%.eff~
		WRITE_EVALUATED_ASCII 0x30 ~d5feat%let%~ #8
	  BUT_ONLY
	END
	COPY_EXISTING ~d5mcfb1.spl~ ~override/d5mcfb%num%.spl~
	  LPF ALTER_EFFECT INT_VAR match_opcode = 318 STR_VAR resource = EVAL ~d5mcfb%num%~ END
	  LPF ALTER_EFFECT INT_VAR match_opcode = 177 STR_VAR resource = EVAL ~d5mcft%num%~ END
	  LPF ALTER_EFFECT INT_VAR match_opcode = 206 STR_VAR resource = EVAL ~d5mcfb%num%~ END
	BUT_ONLY
  END
END

 ACTION_PHP_EACH feat_bard_list AS ind => ids BEGIN
  COPY_EXISTING ~d5ft%ind%.spl~ ~override~
	LPF DELETE_EFFECT INT_VAR match_opcode = 171 STR_VAR match_resource = EVAL ~d5ft%ind%~ END
  IF_EXISTS BUT_ONLY
 END

 ACTION_FOR_EACH nubard_kit IN ~d5_bard~ ~d5_blade~ ~d5_jstr~ ~d5_skld~ ~d5_glnt~ ~d5_hrld~ ~d5_mstr~ ~d5_jinx~ ~d5_eleg~ ~d5_hxbl~ ~d5_agnt~ ~d5_lors~ ~d5_lort~ ~d5_blads~ BEGIN
  COPY_EXISTING ~%nubard_kit%.2da~ ~override~
	LPM remove_blank_lines
	APPEND_FILE ~might_and_guile/feats/feats_multibard.txt~
  IF_EXISTS BUT_ONLY
 END
 APPEND ~d5_bard.2da~ ~D5_SONGS      GA_D5FEATK  ****        ****        ****        GA_D5FEATL  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~

// *****
// need to add 318 effects for bard kits to existing multiclass feat abilities (D5MCFT1-6)

END

ACTION_IF !(FILE_EXISTS_IN_GAME ~d5featx.spl~) BEGIN
  COPY ~might_and_guile/misc/d5_base.spl~ ~override/d5featx.spl~
END
COPY ~might_and_guile/feats/d5flstb.2da~ ~might_and_guile/temp/d5flstb.2da~
  COUNT_2DA_COLS cols
  COUNT_2DA_ROWS cols rows
  FOR (row = 1; row < rows; ++row) BEGIN
  	READ_2DA_ENTRY row 0 cols spellbook_feat
	INNER_ACTION BEGIN
	  COPY_EXISTING ~d5featx.spl~ ~override~
		LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~%spellbook_feat%~ END
	  BUT_ONLY
	END
  END
BUT_ONLY

ACTION_FOR_EACH nu_song IN ~01~ ~02~ ~03~ ~05~ ~06~ ~07~ ~08~ ~20~ ~21~ ~22~ ~23~ ~24~ ~25~ ~41~ ~42~ ~43~ ~46~ ~47~ ~48~ ~49~ ~51~ ~61~ BEGIN
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5ub%nu_song%.spl~) && !(FILE_EXISTS_IN_GAME ~d5ub%nu_song%l.spl~) BEGIN
	COPY_EXISTING ~d5ub%nu_song%.spl~ ~override/d5ub%nu_song%l.spl~
  END
  ACTION_IF (FILE_EXISTS_IN_GAME ~d5vb%nu_song%.spl~) && !(FILE_EXISTS_IN_GAME ~d5vb%nu_song%l.spl~) BEGIN
	COPY_EXISTING ~d5vb%nu_song%.spl~ ~override/d5vb%nu_song%l.spl~
  END
END
//___________________________________________________________________________________


// add more bard spells_______________________________________________________________
//
OUTER_SET nubard_spell_ind = 0
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~spell~

// BARD:

// Command:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr102.spl~ BEGIN
  COPY_EXISTING ~sppr102.spl~ ~override/d5bp102.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny102.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6102~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6102~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp102~
  OUTER_SET ++nubard_spell_ind
END

// Vocalize - lvl 1:
ACTION_IF FILE_EXISTS_IN_GAME ~spwi219.spl~ BEGIN
  COPY_EXISTING ~spwi219.spl~ ~override/d5bi219.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5iy219.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5i6219~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5i6219~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bi219~
  OUTER_SET ++nubard_spell_ind
END

// Silence:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr211.spl~ BEGIN
  COPY_EXISTING ~sppr211.spl~ ~override/d5bp211.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny211.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6211~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6211~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp211~
  OUTER_SET ++nubard_spell_ind
END

// IWD Shout:
ADD_PROJECTILE ~might_and_guile/nubards/d5shout.pro~
COPY ~might_and_guile/nubards/d5shout.spl~ ~override/d5bi431.spl~
	SAY NAME1 @21905
	SAY UNIDENTIFIED_DESC @21906
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 3
	WRITE_ASCII 0x3a ~SPWI431C~ #8
	LPF ALTER_SPELL_HEADER INT_VAR projectile = %d5shout% STR_VAR icon = ~SPWI431B~ END
COPY ~might_and_guile/nubards/#tra_08.wav~ ~override~
COPY ~might_and_guile/nubards/spwi431c.bam~ ~override~
COPY ~might_and_guile/nubards/spwi431b.bam~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5iy431.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~di6431~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5i6431~ END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bi431~
OUTER_SET ++nubard_spell_ind

// Exaltation/Break Enchantment:
ACTION_IF !(FILE_EXISTS_IN_GAME ~dvsrv4here.mrk~) AND (FILE_EXISTS_IN_GAME ~ohtyr1.spl~) BEGIN
  COPY_EXISTING ~ohtyr1.spl~ ~override/d5bp321.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 4
	LPF ALTER_SPELL_HEADER INT_VAR speed = 3 END
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny321.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6321~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6321~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp321~
  OUTER_SET ++nubard_spell_ind
END
ACTION_IF (FILE_EXISTS_IN_GAME ~dvsrv4here.mrk~) AND (FILE_EXISTS_IN_GAME ~spwi410.spl~) BEGIN
  COPY_EXISTING ~spwi410.spl~ ~override/d5bp321.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 4
	LPF ALTER_SPELL_HEADER INT_VAR speed = 3 END  
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny321.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6321~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6321~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp321~
  OUTER_SET ++nubard_spell_ind
END

// Greater Command:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr512.spl~ BEGIN
  COPY_EXISTING ~sppr512.spl~ ~override/d5bp512.spl~
	WRITE_SHORT 0x1c 1
END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp512~
OUTER_SET ++nubard_spell_ind

// IWD Great Shout:
COPY ~might_and_guile/nubards/d5gshou.spl~ ~override/d5bi806.spl~
	SAY NAME1 @21907
	SAY UNIDENTIFIED_DESC @21908
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
	WRITE_ASCII 0x3a ~SPWI806C~ #8
	LPF ALTER_SPELL_HEADER INT_VAR projectile = %d5shout% STR_VAR icon = ~SPWI806B~ END
COPY ~might_and_guile/nubards/#tra_08.wav~ ~override~
COPY ~might_and_guile/nubards/spwi806c.bam~ ~override~
COPY ~might_and_guile/nubards/spwi806b.bam~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5iy806.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5i6806~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5i6806~ END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bi806~
OUTER_SET ++nubard_spell_ind

// Earthquake:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr720.spl~ BEGIN
  COPY_EXISTING ~sppr720.spl~ ~override/d5bp720.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny720.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6720~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6720~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp720~
  OUTER_SET ++nubard_spell_ind
END

// make a spell with 171 effects for these base bardic spells, plus PW: Silence & Vocalize
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zbard.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5iy219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5iy431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5iy806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny720~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END

APPEND ~d5_bard.2da~ ~BASE_SPLS   AP_D5ZBARD  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

// JESTER:

// Miscast Magic:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr310.spl~ BEGIN
  COPY_EXISTING ~sppr310.spl~ ~override/d5bp310.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny310.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6310~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6310~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp310~
  OUTER_SET ++nubard_spell_ind
END

// Rigid Thinking:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr311.spl~ BEGIN
  COPY_EXISTING ~sppr311.spl~ ~override/d5bp311.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 2
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny311.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6311~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6311~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp311~
  OUTER_SET ++nubard_spell_ind
END

// Free Action:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr403.spl~ BEGIN
  COPY_EXISTING ~sppr403.spl~ ~override/d5bp403.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 3
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny403.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6403~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6403~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp403~
  OUTER_SET ++nubard_spell_ind
END

// Chaotic Commands:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr508.spl~ BEGIN
  COPY_EXISTING ~sppr508.spl~ ~override/d5bp508.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 4
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny508.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6508~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6508~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp508~
  OUTER_SET ++nubard_spell_ind
END

// Physical Mirror:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr613.spl~ BEGIN
  COPY_EXISTING ~sppr613.spl~ ~override/d5bp613.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 5
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny613.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6613~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6613~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp613~
  OUTER_SET ++nubard_spell_ind
END

// Entropy Shield:
ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ENTROPY_SHIELD[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
//COPY_EXISTING - ~spell.ids~ ~might_and_guile/backup~
// COUNT_REGEXP_INSTANCES ~[ %TAB%]CLERIC_ENTROPY_SHIELD$~ entropy_shield_exists
//ACTION_IF (entropy_shield_exists) BEGIN
  LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_ENTROPY_SHIELD~ RET spell_res END
  COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp615.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
	WRITE_BYTE 0x27 1
	LPF DELETE_EFFECT INT_VAR match_opcode = 83 match_parameter2 = 55 END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 opcode = 101 parameter2 = 58 END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 STR_VAR resource = ~spwi513~ END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 STR_VAR resource = ~spwi910~ END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 opcode = 328 parameter1 = 0 parameter2 = 66 special = 1 STR_VAR resource = ~EFF_E04~ END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 opcode = 328 parameter1 = 0 parameter2 = 66 special = 1 STR_VAR resource = ~EFF_M02~ END
END
ACTION_IF !(FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ENTROPY_SHIELD[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
//ACTION_IF !(entropy_shield_exists) BEGIN
  COPY ~might_and_guile/nubards/d5bp615.spl~ ~override~
	SAY NAME1 @21909
	SAY UNIDENTIFIED_DESC @21910
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
	WRITE_BYTE 0x27 1
	LPF DELETE_EFFECT INT_VAR match_opcode = 83 match_parameter2 = 55 END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 opcode = 101 parameter2 = 58 END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 STR_VAR resource = ~spwi513~ END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 STR_VAR resource = ~spwi910~ END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 opcode = 328 parameter1 = 0 parameter2 = 66 special = 1 STR_VAR resource = ~EFF_E04~ END
	LPF CLONE_EFFECT INT_VAR multi_match = 1 match_opcode = 318 opcode = 328 parameter1 = 0 parameter2 = 66 special = 1 STR_VAR resource = ~EFF_M02~ END
  COPY ~might_and_guile/nubards/sppr615b.bam~ ~override~
  COPY ~might_and_guile/nubards/#entropy.vvc~ ~override~
  COPY ~might_and_guile/nubards/eshielc.bam~ ~override~
  COPY ~might_and_guile/nubards/aft_p03.wav~ ~override~
  COPY ~might_and_guile/nubards/abjurh.vvc~ ~override~
  COPY ~might_and_guile/nubards/abjurh.bam~ ~override~
END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny615.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6615~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6615~ END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp615~
OUTER_SET ++nubard_spell_ind

// make a spell with 171 effects for these jester spells
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zjstr.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny310~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny311~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny403~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny508~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny613~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny615~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END

APPEND ~d5_jstr.2da~ ~BASE_SPLS   AP_D5ZJSTR  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

// SKALD:

// Remove Fear:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr108.spl~ BEGIN
  COPY_EXISTING ~sppr108.spl~ ~override/d5bp108.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny108.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6108~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6108~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp108~
  OUTER_SET ++nubard_spell_ind
END

// Flame Blade:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr206.spl~ BEGIN
  COPY_EXISTING ~sppr206.spl~ ~override/d5bp206.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny206.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6206~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6206~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp206~
  OUTER_SET ++nubard_spell_ind
END

// DUHM:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr214.spl~ BEGIN
  COPY_EXISTING ~sppr214.spl~ ~override/d5bp214.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 3
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny214.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6214~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6214~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp214~
  OUTER_SET ++nubard_spell_ind
END

// Def. Harmony:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr406.spl~ BEGIN
  COPY_EXISTING ~sppr406.spl~ ~override/d5bp406.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny406.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6406~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6406~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp406~
  OUTER_SET ++nubard_spell_ind
END

// Righteous Magic:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr513.spl~ BEGIN
  COPY_EXISTING ~sppr513.spl~ ~override/d5bp513.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny513.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6513~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6513~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp513~
  OUTER_SET ++nubard_spell_ind
END

// Magic Resistance:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr509.spl~ BEGIN
  COPY_EXISTING ~sppr509.spl~ ~override/d5bp509.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny509.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6509~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6509~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp509~
  OUTER_SET ++nubard_spell_ind
END

// Blade Barrier:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr603.spl~ BEGIN
  COPY_EXISTING ~sppr603.spl~ ~override/d5bp603.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 7
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny603.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6603~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6603~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp603~
  OUTER_SET ++nubard_spell_ind
END

// make a spell with 171 effects for these skald spells
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zskld.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny108~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny206~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny214~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny406~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny513~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny509~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny603~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END

APPEND ~d5_skld.2da~ ~BASE_SPLS   AP_D5ZSKLD  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

// GALLANT:

// Armor of Faith:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr111.spl~ BEGIN
  COPY_EXISTING ~sppr111.spl~ ~override/d5bp111.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny111.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6111~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6111~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp111~
  OUTER_SET ++nubard_spell_ind
END

// Aid:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr201.spl~ BEGIN
  COPY_EXISTING ~sppr201.spl~ ~override/d5bp201.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny201.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6201~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6201~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp201~
  OUTER_SET ++nubard_spell_ind
END

// Cure Disease:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr317.spl~ BEGIN
  COPY_EXISTING ~sppr317.spl~ ~override/d5bp317.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny317.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6317~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6317~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp317~
  OUTER_SET ++nubard_spell_ind
END

// Pro Evil 10':
ACTION_IF FILE_EXISTS_IN_GAME ~sppr408.spl~ BEGIN
  COPY_EXISTING ~sppr408.spl~ ~override/d5bp408.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 4
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny408.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6408~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6408~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp408~
  OUTER_SET ++nubard_spell_ind
END

// NPP - level 5:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr413.spl~ BEGIN
  COPY_EXISTING ~sppr413.spl~ ~override/d5bp413.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 5
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny413.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6413~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6413~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp413~
  OUTER_SET ++nubard_spell_ind
END

// Mass Cure - level 6:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr514.spl~ BEGIN
  COPY_EXISTING ~sppr514.spl~ ~override/d5bp514.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny514.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6514~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6514~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp514~
  OUTER_SET ++nubard_spell_ind
END

// make a spell with 171 effects for these gallant spells, plus ProEvil
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zglnt.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny111~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny201~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny317~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny408~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny413~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny514~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END

APPEND ~d5_glnt.2da~ ~BASE_SPLS   AP_D5ZGLNT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

/*
// HERALD:

// Find Traps:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr205.spl~ BEGIN
  COPY_EXISTING ~sppr205.spl~ ~override/d5bp205.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny205.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6205~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6205~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp205~
  OUTER_SET ++nubard_spell_ind
END

// Glyph of Warding:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr304.spl~ BEGIN
  COPY_EXISTING ~sppr304.spl~ ~override/d5bp304.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny304.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6304~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6304~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp304~
  OUTER_SET ++nubard_spell_ind
END

// Farsight:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr415.spl~ BEGIN
  COPY_EXISTING ~sppr415.spl~ ~override/d5bp415.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny415.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6415~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6415~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp415~
  OUTER_SET ++nubard_spell_ind
END

// Champion's Strength:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr507.spl~ BEGIN
  COPY_EXISTING ~sppr507.spl~ ~override/d5bp507.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny507.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6507~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6507~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp507~
  OUTER_SET ++nubard_spell_ind
END

// Aerial Servant:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr601.spl~ BEGIN
  COPY_EXISTING ~sppr601.spl~ ~override/d5bp601.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny601.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6601~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6601~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp601~
  OUTER_SET ++nubard_spell_ind
END

// make a spell with 171 effects for these herald spells
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zhrld.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP205~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP304~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP415~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP507~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP601~ END

APPEND ~d5_hrld.2da~ ~BASE_SPLS   AP_D5ZHRLD  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
*/

// MEISTERSINGER:

// Entangle:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr105.spl~ BEGIN
  COPY_EXISTING ~sppr105.spl~ ~override/d5bp105.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny105.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6105~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6105~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp105~
  OUTER_SET ++nubard_spell_ind
END

// Goodberry:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr207.spl~ BEGIN
  COPY_EXISTING ~sppr207.spl~ ~override/d5bp207.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny207.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6207~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6207~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp207~
  OUTER_SET ++nubard_spell_ind
END

// Barkskin:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr202.spl~ BEGIN
  COPY_EXISTING ~sppr202.spl~ ~override/d5bp202.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny202.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6202~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6202~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp202~
  OUTER_SET ++nubard_spell_ind
END

// ZoSA:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr318.spl~ BEGIN
  COPY_EXISTING ~sppr318.spl~ ~override/d5bp318.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 2
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny318.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6318~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6318~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp318~
  OUTER_SET ++nubard_spell_ind
END

// IWD Thorn Spray
ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_THORN_SPRAY[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
//COPY_EXISTING - ~spell.ids~ ~might_and_guile/backup~
// COUNT_REGEXP_INSTANCES ~[ %TAB%]CLERIC_ENTROPY_SHIELD$~ thorn_spray_exists
//ACTION_IF (thorn_spray_exists) BEGIN
  LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_THORN_SPRAY~ RET spell_res END
  COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp427.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 3
	WRITE_ASCII 0x3a ~sppr427b~ #8
	LPF ALTER_SPELL_HEADER STR_VAR icon = ~sppr427b~ END
  COPY_EXISTING ~%spell_res%.spl~ ~override~
	LPF ALTER_EFFECT INT_VAR match_opcode = 12 dicenumber = 4 /*dicesize = 8*/ END
END
ACTION_IF !(FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_THORN_SPRAY[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
//ACTION_IF !(thorn_spray_exists) BEGIN
  ADD_PROJECTILE ~might_and_guile/nubards/IDPRO303.pro~
  COPY ~might_and_guile/nubards/d5bp427.spl~ ~override~
	SAY NAME1 @21911
	SAY UNIDENTIFIED_DESC @21912
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 3
	WRITE_ASCII 0x3a ~sppr427b~ #8
	LPF ALTER_SPELL_HEADER STR_VAR icon = ~sppr427b~ END
	LPF ALTER_SPELL_HEADER INT_VAR projectile = %IDPRO303% END
	LPF ALTER_EFFECT INT_VAR match_opcode = 12 dicenumber = 4 decesize = 8 END
  COPY ~might_and_guile/nubards/sppr427b.bam~ ~override~
  COPY ~might_and_guile/nubards/sppr427c.bam~ ~override~
  COPY ~might_and_guile/nubards/tsprayt.bam~ ~override~
  COPY ~might_and_guile/nubards/#tra_61.wav~ ~override~
END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny427.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6427~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6~ END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp427~
OUTER_SET ++nubard_spell_ind

// IWD Spike Growth
ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_SPIKE_GROWTH[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
//COPY_EXISTING - ~spell.ids~ ~might_and_guile/backup~
// COUNT_REGEXP_INSTANCES ~[ %TAB%]CLERIC_ENTROPY_SHIELD$~ spike_growth_exists
//ACTION_IF (spike_growth_exists) BEGIN
  LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_SPIKE_GROWTH~ RET spell_res END
  COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp324.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 4
END
ACTION_IF !(FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_SPIKE_GROWTH[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
//ACTION_IF !(spike_growth_exists) BEGIN
//  COPY ~might_and_guile/nubards/IDPRO300.pro~ ~override~
  ADD_PROJECTILE ~might_and_guile/nubards/IDPRO300.pro~
  COPY ~might_and_guile/nubards/d5bp324.spl~ ~override~
	SAY NAME1 @21913
	SAY UNIDENTIFIED_DESC @21914
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 4
	LPF ALTER_SPELL_HEADER INT_VAR projectile = %IDPRO300% END
  COPY ~might_and_guile/nubards/sppr324b.bam~ ~override~
  COPY ~might_and_guile/nubards/sppr324c.bam~ ~override~
  COPY ~might_and_guile/nubards/sgrowta.bam~ ~override~
  COPY ~might_and_guile/nubards/sgrowtx.bam~ ~override~
END
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny324.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6324~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6324~ END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp324~
OUTER_SET ++nubard_spell_ind

// Woodland Beings:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr410.spl~ BEGIN
  COPY_EXISTING ~sppr410.spl~ ~override/d5bp410.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 5
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny410.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6410~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6410~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp410~
  OUTER_SET ++nubard_spell_ind
END

// Nature's Beauty:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr704.spl~ BEGIN
  COPY_EXISTING ~sppr704.spl~ ~override/d5bp704.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny704.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6704~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6704~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp704~
  OUTER_SET ++nubard_spell_ind
END

ACTION_IF (FILE_EXISTS_IN_GAME ~dvsrv4here.mrk~) BEGIN
// SR AS 1
  ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ANIMAL_SUMMONING_LEVEL_1[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
    LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_ANIMAL_SUMMONING_LEVEL_1~ RET spell_res END
    COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp149.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny151.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n149~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6149~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp149~
	OUTER_SET ++nubard_spell_ind
  END

// SR AS 2
  ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ANIMAL_SUMMONING_LEVEL_2[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
    LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_ANIMAL_SUMMONING_LEVEL_2~ RET spell_res END
    COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp249.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny249.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n649~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6249~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp249~
	OUTER_SET ++nubard_spell_ind
  END

// SR AS 3
  ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ANIMAL_SUMMONING_LEVEL_3[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
    LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_ANIMAL_SUMMONING_LEVEL_3~ RET spell_res END
    COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp349.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny349.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6349~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6349~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp349~
	OUTER_SET ++nubard_spell_ind
  END

// SR AS 4
  ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ANIMAL_SUMMONING_LEVEL_4[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
    LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_ANIMAL_SUMMONING_LEVEL_4~ RET spell_res END
    COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp449.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny449.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6449~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6449~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp449~
	OUTER_SET ++nubard_spell_ind
  END

// SR AS 5
  ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ANIMAL_SUMMONING_LEVEL_5[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
    LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_ANIMAL_SUMMONING_LEVEL_5~ RET spell_res END
    COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp549.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny549.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6549~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6549~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp549~
	OUTER_SET ++nubard_spell_ind
  END

// SR AS 6
  ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ANIMAL_SUMMONING_LEVEL_6[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
    LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_ANIMAL_SUMMONING_LEVEL_6~ RET spell_res END
    COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp649.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny649.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6649~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6649~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp649~
	OUTER_SET ++nubard_spell_ind
  END

// SR AS 7
  ACTION_IF (FILE_CONTAINS_EVALUATED (~SPELL.IDS~ ~[ %TAB%]CLERIC_ANIMAL_SUMMONING_LEVEL_7[ %TAB%%LNL%%MNL%%WNL%]~)) BEGIN
    LAF RES_NUM_OF_SPELL_NAME STR_VAR spell_name = ~CLERIC_ANIMAL_SUMMONING_LEVEL_7~ RET spell_res END
    COPY_EXISTING ~%spell_res%.spl~ ~override/d5bp749.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny749.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6749~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6749~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp749~
	OUTER_SET ++nubard_spell_ind
  END
END

ACTION_IF !(FILE_EXISTS_IN_GAME ~dvsrv4here.mrk~) BEGIN
// AS I:
  ACTION_IF FILE_EXISTS_IN_GAME ~sppr402.spl~ BEGIN
	COPY_EXISTING ~sppr402.spl~ ~override/d5bp402.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny402.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6402~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6402~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp402~
	OUTER_SET ++nubard_spell_ind
  END

// ASII:
  ACTION_IF FILE_EXISTS_IN_GAME ~sppr501.spl~ BEGIN
	COPY_EXISTING ~sppr501.spl~ ~override/d5bp501.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny501.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6501~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6501~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp501~
	OUTER_SET ++nubard_spell_ind
  END

// AS III:
  ACTION_IF FILE_EXISTS_IN_GAME ~sppr602.spl~ BEGIN
	COPY_EXISTING ~sppr602.spl~ ~override/d5bp602.spl~
	  WRITE_SHORT 0x1c 1
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny602.spl~
 	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6602~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6602~ END
	OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp602~
	OUTER_SET ++nubard_spell_ind
  END
END

// make a spell with 171 effects for these meistersinger spells
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zmstr.spl~
// probably need to apply these at certain levels
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny105~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny207~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny202~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny318~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny427~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny324~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny410~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny704~ END
  PATCH_IF (FILE_EXISTS_IN_GAME ~dvsrv4here.mrk~) BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny149~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny249~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny349~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny449~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny549~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny649~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny749~ END
  END
  PATCH_IF !(FILE_EXISTS_IN_GAME ~dvsrv4here.mrk~) BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny402~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny501~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny602~ END
  END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END

APPEND ~d5_mstr.2da~ ~BASE_SPLS   AP_D5ZMSTR  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

// JINXER:

// Doom:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr113.spl~ BEGIN
  COPY_EXISTING ~sppr113.spl~ ~override/d5bp113.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny113.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6113~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6113~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp113~
  OUTER_SET ++nubard_spell_ind
END

// IWD Curse:
COPY ~might_and_guile/nubards/d5curse.spl~ ~override/d5bp112.spl~
	SAY NAME1 @21903
	SAY UNIDENTIFIED_DESC @21904
	WRITE_LONG 0x34 2
	WRITE_ASCII 0x3a ~SPPR112C~ #8
	LPF ALTER_SPELL_HEADER STR_VAR icon = ~SPPR112B~ END
COPY ~might_and_guile/nubards/sppr112c.bam~ ~override~
COPY ~might_and_guile/nubards/sppr112b.bam~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny112.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6112~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6112~ END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp112~
OUTER_SET ++nubard_spell_ind

// Spiritual Clarity/Break Enchantment:
ACTION_IF !(FILE_EXISTS_IN_GAME ~dvsrv4here.mrk~) AND (FILE_EXISTS_IN_GAME ~sppr350.spl~) BEGIN
  COPY_EXISTING ~sppr350.spl~ ~override/d5bp350.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 3
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp350~
  OUTER_SET ++nubard_spell_ind
END
ACTION_IF (FILE_EXISTS_IN_GAME ~dvsrv4here.mrk~) AND (FILE_EXISTS_IN_GAME ~spwi410.spl~) BEGIN
  COPY_EXISTING ~spwi410.spl~ ~override/d5bp350.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 4
	LPF ALTER_SPELL_HEADER INT_VAR speed = 3 END  
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny350.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6350~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6350~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp350~
  OUTER_SET ++nubard_spell_ind
END

// Greater Malison:
ACTION_IF FILE_EXISTS_IN_GAME ~spwi412.spl~ BEGIN
  COPY_EXISTING ~spwi412.spl~ ~override/d5bi412.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 4
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5iy412.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5i6412~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5i6412~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bi412~
  OUTER_SET ++nubard_spell_ind
END

// Pixie Dust:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr516.spl~ BEGIN
  COPY_EXISTING ~sppr516.spl~ ~override/d5bp516.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 5
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny516.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6516~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6516~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp516~
  OUTER_SET ++nubard_spell_ind
END

// Insect Plague - level 6:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr517.spl~ BEGIN
  COPY_EXISTING ~sppr517.spl~ ~override/d5bp517.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny5517.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6517~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6517~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp517~
  OUTER_SET ++nubard_spell_ind
END

// make a spell with 171 effects for these jinxer spells + miscast magic + malison
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zjinx.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny113~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny112~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny350~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5iy412~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny516~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny517~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END

APPEND ~d5_jinx.2da~ ~BASE_SPLS   AP_D5ZJINX  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
APPEND ~d5_hxbl.2da~ ~BASE_SPLS   AP_D5ZJINX  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

// ELEGIST:

// Spirit Ward:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr150.spl~ BEGIN
  COPY_EXISTING ~sppr150.spl~ ~override/d5bp150.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny150.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6150~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6150~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp150~
  OUTER_SET ++nubard_spell_ind
END

// Chant:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr203.spl~ BEGIN
  COPY_EXISTING ~sppr203.spl~ ~override/d5bp203.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny203.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6203~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6203~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp203~
  OUTER_SET ++nubard_spell_ind
END

// Spirit Fire:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr450.spl~ BEGIN
  COPY_EXISTING ~sppr450.spl~ ~override/d5bp450.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 3
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny450.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6450~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6450~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp450~
  OUTER_SET ++nubard_spell_ind
END

// Death Ward:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr409.spl~ BEGIN
  COPY_EXISTING ~sppr409.spl~ ~override/d5bp409.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny409.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6409~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6409~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp409~
  OUTER_SET ++nubard_spell_ind
END

// Slay Living:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr511.spl~ BEGIN
  COPY_EXISTING ~sppr511.spl~ ~override/d5bp511.spl~
	WRITE_SHORT 0x1c 1
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny511.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6511~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6511~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp511~
  OUTER_SET ++nubard_spell_ind
END

// Recall Spirit - level 6:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr550.spl~ BEGIN
  COPY_EXISTING ~sppr550.spl~ ~override/d5bp550.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5ny550.spl~
 	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5n6550~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5n6550~ END
  OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp550~
  OUTER_SET ++nubard_spell_ind
END

// make a spell with 171 effects for these elegist spells
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zeleg.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny150~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny203~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny450~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny409~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny511~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5ny550~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END

APPEND ~d5_eleg.2da~ ~BASE_SPLS   AP_D5ZELEG  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

/*
// LORESINGER:

// Color Spray:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr150.spl~ BEGIN
  COPY_EXISTING ~sppr111.spl~ ~override/d5bp150.spl~
	WRITE_SHORT 0x1c 1
END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp150~
OUTER_SET ++nubard_spell_ind

// Vocalize:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr203.spl~ BEGIN
  COPY_EXISTING ~sppr201.spl~ ~override/d5bp203.spl~
	WRITE_SHORT 0x1c 1
END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp203~
OUTER_SET ++nubard_spell_ind

// Spirit Fire:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr450.spl~ BEGIN
  COPY_EXISTING ~sppr317.spl~ ~override/d5bp450.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 3
END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp450~
OUTER_SET ++nubard_spell_ind

// Death Ward:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr409.spl~ BEGIN
  COPY_EXISTING ~sppr408.spl~ ~override/d5bp409.spl~
	WRITE_SHORT 0x1c 1
END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp409~
OUTER_SET ++nubard_spell_ind

// Slay Living:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr511.spl~ BEGIN
  COPY_EXISTING ~sppr413.spl~ ~override/d5bp511.spl~
	WRITE_SHORT 0x1c 1
END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp511~
OUTER_SET ++nubard_spell_ind

// Recall Spirit - level 6:
ACTION_IF FILE_EXISTS_IN_GAME ~sppr550.spl~ BEGIN
  COPY_EXISTING ~sppr514.spl~ ~override/d5bp550.spl~
	WRITE_SHORT 0x1c 1
	WRITE_LONG 0x34 6
END
OUTER_SPRINT $nu_bard_spells(~%nubard_spell_ind%~) ~d5bp550~
OUTER_SET ++nubard_spell_ind

// make a spell with 171 effects for these loresinger spells
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zglnt.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP150~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP203~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP450~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP409~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP511~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP550~ END

APPEND ~d5_lors.2da~ ~BASE_SPLS   AP_D5ZLORS  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
*/

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zblde.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END
APPEND ~d5_blade.2da~ ~BASE_SPLS   AP_D5ZBLDE  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zagnt.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END
APPEND ~d5_agnt.2da~ ~BASE_SPLS   AP_D5ZAGNT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5zblds.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP102~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPBI219~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP211~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI431~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP321~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP512~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BI806~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~SPWI612~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~D5BP720~ END
APPEND ~d5_blads.2da~ ~BASE_SPLS   AP_D5ZBLDS  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

/* ...give this vv to bards in place of Vocalize
// Declamation (targetable Vocalize):
COPY ~might_and_guile/nubards/d5bdvoc.spl~ ~override~
	SAY NAME1 @21901
	SAY UNIDENTIFIED_DESC @21902
*/

//___________________________________________________________________________________


// 5E-STYLE SPONTANEOUS CASTING_______________________________________________________
//
// after resting, if spellstate NOT detected:
// ...refresh slots as normal
// ...make blots.spl cast 
// but if spellstate IS detected:
// ...summon invisicre
// ...check HaveSpell (for... all wizard spells?)
// ...if HaveSpell then cancel 206
// then:
// ...apply all 171 EFFs (is this what d5bsplz does??)
// ...and reduce spell slots to 0
// ...and re-enable casting button
// ...refresh slots (cast d5bsplz)
// ...cancel spellstate

// SO: need to:
// 1) make the spellstate
// 2) add 326 checks to morning ability (maybe just use baldur.bcs instead of a spell?)
// 3) make the prepare spells ability
// 4) make the invisicre
// 5) make the script
// 6) 

// blotz = permanent effect w/177
// blots.eff = 232 to cast blots.spl
// blots.spl checks fatigue = 0, casts brfrsh

// make a 'prepare spells' ability - it will:
// ...cancel the spell slot reductions (321 d517slt.spl)
// ...remove spells
// ...cast all 206 spells
// ...cast subspell

// subspell = set prep spellstate & disable casting button

// add splprot entry for fatigue 0 1
// add splprot entry for 0x112 spellstate_ind 1
// add splprot entry for 0x112 spellstate_ind 5
// get splprot index for those three entries
// add splprot entry for (fatigue 0 entry + spellstate 1 entry)
// add splprot entry for (fatigue 0 entry + spellstate 5 entry)

// patch blots.spl to cast brfrsh if latter
// ...and to cast blotw.spl if former
// blotw summons invisicre
// invisicre script checks HaveSpell, applies learn_spl for each true
// ...then casts bwfrsh
// bwfrsh = brfrsh, plus:
// ...re-apply d517slt x12
// ...re-enable casting button
// ...321 cancel prep spellstate subspell

// need to make sure blot#x spells apply ALL spell-add EFFs

ACTION_IF !(FILE_EXISTS_IN_GAME ~d5_bard_cast.d5~) BEGIN

//prepared spells spellstate__________________________________________________________
//
ACTION_IF (FILE_CONTAINS_EVALUATED (~splstate.ids~ ~D5_SPL_PREP~)) BEGIN
  COPY_EXISTING ~splstate.ids~ ~override~
	COUNT_2DA_COLS cols
	READ_2DA_ENTRIES_NOW rows cols
	FOR (row = 1; row < rows; ++row) BEGIN
	  READ_2DA_ENTRY_FORMER rows row 1 ~state_name~
	  READ_2DA_ENTRY_FORMER rows row 0 ~state_ind~
	  PATCH_IF (~%state_name%~ STRING_EQUAL_CASE ~D5_SPL_PREP~) BEGIN
		SET prepared_spells_state = %state_ind%
	  END
	END
  BUT_ONLY
END
/*
ACTION_IF !(FILE FILE_CONTAINS_EVALUATED (~splstate.ids~ ~D5_SPL_PREP~)) BEGIN
  LAF d5_resolve_state STR_VAR new_state_id = ~D5_SPL_PREP~ RET new_state_ind END
  OUTER_SET prepared_spells_state = %new_state_ind%
END
*/
ACTION_IF !(VARIABLE_IS_SET %prepared_spells_state%) BEGIN
  LAF d5_resolve_state STR_VAR new_state_id = ~D5_SPL_PREP~ RET new_state_ind END
  OUTER_SET prepared_spells_state = %new_state_ind%
END


//add spell slot stat checks to SPLPROT______________________________________________
//
APPEND ~splprot.2da~ ~D5_SLOTS_1_7%TAB%108%TAB%-1%TAB%7~ UNLESS ~D5_SLOTS_1_7~
APPEND ~splprot.2da~ ~D5_SLOTS_8_9%TAB%109%TAB%-1%TAB%7~ UNLESS ~D5_SLOTS_8_9~
APPEND ~splprot.2da~ ~D5_FATIGUE_0%TAB%30%TAB%0%TAB%1~ UNLESS ~D5_FATIGUE_0~
APPEND ~splprot.2da~ ~D5_PREP_SPLZ%TAB%0x112%TAB%%prepared_spells_state%%TAB%1~ UNLESS ~D5_PREP_SPLZ~
APPEND ~splprot.2da~ ~D5_NOT_PREP%TAB%0x112%TAB%%prepared_spells_state%%TAB%5~ UNLESS ~D5_NOT_PREP~

COPY_EXISTING ~splprot.2da~ ~override~
  COUNT_2DA_COLS cols
  READ_2DA_ENTRIES_NOW rows cols
  FOR (row = 1; row < rows; ++row) BEGIN
	READ_2DA_ENTRY_FORMER rows row 0 ~stat~
	PATCH_IF ~%stat%~ STRING_EQUAL_CASE ~D5_SLOTS_1_7~ BEGIN
	  SET fake_sorc_slots_1_7 = %row%
	END
	PATCH_IF ~%stat%~ STRING_EQUAL_CASE ~D5_SLOTS_8_9~ BEGIN
	  SET fake_sorc_slots_8_9 = %row%
	END
	PATCH_IF ~%stat%~ STRING_EQUAL_CASE ~D5_FATIGUE_0~ BEGIN
	  SET fatigue_zero = %row%
	END
	PATCH_IF ~%stat%~ STRING_EQUAL_CASE ~D5_PREP_SPLZ~ BEGIN
	  SET prep_spells_row = %row%
	END
	PATCH_IF ~%stat%~ STRING_EQUAL_CASE ~D5_NOT_PREP~ BEGIN
	  SET not_prep_row = %row%
	END
  END
BUT_ONLY


//COPY ~might_and_guile/nubards/d5nubrd.cre~ ~override~


//remove all mage spell slots_________________________________________________________
//
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d517slt.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 42 target = 1 parameter1 = (0 - 1) parameter2 = 127 timing = 9 END

COPY_EXISTING ~d517slt.spl~ ~override/d501slt.spl~

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d589slt.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 42 target = 1 parameter1 = (0 - 1) parameter2 = 384 timing = 9 END
BUT_ONLY


//create advance copies of some spells________________________________________________
//
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5b206.spl~

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot1a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot1b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot1c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot1d.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot2a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot2b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot2c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot2d.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot3a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot3b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot3c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot3d.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot4a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot4b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot4c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot4d.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot5a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot5b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot5c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot5d.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot6a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot6b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot6c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot6d.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot7a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot7b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot7c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot7d.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot8a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot8b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot8c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot8d.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot9a.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot9b.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot9c.spl~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blot9d.spl~

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bsplz.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 4) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot1a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 4) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot1b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 4) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot1c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 4) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot1d~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 8) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot2a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 8) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot2b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 8) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot2c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 8) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot2d~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 12) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot3a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 12) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot3b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 12) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot3c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 12) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot3d~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 16) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot4a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 16) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot4b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 16) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot4c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 16) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot4d~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 20) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot5a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 20) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot5b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 20) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot5c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 20) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot5d~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 24) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot6a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 24) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot6b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 24) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot6c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 24) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot6d~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 28) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot7a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 28) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot7b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 28) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot7c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 28) parameter2 = %fake_sorc_slots_1_7% timing = 1 STR_VAR resource = ~d5blot7d~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 24) parameter2 = %fake_sorc_slots_8_9% timing = 1 STR_VAR resource = ~d5blot8a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 24) parameter2 = %fake_sorc_slots_8_9% timing = 1 STR_VAR resource = ~d5blot8b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 24) parameter2 = %fake_sorc_slots_8_9% timing = 1 STR_VAR resource = ~d5blot8c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 24) parameter2 = %fake_sorc_slots_8_9% timing = 1 STR_VAR resource = ~d5blot8d~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (1 << 28) parameter2 = %fake_sorc_slots_8_9% timing = 1 STR_VAR resource = ~d5blot9a~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (2 << 28) parameter2 = %fake_sorc_slots_8_9% timing = 1 STR_VAR resource = ~d5blot9b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (4 << 28) parameter2 = %fake_sorc_slots_8_9% timing = 1 STR_VAR resource = ~d5blot9c~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = (8 << 28) parameter2 = %fake_sorc_slots_8_9% timing = 1 STR_VAR resource = ~d5blot9d~ END


//assign stats for spell slots to each spell level____________________________________
//
// level 1 = (134 << 8)			// OR:	108 << 4
// level 2 = (134 << 12)		//		108 << 8
// level 3 = (134 << 16)		//		108 << 12
// level 4 = (134 << 20)		//		108 << 16
// level 5 = (108 << 8) 		//		108 << 20
// level 6 = (108 << 12)		//		108 << 24
// level 7 = (108 << 16)		//		108 << 28
// level 8 = (108 << 20)		//	    109 << 24
// level 9 = (108 << 24)		//	    109 << 28
//
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src1a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src1%let%.spl~
	  SAY NAME1 @21991
	  SAY UNIDENTIFIED_DESC @21991
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 4) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src1%let%~ END
  END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src2a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src2%let%.spl~
	  SAY NAME1 @21992
	  SAY UNIDENTIFIED_DESC @21992
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 8) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src2%let%~ END
  END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src3a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src3%let%.spl~
	  SAY NAME1 @21993
	  SAY UNIDENTIFIED_DESC @21993
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 12) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src3%let%~ END
  END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src4a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src4%let%.spl~
	  SAY NAME1 @21994
	  SAY UNIDENTIFIED_DESC @21994
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 16) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src4%let%~ END
  END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src5a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src5%let%.spl~
	  SAY NAME1 @21995
	  SAY UNIDENTIFIED_DESC @21995
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 20) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src5%let%~ END
  END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src6a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src6%let%.spl~
	  SAY NAME1 @21996
	  SAY UNIDENTIFIED_DESC @21996
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 24) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src6%let%~ END
  END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src7a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src7%let%.spl~
	  SAY NAME1 @21997
	  SAY UNIDENTIFIED_DESC @21997
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 28) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src7%let%~ END
  END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src8a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src8%let%.spl~
	  SAY NAME1 @21989
	  SAY UNIDENTIFIED_DESC @21989
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 24) parameter2 = (109 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src8%let%~ END
  END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src9a.spl~ BEGIN
  ACTION_FOR_EACH let IN ~a~ ~b~ ~c~ ~d~ ~e~ ~f~ ~g~ ~h~ ~i~ ~j~ ~k~ ~l~ ~m~ ~n~ ~o~ ~p~ ~q~ ~r~ ~s~ ~t~ BEGIN
	COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src9%let%.spl~
	  SAY NAME1 @21990
	  SAY UNIDENTIFIED_DESC @21990
	  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 28) parameter2 = (109 + (0x10000 * 1)) timing = 9 END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~d5src9%let%~ END
  END
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-1.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-1.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 4) parameter2 = (108 + (0x10000 * 1)) timing = 1 END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-2.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-2.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 8) parameter2 = (108 + (0x10000 * 1)) timing = 1 END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-3.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-3.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 1 END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-4.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-4.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 1 END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-5.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-5.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 1 END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-6.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-6.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 24) parameter2 = (108 + (0x10000 * 1)) timing = 1 END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-7.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-7.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 28) parameter2 = (108 + (0x10000 * 1)) timing = 1 END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-8.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-8.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 24) parameter2 = (109 + (0x10000 * 1)) timing = 1 END
END
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5src-9.spl~ BEGIN
 COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5src-9.spl~
   LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 28) parameter2 = (109 + (0x10000 * 1)) timing = 1 END
END


// generate master 2da list of learnable spells_______________________________________
//
OUTER_SET scroll_spell_ind = 0
OUTER_SPRINT $scroll_spells(~%scroll_spell_ind%~) ~spell~
COPY_EXISTING_REGEXP GLOB ~^.+\.itm$~ ~override~
  READ_BYTE     0x2f current ELSE 0
  READ_BYTE     0x2b current2 ELSE 0
  READ_LONG 0x64 headoffset  ELSE 0
  READ_SHORT 0x68 headcount  ELSE 0
  READ_LONG 0x6a effectsoffset  ELSE 0
  haslearn = 0
  hascast = 0
//  PATCH_IF (headcount = 2) BEGIN
    FOR (headcyc = 0; headcyc < headcount ; headcyc = headcyc + 1) BEGIN
      thishead = 0
      READ_SHORT (headoffset + (headcyc * 0x38) + 0x1e) effcount  ELSE 0
      READ_SHORT (headoffset + (headcyc * 0x38) + 0x20) effectsindex  ELSE 0
      FOR (effcyc = 0; effcyc < effcount; effcyc = effcyc + 1) BEGIN
        READ_SHORT (effectsoffset + (effectsindex + effcyc)* 0x30) opcode ELSE 0
        PATCH_IF (opcode = 0x93) AND (thishead = 0) BEGIN
          READ_ASCII (effectsoffset + 0x14 + (effectsindex + effcyc)* 0x30) resref_learn  ELSE 0
          INNER_PATCH_FILE ~%resref_learn%.spl~ BEGIN
            READ_SHORT 0x1c type
          END
          PATCH_IF (type = 1) BEGIN // arcane spell scroll
            thishead = 1
            haslearn = 1
          END
        END 
        PATCH_IF ((opcode = 0x92) OR (opcode = 0x94)) AND (thishead = 0) BEGIN
          READ_ASCII (effectsoffset + 0x14 + (effectsindex + effcyc)* 0x30) resref_cast  ELSE 0
          INNER_PATCH_FILE ~%resref_cast%.spl~ BEGIN
            READ_SHORT 0x1c type
          END
          PATCH_IF (type = 1) BEGIN // arcane spell scroll
            thishead = 1
            hascast = 1
          END
        END 
      END 
    END 
//  END // end has 2 headers
  PATCH_IF (haslearn = 1) AND (hascast = 1) AND (~%resref_cast%~ STRING_EQUAL_CASE ~%resref_learn%~) BEGIN
	SPRINT $scroll_spells(~%scroll_spell_ind%~) ~%resref_learn%~
	SET ++scroll_spell_ind
  END
BUT_ONLY


// generate bclons.2da________________________________________________________________
//
<<<<<<<< d5/d5sclons.2da
2DA V1.0 
SPLRES
		206		LEARN	EFF		INNATE	DISPLAY
>>>>>>>> 

COPY ~d5/d5sclons.2da~ ~override/d5sclons.2da~ 

ACTION_PHP_EACH scroll_spells AS ind => arcane_spell BEGIN
  ACTION_IF (ind > 0) BEGIN
	ACTION_IF FILE_EXISTS_IN_GAME ~%arcane_spell%.spl~ BEGIN
	  COPY_EXISTING ~%arcane_spell%.spl~ ~override~
		PATCH_IF (~%arcane_spell%~ STRING_MATCHES_REGEXP ~[Ss][Pp][Ww][Ii][1-9][0-9][0-9]~ = 0) BEGIN
		  INNER_PATCH_SAVE 206_spell ~%arcane_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Ss][Pp][Ww][Ii]~ ~d5b6~
		  END
		  INNER_PATCH_SAVE learn_spell ~%arcane_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Ss][Pp][Ww][Ii]~ ~d5bx~
		  END
		  INNER_PATCH_SAVE spell_eff ~%arcane_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Ss][Pp][Ww][Ii]~ ~D5BV~
		  END
		  INNER_PATCH_SAVE innate_spell ~%arcane_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Ss][Pp][Ww][Ii]~ ~d5b4~
		  END
		  TEXT_SPRINT real_spell ~%arcane_spell%~
		  PATCH_IF NOT (FILE_CONTAINS_EVALUATED (~d5sclons.2da~ ~%arcane_spell%~)) BEGIN
			INNER_ACTION BEGIN
			  APPEND ~d5sclons.2da~ ~%arcane_spell%	%206_spell%	%learn_spell%	%spell_eff%	%innate_spell%	%real_spell% ~
			END
		  END
		END
	  BUT_ONLY
	END
  END
END


// 'prepare spells' spell_____________________________________________________________
//
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5prepb.spl~
  SAY NAME1 @21981 											// ~daily spell preparation~
  SAY UNIDENTIFIED_DESC @21981								// ~daily spell preparation~
  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~spcl919b~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 1 STR_VAR resource = ~d5b206~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter1 = 0 parameter2 = 1 timing = 1 STR_VAR resource = ~d5prepb1~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bsplz~ END

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5prepb1.spl~
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 144 target = 1 parameter2 = 2 timing = 9 END
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 101 target = 1 parameter2 = 145 timing = 9 END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 328 target = 1 special = 1 parameter2 = %prepared_spells_state% timing = 9 END


//daily spell slot refresh____________________________________________________________
//
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blotz.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = ~d5blots~ END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5blots.eff~ BEGIN
  CREATE EFF ~d5blots~
	WRITE_LONG 0x10 232
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 0
	WRITE_LONG 0x20 20
	WRITE_LONG 0x24 9
	WRITE_SHORT 0x2c 100
	WRITE_ASCII 0x30 ~d5blots~ #8
	WRITE_LONG 0x48 102
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5blots.spl~ BEGIN
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blots.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = 0 parameter2 = %fatigue_zero% timing = 1 STR_VAR resource = ~d5blotf~ END
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5blotf.spl~ BEGIN
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blotf.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = 0 parameter2 = %prep_spells_row% timing = 1 STR_VAR resource = ~d5blotr~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = 0 parameter2 = %not_prep_row% timing = 1 STR_VAR resource = ~d5brfrsh~ END
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5blotr.spl~ BEGIN
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5blotr.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = 0 parameter2 = 2 timing = 0 duration = 12 STR_VAR resource = ~d5blotr~ END
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5blotr.eff~ BEGIN
  CREATE EFF ~d5blotr~
	WRITE_LONG 0x10 67
	WRITE_LONG 0x14 1
	WRITE_LONG 0x28 12
	WRITE_SHORT 0x2c 100
	WRITE_ASCII 0x30 ~d5blotr~ #8
	WRITE_ASCII 0x70 ~shskull~ #8
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5blotr.cre~ BEGIN
  COPY ~might_and_guile/nubards/d5blotr.cre~ ~override~
END


// script to check memorized spells___________________________________________________
//
<<<<<<<<d5/inline_script.baf
>>>>>>>>

COPY ~d5/inline_script.baf~ ~weidu_external/d5_bard_cast/d5blotr.baf~

COPY_EXISTING ~d5sclons.2da~ ~override~
  COUNT_2DA_COLS cols
  READ_2DA_ENTRIES_NOW ~r2en_sclons~ cols
  FOR (row = 0; row < r2en_sclons; ++row) BEGIN
	READ_2DA_ENTRY_FORMER ~r2en_sclons~ row 0 original_spell
	READ_2DA_ENTRY_FORMER ~r2en_sclons~ row 2 learn_spell
	INNER_ACTION BEGIN
	  APPEND_OUTER ~weidu_external/d5_bard_cast/d5blotr.baf~ ~
IF
    TriggerOverride(LastSummonerOf(Myself),HaveSpellRES("%original_spell%"))
THEN
    RESPONSE #100
    ActionOverride(LastSummonerOf(Myself),ApplySpellRes("%learn_spell%",Myself))
    Continue()
END
~
	END
  END
BUT_ONLY

APPEND_OUTER ~weidu_external/d5_bard_cast/d5blotr.baf~ ~
IF
	True()
THEN
	RESPONSE #100
	ActionOverride(LastSummonerOf(Myself),ApplySpellRes("D5PREPD",Myself))
	DestroySelf() 
END
~

COMPILE ~weidu_external/d5_bard_cast/d5blotr.baf~


// spell to simply refresh spell slots________________________________________________
//
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5brfrsh.spl~ BEGIN
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5brfrsh.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 93 target = 1 parameter1 = 1 parameter2 = 1 timing = 1 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-1~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-2~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-3~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-4~ END
  	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-5~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-6~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-7~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-8~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-9~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bsplz~ END
END


// spell to set prepped spells and refresh slots______________________________________
//
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5prepd.spl~ BEGIN
  COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5prepd.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 93 target = 1 parameter1 = 1 parameter2 = 1 timing = 1 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5prepb1~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-1~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-2~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-3~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-4~ END
  	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-5~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-6~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-7~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-8~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5src-9~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 279 target = 1 parameter2 = 2 timing = 9 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bsplz~ END
END


//clone spells________________________________________________________________________
//
COPY_EXISTING ~d5sclons.2da~ ~override~
  COUNT_2DA_COLS cols
  READ_2DA_ENTRIES_NOW ~r2en_sclons~ cols
  FOR (row = 0; row < r2en_sclons; ++row) BEGIN
	READ_2DA_ENTRY_FORMER ~r2en_sclons~ row 0 real_spell
	READ_2DA_ENTRY_FORMER ~r2en_sclons~ row 1 206_spell
	READ_2DA_ENTRY_FORMER ~r2en_sclons~ row 2 learn_spell
	READ_2DA_ENTRY_FORMER ~r2en_sclons~ row 3 spell_eff
	READ_2DA_ENTRY_FORMER ~r2en_sclons~ row 4 innate_spell
	READ_2DA_ENTRY_FORMER ~r2en_sclons~ row 5 book_spell
	INNER_ACTION BEGIN
	  COPY_EXISTING ~%real_spell%.spl~ ~override~
		READ_LONG 0x34 spell_level
	  BUT_ONLY
// make innates that cast the original
//	  ACTION_IF NOT FILE_EXISTS_IN_GAME ~%innate_spell%.spl~ BEGIN
		COPY_EXISTING ~%real_spell%.spl~ ~override/%innate_spell%.spl~
		  WRITE_SHORT 0x1c 4
		  LPF ALTER_SPELL_HEADER INT_VAR location = 2 END
//		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = ~d5bwiz~ END
// 			don't need that ^ if casting original spell
		  READ_LONG 0x64 abil_offset
		  READ_SHORT 0x68 abil_number
		  READ_BYTE (%abil_offset% + 0x0c) abil_target					
		  READ_SHORT (%abil_offset% + 0x0e) abil_range
		  READ_LONG 0x6a eff_offset
		  WHILE (%abil_number% > 0) BEGIN
			SET abil_number = (%abil_number% - 1)
			WRITE_SHORT (%abil_offset% + 0x26 + (0x28 * %abil_number%)) 1
		  END
		  READ_BYTE (%eff_offset% + 0x02) eff_target
		  LPF DELETE_EFFECT INT_VAR match_probability2 = 0 END
		  PATCH_IF (%abil_target% = 4) BEGIN
			LPF ADD_SPELL_EFFECT INT_VAR opcode = 148 target = 1 power = %spell_level% parameter1 = 0 parameter2 = 1 timing = 1 STR_VAR resource = EVAL ~%real_spell%~ END
			PATCH_IF (%abil_range% < 35) BEGIN
			  PATCH_IF (%abil_range% > 4) BEGIN
				LPF ALTER_SPELL_HEADER INT_VAR range = (%abil_range% - 3) END
			  END
			  PATCH_IF (%abil_range% < 5) BEGIN
			 	LPF ALTER_SPELL_HEADER INT_VAR target = 5 END	// might need to carve out exceptions, e.g. burning hands
			  END
			END
		  END
		  ELSE BEGIN
			LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 2 power = %spell_level% parameter2 = 1 timing = 9 STR_VAR resource = EVAL ~%real_spell%~ END
		  END
// exempt lvl 1 if lv1 1 cantrips
		  PATCH_IF MOD_IS_INSTALLED ~tomeandblood.tp2~ ~62~ BEGIN
//		   PATCH_IF NOT (%spell_level%) = 1 BEGIN
		   PATCH_IF (%spell_level% > 1) BEGIN
			LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = EVAL ~d5src-%spell_level%~ END
		   END
		  END
		  PATCH_IF NOT MOD_IS_INSTALLED ~tomeandblood.tp2~ ~62~ BEGIN
			LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = EVAL ~d5src-%spell_level%~ END
		  END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bsplz~ END
//	  END
// make .EFFs adding the innate spell
//	  ACTION_IF NOT FILE_EXISTS_IN_GAME ~%spell_eff%.eff~ BEGIN
	  OUTER_SET string_length = (STRING_LENGTH ~%spell_eff%~)
	  ACTION_IF (%string_length% < 8) BEGIN
		CREATE EFF ~%spell_eff%~
		 WRITE_LONG 0x10 171
		 WRITE_LONG 0x14 1
		 WRITE_LONG 0x24 0
		 WRITE_LONG 0x28 1
		 WRITE_SHORT 0x2c 100
		 WRITE_EVALUATED_ASCII 0x30 ~%innate_spell%~ #8
		 WRITE_LONG 0x90 1
		 WRITE_EVALUATED_ASCII 0x94 ~%spell_eff%~ #8
	  END
//	  END
// make 206 spells preventing the .EFF
//	  ACTION_IF NOT FILE_EXISTS_IN_GAME ~%206_spell%.spl~ BEGIN
		COPY ~might_and_guile/lib/d5_base.spl~ ~override/%206_spell%.spl~
		 WRITE_SHORT 0x1c 4
	  	 LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
	  	 LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 321 target = 1 timing = 9 STR_VAR resource = EVAL ~%206_spell%~ END
//	  END
// add 206 spells to CLAB spell
	  COPY_EXISTING ~d5b206.spl~ ~override~
		LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = EVAL ~%206_spell%~ END
// make learn spells canceling the 206
//	  ACTION_IF NOT FILE_EXISTS_IN_GAME ~%learn_spell%.spl~ BEGIN
		COPY ~might_and_guile/lib/d5_base.spl~ ~override/%learn_spell%.spl~
	  	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = EVAL ~%206_spell%~ END
//		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~%206_spell%~ END
//	  END
// add 172 to d5bsplz
	  COPY_EXISTING ~d5bsplz.spl~ ~override~
		LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~%innate_spell%~ END
// add 172 to d5prepb - edit: maybe don't need to, because already in bsplz and prepb casts bsplz
//	  COPY_EXISTING ~d5prepb.spl~ ~override~
//		LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~%innate_spell%~ END
// generate slot#x spells
//	  ACTION_IF (spell_level < 8) BEGIN
	  ACTION_IF FILE_EXISTS_IN_GAME ~d5blot%spell_level%a.spl~ BEGIN
		COPY_EXISTING ~d5blot%spell_level%a.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		COPY_EXISTING ~d5blot%spell_level%b.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		COPY_EXISTING ~d5blot%spell_level%c.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		COPY_EXISTING ~d5blot%spell_level%d.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
	  END
	END
  END
BUT_ONLY


//disable quickspell buttons__________________________________________________________
//
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5brdnq.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 144 target = 1 parameter2 = 3 timing = 9 END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 144 target = 1 parameter2 = 4 timing = 9 END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 144 target = 1 parameter2 = 5 timing = 9 END


COPY ~might_and_guile/lib/d5_marker.d5~ ~override/d5_bard_cast.d5~

END

// ***** ^^ the above only needs to be done once ^^___________________________________


APPEND ~d5nubard.2da~ ~NOSLOTS     AP_D501SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
//NOSLOTS     AP_D501SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
/*
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D517SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
NOSLOTS     AP_D589SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
*/

APPEND ~d5nubard.2da~ ~NO_QUICK    AP_D5BRDNQ  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

// add spell slots____________________________________________________________________
//
APPEND ~d5nubard.2da~  
~SRCSLOTS    ****        AP_D5SRC1A  AP_D5SRC1B  AP_D5SRC2A  AP_D5SRC1C  AP_D5SRC3A  AP_D5SRC2B  AP_D5SRC4A  AP_D5SRC3B  AP_D5SRC5A  AP_D5SRC4B  AP_D5SRC4C  AP_D5SRC6A  AP_D5SRC5B  AP_D5SRC5C  AP_D5SRC7A  AP_D5SRC6B  AP_D5SRC4D  AP_D5SRC7B  AP_D5SRC6C  AP_D5SRC7C  AP_D5SRC4E  AP_D5SRC5E  AP_D5SRC6D  AP_D5SRC7D  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
SRCSLOTS    ****        ****        ****        ****        ****        ****        ****        ****        AP_D5SRC1D  ****        AP_D5SRC2C  AP_D5SRC3C  ****        AP_D5SRC1E  AP_D5SRC2D  ****        AP_D5SRC3D  AP_D5SRC1F  AP_D5SRC2E  AP_D5SRC5D  AP_D5SRC3E  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
SRCSLOTX    ****        AP_D5SRC1T  ****        AP_D5SRC2T  ****        AP_D5SRC3T  ****        AP_D5SRC4T  ****        AP_D5SRC5T  ****        ****        AP_D5SRC6T  ****        ****        AP_D5SRC7T  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
~

// copy spell tables__________________________________________________________________
//
//COPY ~might_and_guile/nubards/mxmembrd.2da~ ~override~ // just a visual table of bard memorization slots, not actually used
COPY ~might_and_guile/nubards/mxcstbrd.2da~ ~override~ // just a visual table of bard casting slots, not actually used


// generate bclons.2da________________________________________________________________
//
<<<<<<<< d5/d5bclons.2da
2DA V1.0 
SPLRES
		206		LEARN	EFF		INNATE	DISPLAY
>>>>>>>> 

COPY ~d5/d5bclons.2da~ ~override/d5bclons.2da~ 

// add new bard spells to bclons.2da__________________________________________________
//
ACTION_PHP_EACH nu_bard_spells AS ind => bard_spell BEGIN
  ACTION_IF (ind > 0) BEGIN
	ACTION_IF FILE_EXISTS_IN_GAME ~%bard_spell%.spl~ BEGIN
	  COPY_EXISTING ~%bard_spell%.spl~ ~override~
		PATCH_IF (~%bard_spell%~ STRING_MATCHES_REGEXP ~[Dd]5[Bb][Pp][1-9][0-9][0-9]~ = 0) BEGIN
		  INNER_PATCH_SAVE 206_spell ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Pp]~ ~d5n6~
		  END
		  INNER_PATCH_SAVE learn_spell ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Pp]~ ~d5nx~
		  END
		  INNER_PATCH_SAVE spell_eff ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Pp]~ ~D5NV~
		  END
		  INNER_PATCH_SAVE innate_spell ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Pp]~ ~d5n4~
		  END
		  INNER_PATCH_SAVE real_spell ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Pp]~ ~sppr~
		  END
		  PATCH_IF NOT (FILE_CONTAINS_EVALUATED (~d5bclons.2da~ ~%bard_spell%~)) BEGIN
			INNER_ACTION BEGIN
			  APPEND ~d5bclons.2da~ ~%bard_spell%	%206_spell%	%learn_spell%	%spell_eff%	%innate_spell%	%real_spell% ~
			END
		  END
		END
		PATCH_IF (~%bard_spell%~ STRING_MATCHES_REGEXP ~[Dd]5[Bb][Ii][1-9][0-9][0-9]~ = 0) BEGIN
		  INNER_PATCH_SAVE 206_spell ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Ii]~ ~d5i6~
		  END
		  INNER_PATCH_SAVE learn_spell ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Ii]~ ~d5ix~
		  END
		  INNER_PATCH_SAVE spell_eff ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Ii]~ ~D5IV~
		  END
		  INNER_PATCH_SAVE innate_spell ~%bard_spell%~ BEGIN
			REPLACE_TEXTUALLY ~[Dd]5[Bb][Ii]~ ~d5i4~
		  END
		  TEXT_SPRINT real_spell ~%bard_spell%~
		  PATCH_IF NOT (FILE_CONTAINS_EVALUATED (~d5bclons.2da~ ~%bard_spell%~)) BEGIN
			INNER_ACTION BEGIN
			  APPEND ~d5bclons.2da~ ~%bard_spell%	%206_spell%	%learn_spell%	%spell_eff%	%innate_spell%	%real_spell% ~
			END
		  END
		END
	  BUT_ONLY
	END
  END
END

// script to check memorized spells___________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~d5blotr.bcs~) BEGIN
  DELETE ~override/d5blotr.bcs~
END

COPY_EXISTING ~d5bclons.2da~ ~override~
  COUNT_2DA_COLS cols
  READ_2DA_ENTRIES_NOW ~r2en_bclons~ cols
  FOR (row = 0; row < r2en_bclons; ++row) BEGIN
	READ_2DA_ENTRY_FORMER ~r2en_bclons~ row 0 original_spell
	READ_2DA_ENTRY_FORMER ~r2en_bclons~ row 2 learn_spell
	INNER_ACTION BEGIN
	  APPEND_OUTER ~weidu_external/d5_bard_cast/d5blotr.baf~ ~
IF
    TriggerOverride(LastSummonerOf(Myself),HaveSpellRES("%original_spell%"))
THEN
    RESPONSE #100
    ActionOverride(LastSummonerOf(Myself),ApplySpellRes("%learn_spell%",Myself))
    Continue()
END
~
	END
  END
BUT_ONLY

APPEND_OUTER ~weidu_external/d5_bard_cast/d5blotr.baf~ ~
IF
	True()
THEN
	RESPONSE #100
	ActionOverride(LastSummonerOf(Myself),ApplySpellRes("D5PREPD",Myself))
	DestroySelf() 
END
~

COMPILE ~weidu_external/d5_bard_cast/d5blotr.baf~


//clone spells________________________________________________________________________
//
COPY_EXISTING ~d5bclons.2da~ ~override~
  COUNT_2DA_COLS cols
  READ_2DA_ENTRIES_NOW ~r2en_bclons~ cols
  FOR (row = 0; row < r2en_bclons; ++row) BEGIN
	READ_2DA_ENTRY_FORMER ~r2en_bclons~ row 0 real_spell
	READ_2DA_ENTRY_FORMER ~r2en_bclons~ row 1 206_spell
	READ_2DA_ENTRY_FORMER ~r2en_bclons~ row 2 learn_spell
	READ_2DA_ENTRY_FORMER ~r2en_bclons~ row 3 spell_eff
	READ_2DA_ENTRY_FORMER ~r2en_bclons~ row 4 innate_spell
	READ_2DA_ENTRY_FORMER ~r2en_bclons~ row 5 book_spell
	INNER_ACTION BEGIN
	  COPY_EXISTING ~%real_spell%.spl~ ~override~
		READ_LONG 0x34 spell_level
	  BUT_ONLY
// make innates that cast the original
//	  ACTION_IF NOT FILE_EXISTS_IN_GAME ~%innate_spell%.spl~ BEGIN
		COPY_EXISTING ~%real_spell%.spl~ ~override/%innate_spell%.spl~
		  WRITE_SHORT 0x1c 4
		  LPF ALTER_SPELL_HEADER INT_VAR location = 2 END
//		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = ~d5bwiz~ END
// 			don't need that ^ if casting original spell
		  READ_LONG 0x64 abil_offset
		  READ_SHORT 0x68 abil_number
		  READ_BYTE (%abil_offset% + 0x0c) abil_target					
		  READ_SHORT (%abil_offset% + 0x0e) abil_range
		  READ_LONG 0x6a eff_offset
		  WHILE (%abil_number% > 0) BEGIN
			SET abil_number = (%abil_number% - 1)
			WRITE_SHORT (%abil_offset% + 0x26 + (0x28 * %abil_number%)) 1
		  END
		  READ_BYTE (%eff_offset% + 0x02) eff_target
		  LPF DELETE_EFFECT INT_VAR match_probability2 = 0 END
		  PATCH_IF (%abil_target% = 4) BEGIN
			LPF ADD_SPELL_EFFECT INT_VAR opcode = 148 target = 1 power = %spell_level% parameter1 = 0 parameter2 = 1 timing = 1 STR_VAR resource = EVAL ~%real_spell%~ END
			PATCH_IF (%abil_range% < 35) BEGIN
			  PATCH_IF (%abil_range% > 4) BEGIN
				LPF ALTER_SPELL_HEADER INT_VAR range = (%abil_range% - 3) END
			  END
			  PATCH_IF (%abil_range% < 5) BEGIN
			 	LPF ALTER_SPELL_HEADER INT_VAR target = 5 END	// might need to carve out exceptions, e.g. burning hands
			  END
			END
		  END
		  ELSE BEGIN
			LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 2 power = %spell_level% parameter2 = 1 timing = 9 STR_VAR resource = EVAL ~%real_spell%~ END
		  END
// exempt lvl 1 if lv1 1 cantrips
		  PATCH_IF MOD_IS_INSTALLED ~tomeandblood.tp2~ ~62~ BEGIN
//		   PATCH_IF NOT (%spell_level%) = 1 BEGIN
		   PATCH_IF (%spell_level% > 1) BEGIN
			LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = EVAL ~d5src-%spell_level%~ END
		   END
		  END
		  PATCH_IF NOT MOD_IS_INSTALLED ~tomeandblood.tp2~ ~62~ BEGIN
			LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = EVAL ~d5src-%spell_level%~ END
		  END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bsplz~ END
//	  END
// make .EFFs adding the innate spell
//	  ACTION_IF NOT FILE_EXISTS_IN_GAME ~%spell_eff%.eff~ BEGIN
	  OUTER_SET string_length = (STRING_LENGTH ~%spell_eff%~)
	  ACTION_IF (%string_length% < 8) BEGIN
		CREATE EFF ~%spell_eff%~
		 WRITE_LONG 0x10 171
		 WRITE_LONG 0x14 1
		 WRITE_LONG 0x24 0
		 WRITE_LONG 0x28 1
		 WRITE_SHORT 0x2c 100
		 WRITE_EVALUATED_ASCII 0x30 ~%innate_spell%~ #8
		 WRITE_LONG 0x90 1
		 WRITE_EVALUATED_ASCII 0x94 ~%spell_eff%~ #8
	  END
//	  END
// make 206 spells preventing the .EFF
//	  ACTION_IF NOT FILE_EXISTS_IN_GAME ~%206_spell%.spl~ BEGIN
		COPY ~might_and_guile/lib/d5_base.spl~ ~override/%206_spell%.spl~
		 WRITE_SHORT 0x1c 4
	  	 LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
	  	 LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 321 target = 1 timing = 9 STR_VAR resource = EVAL ~%206_spell%~ END
//	  END
// add 206 spells to CLAB spell
	  COPY_EXISTING ~d5b206.spl~ ~override~
		LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = EVAL ~%206_spell%~ END
// make learn spells canceling the 206
//	  ACTION_IF NOT FILE_EXISTS_IN_GAME ~%learn_spell%.spl~ BEGIN
		COPY ~might_and_guile/lib/d5_base.spl~ ~override/%learn_spell%.spl~
	  	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = EVAL ~%206_spell%~ END
//		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = EVAL ~%206_spell%~ END
//	  END
// add 172 to d5bsplz
	  COPY_EXISTING ~d5bsplz.spl~ ~override~
		LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~%innate_spell%~ END
// add 172 to d5prepb - edit: maybe don't need to, because already in bsplz and prepb casts bsplz
//	  COPY_EXISTING ~d5prepb.spl~ ~override~
//		LPF ADD_SPELL_EFFECT INT_VAR insert_point = 0 opcode = 172 target = 1 timing = 9 STR_VAR resource = EVAL ~%innate_spell%~ END
// generate slot#x spells
//	  ACTION_IF (spell_level < 8) BEGIN
	  ACTION_IF FILE_EXISTS_IN_GAME ~d5blot%spell_level%a.spl~ BEGIN
		COPY_EXISTING ~d5blot%spell_level%a.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		COPY_EXISTING ~d5blot%spell_level%b.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		COPY_EXISTING ~d5blot%spell_level%c.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		COPY_EXISTING ~d5blot%spell_level%d.spl~ ~override~
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
		  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = EVAL ~%spell_eff%~ END
	  END
	END
  END
BUT_ONLY


// metamagic scrolls__________________________________________________________________
//
ACTION_FOR_EACH meta_scroll IN ~scrl6p~ ~scrl8l~ ~scrl9d~ ~scrl7u~ ~scrl9q~ BEGIN
  ACTION_IF FILE_EXISTS_IN_GAME ~%meta_scroll%.itm~ BEGIN
	COPY_EXISTING ~%meta_scroll%.itm~ ~override~
	  WRITE_BYTE 0x2b (THIS BOR 0b10000000) // set unusable by skalds
	BUT_ONLY
  END
END


// initialize songs and casting_______________________________________________________
//
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd144.spl~
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 144 target = 1 parameter2 = 2 timing = 9 END
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 145 target = 1 parameter2 = 0 timing = 9 END
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 101 target = 1 parameter2 = 145 timing = 9 END

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bd000.spl~	//		apply 206 spells
//  SAY NAME1 @6  											// ~~
//  SAY UNIDENTIFIED_DESC @6 								// ~~
  PATCH_FOR_EACH nu_song_z IN ~01z~ ~02z~ ~03z~ ~05z~ ~06z~ ~07z~ ~08z~ ~20z~ ~21z~ ~22z~ ~23z~ ~24z~ ~25z~ ~41z~ ~42z~ ~43z~ ~46z~ ~47z~ ~48z~ ~49z~ ~51z~ ~61z~ BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song_z%~ END
  END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 93 target = 1 parameter1 = 1 parameter2 = 1 timing = 1 END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = ~spcl412~ END
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 244 target = 1 parameter1 = 9 timing = 1 END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = ~d5bd144~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = ~d5prepb~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter2 = 2 timing = 9 STR_VAR resource = ~d5blots~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5bcast~ END

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bdb00.spl~	//		apply 206 spells
  PATCH_FOR_EACH nu_song_z IN ~01z~ ~02z~ ~03z~ ~05z~ ~06z~ ~07z~ ~08z~ ~20z~ ~21z~ ~22z~ ~23z~ ~24z~ ~25z~ ~41z~ ~42z~ ~43z~ ~46z~ ~47z~ ~48z~ ~49z~ ~51z~ ~61z~ BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = EVAL ~d5bd%nu_song_z%~ END
  END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = ~spcl412~ END

COPY ~might_and_guile/nubards/d5bcast.bam~ ~override~
COPY ~might_and_guile/lib/d5_base.spl~ ~override/d5bcast.spl~
  SAY NAME1 @21982 											// ~initialize bardic spellcasting~
  SAY UNIDENTIFIED_DESC @21982 								// ~initialize bardic spellcasting~
  LPF ALTER_SPELL_HEADER INT_VAR target = 5 STR_VAR icon = ~d5bcast~ END
/*
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5fmnuse~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5fmnuse~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5mtnuse~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5mtnuse~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5ctnuse~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5ctnuse~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d5bnuse~ END
*/
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = ~spcl412~ END
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 328 target = 1 special = 1 parameter2 = %prepared_spells_state% timing = 9 END
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~D5BLOTZ~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5prepb~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 172 target = 1 timing = 9 STR_VAR resource = ~d5bcast~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5bd144~ END
//  LPF ADD_SPELL_EFFECT INT_VAR opcode = 279 target = 1 parameter2 = 2 timing = 9 END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5bd000~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 316 target = 1 timing = 1 END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d517slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
  LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 4 duration = 1 STR_VAR resource = ~d5bsplz~ END
/*
  PATCH_IF (FILE_EXISTS_IN_GAME ~qdtnb_attrbon.qd~) BEGIN
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 42 target = 1 parameter1 = (0 - 1) parameter2 = 127 timing = 9 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 42 target = 1 parameter1 = (0 - 1) parameter2 = 127 timing = 9 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (2 << 4) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (2 << 8) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (2 << 12) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (2 << 16) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = (1 << 20) parameter2 = (108 + (0x10000 * 1)) timing = 9 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5absp1~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5absp1~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5abspw~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5abspw~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = 0 parameter2 = 2 timing = 9 STR_VAR resource = ~d5abspm~ END
  END
*/

APPEND ~d5nubard.2da~ ~BARD_INIT   AP_D5BD000  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~
//APPEND ~d5nubard.2da~ ~BARD_INIT   AP_D5BD144  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~
//APPEND ~d5nubard.2da~ ~BARD_INIT   AP_D5PREPB  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~


//stat-based bonus spells_____________________________________________________________
//
ACTION_IF (FILE_EXISTS_IN_GAME ~qdtnb_attrbon.qd~) BEGIN

  COPY_EXISTING ~splprot.2da~ ~override~
	COUNT_2DA_COLS cols 
	READ_2DA_ENTRIES_NOW rows cols   
	FOR (row = 1; row < rows; ++row) BEGIN 
	  READ_2DA_ENTRY_FORMER rows row 0 ~stat~ 
	  PATCH_IF ~%stat%~ STRING_EQUAL_CASE ~D5_CHR_SLOTS~ BEGIN
	    SET chr_slots = %row%
	  END
	END
  BUT_ONLY

  ACTION_IF !(FILE_EXISTS_IN_GAME ~d5nabsw.spl~) BEGIN
	COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5nabsw.spl~
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5absp1~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5absp1~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5abspw~ END
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 206 target = 1 parameter1 = (0 - 1) timing = 9 STR_VAR resource = ~d5abspw~ END
//	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 42 target = 1 parameter1 = (0 - 1) parameter2 = 127 timing = 9 END
//	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 42 target = 1 parameter1 = (0 - 1) parameter2 = 127 timing = 9 END
  END

  APPEND ~d5nubard.2da~  ~STATSLOTS   AP_D5NABSW  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC1R  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC1S  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC2R  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC2S  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC3R  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC3S  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC4R  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC4S  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
STATSLOTS   AP_D5SRC5S  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** 
~


  ACTION_DEFINE_ASSOCIATIVE_ARRAY cha_nums_lets BEGIN
	13	=> m
	14	=> n
	15	=> o
	16	=> p
	17	=> q
	18	=> r
	19	=> s
	20	=> t
	21	=> u
	22	=> v
	23	=> w
	24	=> x
	25	=> y
  END

  COPY_EXISTING  ~d5blots.spl~ ~override~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = 13 parameter2 = 133 timing = 1 STR_VAR resource = ~d5chrml~ END
	PHP_EACH cha_nums_lets AS num => let BEGIN
	  LPF ADD_SPELL_EFFECT INT_VAR opcode = 326 target = 1 parameter1 = %num% parameter2 = %chr_slots% timing = 1 STR_VAR resource = EVAL ~d5chrm%let%~ END
	END

 ACTION_IF !(FILE_EXISTS_IN_GAME ~d5chrml.spl~) BEGIN
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrml.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrml~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 4) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 4) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 8) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 8) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmm.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 4) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 8) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 8) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmn.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmn~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 8) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 8) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmo.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmo~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) <<8) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmp.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmp~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 8) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmq.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmq~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmr.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmr~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrms.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrms~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 12) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmt.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmu.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmu~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmv.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmv~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 16) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmw.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmw~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 233 target = 1 parameter1 = ((0 - 1) << 20) parameter2 = (108 + (0x10000 * 1)) timing = 0 duration = 7 END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmx.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmx~ END
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5chrmy.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 321 target = 1 timing = 9 STR_VAR resource = ~d5chrmy~ END
 END

/*
  COPY ~tomeandblood/lib/d5_base.spl~ ~override/d5absp5.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bard_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_blade_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_jester_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_skald_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_gallant_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_herald_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_meister_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_jinxer_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_elegist_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_agent_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_hexblade_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 177 target = 1 parameter1 = %nu_bladesinger_code% parameter2 = 9 timing = 9 STR_VAR resource = ~d5abspm~ END

 ACTION_IF !(FILE_EXISTS_IN_GAME ~d5abspm.eff~) BEGIN
  COPY_EXISTING ~d5absps.eff~ ~override/d5abspm.eff~
	WRITE_ASCII 0x30 ~d5abspm~ #8
 END

  APPEND ~clabma01.2da~  ~STATSLOTS   AP_D5ABSP5  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
*/

END
//____________________________________________________________________________________


//make sure no level 8-9 slots________________________________________________________
//
COPY_EXISTING ~d589slt.spl~ ~override/d589sl2.spl~

COPY ~might_and_guile/lib/d5_base.spl~ ~override/d589spl.spl~
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END
	LPF ADD_SPELL_EFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 9 STR_VAR resource = ~d589slt~ END

APPEND ~d5nubard.2da~ ~BARD_INIT   AP_D589SPL  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~


//append nubard.2da to clab tables____________________________________________________
//
COPY_EXISTING ~d5_bard.2da~ ~override~
			  ~d5_blade.2da~ ~override~
			  ~d5_jstr.2da~ ~override~
			  ~d5_skld.2da~ ~override~
			  ~d5_glnt.2da~ ~override~
			  ~d5_mstr.2da~ ~override~
			  ~d5_jinx.2da~ ~override~
			  ~d5_eleg.2da~ ~override~
			  ~d5_hxbl.2da~ ~override~
			  ~d5_agnt.2da~ ~override~
			  ~d5_blads.2da~ ~override~
  LPM remove_blank_lines
  APPEND_FILE ~override/d5nubard.2da~
IF_EXISTS

// demibards just get the song init
APPEND ~d5_hrld.2da~ ~BARD_SONG   AP_D5BDB00  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~
APPEND ~d5_whsl.2da~ ~BARD_SONG   AP_D5BDB00  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~
APPEND ~d5_lors.2da~ ~BARD_SONG   AP_D5BDB00  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~
APPEND ~d5_lort.2da~ ~BARD_SONG   AP_D5BDB00  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****       ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****  ~


/*
COPY_EXISTING ~d5_lors.2da~ ~override~
  REPLACE_TEXTUALLY ~GA_D5FEAT[aAbBcCdDeEfFgGhHiIjJkKllmMnNoopPqQrRsStT]~ ~****      ~
IF_EXISTS
*/

//remove one slot from some kits______________________________________________________
//
// blade, jinxer have more thief skills
// F/M kits are strong, knock them down too

COPY_EXISTING ~d5_blade.2da~ ~override~
//			  ~d5_jinx.2da~ ~override~
			  ~d5_glnt.2da~ ~override~
			  ~d5_skld.2da~ ~override~
			  ~d5_hxbl.2da~ ~override~
			  ~d5_blads.2da~ ~override~
	READ_2DA_ENTRIES_NOW rows 2
	SET rows_removed = 0
	FOR (row = 1; row < rows; ++row) BEGIN
	  READ_2DA_ENTRY_FORMER rows row 0 line
	  PATCH_IF (~%line%~ STRING_EQUAL_CASE ~SRCSLOTX~) BEGIN
		REMOVE_2DA_ROW (row - rows_removed) cols
		SET rows_removed += 1
	  END
	END
BUT_ONLY

APPEND ~d5_blade.2da~ ~NOSLOTS     AP_D501SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
APPEND ~d5_jinx.2da~ ~NOSLOTS     AP_D501SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
APPEND ~d5_glnt.2da~ ~NOSLOTS     AP_D501SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
APPEND ~d5_skld.2da~ ~NOSLOTS     AP_D501SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
APPEND ~d5_hxbl.2da~ ~NOSLOTS     AP_D501SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~
APPEND ~d5_blads.2da~ ~NOSLOTS     AP_D501SLT  ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        ****        **** ~

//____________________________________________________________________________________


//HLA TABLES__________________________________________________________________________
//
// ***** need to change these so they adjust from multi-mage tables instead of thief

// give extra feats as HLAs (up to ... 5?)
//
// make bard HLAs available to these kits
//
// add vocalize aura:
COPY ~might_and_guile/nubards/d5nosil.spl~ ~override~
  SAY NAME1 @21998
  SAY UNIDENTIFIED_DESC @21999
COPY ~might_and_guile/nubards/d5nosil.eff~ ~override~
COPY ~might_and_guile/nubards/d5nosila.spl~ ~override~

COPY_EXISTING ~d5src1a.spl~ ~override/d5brds1.spl~
  SAY NAME1 @21991
  SAY UNIDENTIFIED_DESC @21991
COPY_EXISTING ~d5src2a.spl~ ~override/d5brds2.spl~
  SAY NAME1 @21992
  SAY UNIDENTIFIED_DESC @21992
COPY_EXISTING ~d5src3a.spl~ ~override/d5brds3.spl~
  SAY NAME1 @21993
  SAY UNIDENTIFIED_DESC @21993
COPY_EXISTING ~d5src4a.spl~ ~override/d5brds4.spl~
  SAY NAME1 @21994
  SAY UNIDENTIFIED_DESC @21994
COPY_EXISTING ~d5src5a.spl~ ~override/d5brds5.spl~
  SAY NAME1 @21995
  SAY UNIDENTIFIED_DESC @21995
COPY_EXISTING ~d5src6a.spl~ ~override/d5brds6.spl~
  SAY NAME1 @21996
  SAY UNIDENTIFIED_DESC @21996
COPY_EXISTING ~d5src7a.spl~ ~override/d5brds7.spl~
  SAY NAME1 @21997
  SAY UNIDENTIFIED_DESC @21997

LAF action_add_hla STR_VAR kit_name = ~D5_BLADE~ ability = ~GA_SPCL900~ num_allowed = ~2~ END			//	whirlwind
LAF action_add_hla STR_VAR kit_name = ~D5_BLADE~ ability = ~GA_SPCL423~ num_allowed = ~2~ END			//	poison weapon
LAF action_remove_hla STR_VAR kit_name = ~D5_BLADE~ remove_ability = ~GA_SPCL905~ END					//	no critical strike
LAF action_remove_hla STR_VAR kit_name = ~D5_BLADE~ remove_ability = ~GA_SPCL906~ END					//	no power attack
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_BLADE~ ability = ~AP_D5_RFA5~ num_allowed = ~1~ END			//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_BLADE~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END			//	spell evasion
  LAF action_add_hla STR_VAR kit_name = ~D5_BLADE~ ability = ~AP_D5_UMD~ num_allowed = ~1~ END			//	use scrolls/wands
  LAF action_add_hla STR_VAR kit_name = ~D5_BLADE~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END			//	extra feats
END

ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_JESTER~ ability = ~AP_D5_RFA5~ num_allowed = ~2~ END		//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_JESTER~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END		//	spell evasion
  LAF action_add_hla STR_VAR kit_name = ~D5_JESTER~ ability = ~AP_D5_RFD5~ num_allowed = ~3~ END		//	saving throw bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_JESTER~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END		//	extra feats
END

LAF action_add_hla STR_VAR kit_name = ~D5_SKALD~ ability = ~GA_SPCL909~ num_allowed = ~3~ prerequisite = ~AP_SPCL905~ END	//	smite
LAF action_add_hla STR_VAR kit_name = ~D5_SKALD~ ability = ~GA_SPCL902~ num_allowed = ~3~ END				//	death blow
LAF action_add_hla STR_VAR kit_name = ~D5_SKALD~ ability = ~GA_SPCL908~ num_allowed = ~3~ END				//	war cry
LAF action_add_hla STR_VAR kit_name = ~D5_SKALD~ ability = ~GA_SPCL321~ num_allowed = ~1~ END				//	zerk rage
LAF action_remove_hla STR_VAR kit_name = ~D5_SKALD~ remove_ability = ~GA_SPCL913~ END					//	no evasion
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_SKALD~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END			//	extra feats
END

LAF action_add_hla STR_VAR kit_name = ~D5_GALLANT~ ability = ~GA_SPCL909~ num_allowed = ~3~ prerequisite = ~AP_SPCL905~ END	//	smite
LAF action_add_hla STR_VAR kit_name = ~D5_GALLANT~ ability = ~GA_SPCL904~ num_allowed = ~1~ END				//	resist magic
LAF action_add_hla STR_VAR kit_name = ~D5_GALLANT~ ability = ~GA_SPCL211~ num_allowed = ~1~ END				//	lay on hands
LAF action_add_hla STR_VAR kit_name = ~D5_GALLANT~ ability = ~GA_SPCL233~ num_allowed = ~3~ END				//	pro. evil 10' radius
LAF action_remove_hla STR_VAR kit_name = ~D5_GALLANT~ remove_ability = ~GA_SPCL913~ END					//	no evasion
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_GALLANT~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END		//	extra feats
END

LAF action_add_hla STR_VAR kit_name = ~D5_HERALD~ ability = ~GA_SPCL907~ num_allowed = ~1~ END				//	resist magic
LAF action_add_hla STR_VAR kit_name = ~D5_HERALD~ ability = ~GA_SPCL904~ num_allowed = ~1~ END				//	hardiness
LAF action_add_hla STR_VAR kit_name = ~D5_HERALD~ ability = ~GA_SPCL908~ num_allowed = ~3~ END				//	war cry
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_HERALD~ ability = ~AP_D5_RFA5~ num_allowed = ~1~ END		//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_HERALD~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END		//	spell evasion
//  LAF action_add_hla STR_VAR kit_name = ~D5_HERALD~ ability = ~AP_D5_WFA2~ num_allowed = ~1~ excluded_by = ~AP_D5_WFA3~ END		//	offensive tactics
//  LAF action_add_hla STR_VAR kit_name = ~D5_HERALD~ ability = ~AP_D5_WFA3~ num_allowed = ~1~ excluded_by = ~AP_D5_WFA2~ END		//	defensive tactics
  LAF action_add_hla STR_VAR kit_name = ~D5_HERALD~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END		//	extra feats
END

LAF action_add_hla STR_VAR kit_name = ~D5_MEISTER~ ability = ~GA_SPCL922~ num_allowed = ~1~ END			//	tracking
LAF action_add_hla STR_VAR kit_name = ~D5_MEISTER~ ability = ~AP_SPCL924~ num_allowed = ~1~ END			//	poison immunity
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_MEISTER~ ability = ~AP_D5_RFA5~ num_allowed = ~2~ END		//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_MEISTER~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END		//	spell evasion
  LAF action_add_hla STR_VAR kit_name = ~D5_MEISTER~ ability = ~AP_D5_UMD~ num_allowed = ~1~ END		//	use scrolls/wands
  LAF action_add_hla STR_VAR kit_name = ~D5_MEISTER~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END		//	extra feats
END

LAF action_add_hla STR_VAR kit_name = ~D5_JINXER~ ability = ~GA_SPCL914~ num_allowed = ~3~ prerequisite = ~AP_SPCL913~ END	//	greater evasion
LAF action_add_hla STR_VAR kit_name = ~D5_JINXER~ ability = ~AP_SPSD02~ num_allowed = ~3~ END			//	shadowstep
LAF action_add_hla STR_VAR kit_name = ~D5_JINXER~ ability = ~AP_SPCL937~ num_allowed = ~1~ END			//	shadow maze
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_JINXER~ ability = ~AP_D5_RFA5~ num_allowed = ~1~ END		//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_JINXER~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END		//	spell evasion
  LAF action_add_hla STR_VAR kit_name = ~D5_JINXER~ ability = ~AP_D5_RFG5~ num_allowed = ~1~ END		//	fighting dirty
  LAF action_add_hla STR_VAR kit_name = ~D5_JINXER~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END		//	extra feats
END

LAF action_add_hla STR_VAR kit_name = ~D5_ELEGIST~ ability = ~AP_SPSD02~ num_allowed = ~3~ END			//	shadowstep
LAF action_add_hla STR_VAR kit_name = ~D5_ELEGIST~ ability = ~AP_SPCL937~ num_allowed = ~1~ END			//	shadow maze
LAF action_add_hla STR_VAR kit_name = ~D5_ELEGIST~ ability = ~GA_SPCL902~ num_allowed = ~3~ END			//	death blow
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_ELEGIST~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END		//	spell evasion
  LAF action_add_hla STR_VAR kit_name = ~D5_ELEGIST~ ability = ~AP_D5_RFG5~ num_allowed = ~1~ END		//	fighting dirty
  LAF action_add_hla STR_VAR kit_name = ~D5_ELEGIST~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END		//	extra feats
END

LAF action_add_hla STR_VAR kit_name = ~D5_HEXBLADE~ ability = ~GA_SPCL909~ num_allowed = ~3~ prerequisite = ~AP_SPCL905~ END	//	smite
LAF action_add_hla STR_VAR kit_name = ~D5_HEXBLADE~ ability = ~GA_SPCL902~ num_allowed = ~3~ END				//	death blow
LAF action_add_hla STR_VAR kit_name = ~D5_HEXBLADE~ ability = ~GA_SPCL908~ num_allowed = ~3~ END				//	war cry
LAF action_add_hla STR_VAR kit_name = ~D5_HEXBLADE~ ability = ~GA_SPCL321~ num_allowed = ~1~ END				//	zerk rage
LAF action_remove_hla STR_VAR kit_name = ~D5_HEXBLADE~ remove_ability = ~GA_SPCL913~ END					//	no evasion
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_HEXBLADE~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END			//	extra feats
END

LAF action_add_hla STR_VAR kit_name = ~D5_AGENT~ ability = ~GA_SPCL914~ num_allowed = ~3~ prerequisite = ~AP_SPCL913~ END	//	greater evasion
LAF action_add_hla STR_VAR kit_name = ~D5_AGENT~ ability = ~AP_SPSD02~ num_allowed = ~3~ END			//	shadowstep
LAF action_add_hla STR_VAR kit_name = ~D5_AGENT~ ability = ~AP_SPCL937~ num_allowed = ~1~ END			//	shadow maze
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_AGENT~ ability = ~AP_D5_RFA5~ num_allowed = ~1~ END			//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_AGENT~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END			//	spell evasion
  LAF action_add_hla STR_VAR kit_name = ~D5_AGENT~ ability = ~AP_D5_RFG5~ num_allowed = ~1~ END			//	fighting dirty
  LAF action_add_hla STR_VAR kit_name = ~D5_AGENT~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END			//	extra feats
END

/*
LAF action_add_hla STR_VAR kit_name = ~D5_LORESINGER~ ability = ~GA_SPCL907~ num_allowed = ~1~ END			//	resist magic
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_LORESINGER~ ability = ~AP_D5_RFA5~ num_allowed = ~2~ END	//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_LORESINGER~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END	//	spell evasion
  LAF action_add_hla STR_VAR kit_name = ~D5_LORESINGER~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END	//	extra feats
END
*/

LAF action_add_hla STR_VAR kit_name = ~D5_BLADESINGER~ ability = ~GA_SPCL907~ num_allowed = ~1~ END				//	resist magic
LAF action_add_hla STR_VAR kit_name = ~D5_BLADESINGER~ ability = ~GA_SPCL904~ num_allowed = ~1~ END				//	hardiness
LAF action_add_hla STR_VAR kit_name = ~D5_BLADESINGER~ ability = ~GA_SPCL908~ num_allowed = ~3~ END				//	war cry
ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_BLADESINGER~ ability = ~AP_D5_RFA5~ num_allowed = ~1~ END		//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_BLADESINGER~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END		//	spell evasion
//  LAF action_add_hla STR_VAR kit_name = ~D5_BLADESINGER~ ability = ~AP_D5_WFA2~ num_allowed = ~1~ excluded_by = ~AP_D5_WFA3~ END		//	offensive tactics
//  LAF action_add_hla STR_VAR kit_name = ~D5_BLADESINGER~ ability = ~AP_D5_WFA3~ num_allowed = ~1~ excluded_by = ~AP_D5_WFA2~ END		//	defensive tactics
  LAF action_add_hla STR_VAR kit_name = ~D5_BLADESINGER~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END		//	extra feats
END

ACTION_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
  LAF action_add_hla STR_VAR kit_name = ~D5_BARD~ ability = ~AP_D5_RFA5~ num_allowed = ~2~ END			//	luck bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_BARD~ ability = ~AP_D5_RFD3~ num_allowed = ~1~ END			//	spell evasion
  LAF action_add_hla STR_VAR kit_name = ~D5_BARD~ ability = ~AP_D5_RFD5~ num_allowed = ~3~ END			//	saving throw bonus
  LAF action_add_hla STR_VAR kit_name = ~D5_BARD~ ability = ~GA_D5FEAT0~ num_allowed = ~3~ END			//	extra feats
END

ACTION_IF FILE_EXISTS_IN_GAME ~RR#BHL01.SPL~ BEGIN
  ACTION_FOR_EACH bard_kit IN ~D5_BARD~ ~D5_BLADE~ ~D5_JESTER~ ~D5_SKALD~ ~D5_GALLANT~ ~D5_HERALD~ ~D5_MEISTER~ ~D5_JINXER~ ~D5_HEXBLADE~ ~D5_AGENT~ /*~D5_LORESINGER~*/ ~D5_BLADESINGER~ BEGIN
// replace spcl921 with RR magic flute
	LAF action_replace_hla STR_VAR kit_name = ~D5_BARD~ remove_ability = ~GA_SPCL921~ ability = ~GA_RR#BHL07~ END
// add other RR HLAs
	LAF action_add_hla STR_VAR kit_name = ~%bard_kit%~ ability = ~GA_RR#BHL01~ num_allowed = ~3~ END		//	mass charm
	LAF action_add_hla STR_VAR kit_name = ~%bard_kit%~ ability = ~GA_RR#BHL02~ num_allowed = ~3~ END		//	enthralling melody
	LAF action_add_hla STR_VAR kit_name = ~%bard_kit%~ ability = ~GA_RR#BHL05~ num_allowed = ~3~ END		//	resonating weapon
	LAF action_add_hla STR_VAR kit_name = ~%bard_kit%~ ability = ~GA_RR#BHL06~ num_allowed = ~3~ END		//	sound barrier
	LAF action_add_hla STR_VAR kit_name = ~%bard_kit%~ ability = ~GA_RR#BHL03~ num_allowed = ~3~ END		//	sound burst
  END
END
//____________________________________________________________________________________


//CHANGE NPC BARDS____________________________________________________________________
//
// do a basic algorithmic change
// then specifically make garrick = gallant and eldoth = jinxer

/* why was this here?
COPY_EXISTING ~kitlist.2da~ ~override~
  COUNT_2DA_ROWS 8 rows
  FOR (row = 3; row < rows; ++row) BEGIN 
	READ_2DA_ENTRY row 1 8 ~kit_name~
	PATCH_IF (~%kit_name%~ STRING_EQUAL_CASE ~D5_BARD~ = 1) BEGIN
	  SET new_bard = %row% - 1
	END
  END
BUT_ONLY
*/

ACTION_PHP_EACH JOINABLE_NPC_ARRAY AS cre => dv BEGIN
//  PRINT ~%cre% => %dv%~ 
  COPY_EXISTING ~%cre%~ ~override~
	PATCH_IF (SOURCE_SIZE > 0x2d3) BEGIN
	  READ_BYTE 0x273 npc_class
	  READ_SHORT 0x246 old_kit
	  PATCH_IF (npc_class = 5) BEGIN
		PATCH_IF (old_kit = 16384) OR
		  		 (old_kit = 0) BEGIN 									// trueclass bards
		  WRITE_BYTE 0x234 1 											// sets level to 1
		  WRITE_BYTE 0x235 1
		  WRITE_BYTE 0x236 1
		  WRITE_BYTE 0x273 13 											// sets class
		  WRITE_SHORT 0x244 (%nu_bard_code% >> 16) & 0xffff
		  WRITE_SHORT 0x246 %nu_bard_code% & 0xffff
		  WRITE_BYTE 0x0045 10
		  WRITE_BYTE 0x0064 5
		  WRITE_BYTE 0x0065 5
		  WRITE_BYTE 0x0066 25
		  WRITE_BYTE 0x0067 5
		  WRITE_BYTE 0x0068 10
		  WRITE_BYTE 0x0069 5
		  WRITE_BYTE 0x006a 5
	 	  READ_BYTE 0x23d npc_con
		  PATCH_IF (npc_con < 15) BEGIN
			WRITE_SHORT 0x24 6
			WRITE_SHORT 0x26 6
		  END
		  PATCH_IF (npc_con = 15) BEGIN
			WRITE_SHORT 0x24 7
			WRITE_SHORT 0x26 7
		  END
		  PATCH_IF (npc_con > 15) BEGIN
			WRITE_SHORT 0x24 8
			WRITE_SHORT 0x26 8
		  END
		END
		PATCH_IF (old_kit = 16397) BEGIN 								// blades
		  WRITE_BYTE 0x234 1 											// sets level to 1
		  WRITE_BYTE 0x235 1
		  WRITE_BYTE 0x236 1
		  WRITE_BYTE 0x273 13 											// sets class
		  WRITE_SHORT 0x244 (%nu_blade_code% >> 16) & 0xffff
		  WRITE_SHORT 0x246 %nu_blade_code% & 0xffff
		  WRITE_BYTE 0x0045 10
		  WRITE_BYTE 0x0064 5
		  WRITE_BYTE 0x0065 5
		  WRITE_BYTE 0x0066 10
		  WRITE_BYTE 0x0067 5
		  WRITE_BYTE 0x0068 10
		  WRITE_BYTE 0x0069 5
		  WRITE_BYTE 0x006a 5
	 	  READ_BYTE 0x23d npc_con
		  PATCH_IF (npc_con < 15) BEGIN
			WRITE_SHORT 0x24 6
			WRITE_SHORT 0x26 6
		  END
		  PATCH_IF (npc_con = 15) BEGIN
			WRITE_SHORT 0x24 7
			WRITE_SHORT 0x26 7
		  END
		  PATCH_IF (npc_con > 15) BEGIN
			WRITE_SHORT 0x24 8
			WRITE_SHORT 0x26 8
		  END
		END
		PATCH_IF (old_kit = 16398) BEGIN 								// jesters
		  WRITE_BYTE 0x234 1 											// sets level to 1
		  WRITE_BYTE 0x235 1
		  WRITE_BYTE 0x236 1
		  WRITE_BYTE 0x273 4 											// sets class
		  WRITE_SHORT 0x244 (%nu_jester_code% >> 16) & 0xffff
		  WRITE_SHORT 0x246 %nu_jester_code% & 0xffff
		  WRITE_BYTE 0x0045 10
		  WRITE_BYTE 0x0064 5
		  WRITE_BYTE 0x0065 5
		  WRITE_BYTE 0x0066 25
		  WRITE_BYTE 0x0067 5
		  WRITE_BYTE 0x0068 10
		  WRITE_BYTE 0x0069 5
		  WRITE_BYTE 0x006a 5
	 	  READ_BYTE 0x23d npc_con
		  PATCH_IF (npc_con < 15) BEGIN
			WRITE_SHORT 0x24 6
			WRITE_SHORT 0x26 6
		  END
		  PATCH_IF (npc_con = 15) BEGIN
			WRITE_SHORT 0x24 7
			WRITE_SHORT 0x26 7
		  END
		  PATCH_IF (npc_con > 15) BEGIN
			WRITE_SHORT 0x24 8
			WRITE_SHORT 0x26 8
		  END
		END
		REMOVE_KNOWN_SPELLS
		REMOVE_MEMORIZED_SPELLS
		PATCH_IF (old_kit = 16399) BEGIN 								//	skalds
// ***** figure out proficiencies... just double for now
		  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 233 match_parameter1 = 1 parameter1 = 2 END
		  WRITE_BYTE 0x234 1 											// sets level to 1
		  WRITE_BYTE 0x235 1
		  WRITE_BYTE 0x236 1
		  WRITE_BYTE 0x273 7											// sets class
		  WRITE_SHORT 0x244 (%nu_skald_code% >> 16) & 0xffff
		  WRITE_SHORT 0x246 %nu_skald_code% & 0xffff
		  WRITE_BYTE 0x0066 25
		  PATCH_IF (npc_con < 15) BEGIN
			WRITE_SHORT 0x24 8
			WRITE_SHORT 0x26 8
		  END
		  PATCH_IF (npc_con = 15) BEGIN
			WRITE_SHORT 0x24 9
			WRITE_SHORT 0x26 9
		  END
		  PATCH_IF (npc_con = 16) BEGIN
			WRITE_SHORT 0x24 10
			WRITE_SHORT 0x26 10
		  END
		  PATCH_IF (npc_con = 17) BEGIN
			WRITE_SHORT 0x24 11
			WRITE_SHORT 0x26 11
		  END
		  PATCH_IF (npc_con > 17) BEGIN
			WRITE_SHORT 0x24 12
			WRITE_SHORT 0x26 12
		  END
		END
		PATCH_IF FILE_EXISTS_IN_GAME ~d5_rfeat.d5~ BEGIN
			LPF ADD_CRE_EFFECT INT_VAR opcode = 171 target = 1 timing = 9 STR_VAR resource = ~d5feata~ END
		END
	  END
	END
  BUT_ONLY
END

ACTION_FOR_EACH char IN ~eldoth~ ~eldoth5~ BEGIN
  ACTION_IF FILE_EXISTS_IN_GAME ~%char%.cre~ BEGIN
	COPY_EXISTING ~%char%.cre~ ~override~
	  WRITE_SHORT 0x244 (%nu_jinxer_code% >> 16) & 0xffff
	  WRITE_SHORT 0x246 %nu_jinxer_code% & 0xffff
	BUT_ONLY
  END
END

ACTION_FOR_EACH char IN ~garric~ ~garric2~ ~garric4~ ~garric6~ BEGIN
  ACTION_IF FILE_EXISTS_IN_GAME ~%char%.cre~ BEGIN
	COPY_EXISTING ~garric2.cre~ ~override/%char%.cre~
		  WRITE_BYTE 0x273 7
		  WRITE_SHORT 0x244 (%nu_gallant_code% >> 16) & 0xffff
		  WRITE_SHORT 0x246 %nu_gallant_code% & 0xffff
	  READ_BYTE 0x23d npc_con
	  PATCH_IF (npc_con < 15) BEGIN
		WRITE_SHORT 0x24 8
		WRITE_SHORT 0x26 8
	  END
	  PATCH_IF (npc_con = 15) BEGIN
		WRITE_SHORT 0x24 9
		WRITE_SHORT 0x26 9
	  END
	  PATCH_IF (npc_con = 16) BEGIN
		WRITE_SHORT 0x24 10
		WRITE_SHORT 0x26 10
	  END
	  PATCH_IF (npc_con = 17) BEGIN
		WRITE_SHORT 0x24 11
		WRITE_SHORT 0x26 11
	  END
	  PATCH_IF (npc_con > 17) BEGIN
		WRITE_SHORT 0x24 12
		WRITE_SHORT 0x26 12
	  END
// ***** figure out proficiencies (just double what's already there??)
	  LPF ALTER_EFFECT INT_VAR silent = 1 match_opcode = 233 match_parameter1 = 1 parameter1 = 2 END
	BUT_ONLY
  END
END
//___________________________________________________________________________________


//QD_MULTICLASS______________________________________________________________________
//
ACTION_IF FILE_EXISTS_IN_GAME ~d5_bard.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_BARD~ 
		kit_clab = ~d5_bard~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_blade.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_BLADE~ 
		kit_clab = ~d5_blade~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_jstr.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_JESTER~ 
		kit_clab = ~d5_jstr~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_skld.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_SKALD~ 
		kit_clab = ~d5_skld~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_glnt.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_GALLANT~ 
		kit_clab = ~d5_glnt~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_hrld.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_HERALD~ 
		kit_clab = ~d5_hrld~
		base_class = ~T~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_mstr.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_MEISTER~ 
		kit_clab = ~d5_mstr~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_jinx.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_JINXER~ 
		kit_clab = ~d5_jinx~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_eleg.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_ELEGIST~ 
		kit_clab = ~d5_eleg~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_hxbl.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_HEXBLADE~ 
		kit_clab = ~d5_hxbl~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_agnt.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_AGENT~ 
		kit_clab = ~d5_agnt~
		base_class = ~M~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_lort.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_LORESINGER_CT~
		kit_clab = ~d5_lort~
		base_class = ~T~
  END
END 
ACTION_IF FILE_EXISTS_IN_GAME ~d5_blads.2da~ BEGIN
  LAF qd_multiclass
	STR_VAR
		kit_name = ~D5_BLADESINGER~ 
		kit_clab = ~d5_blads~
		base_class = ~M~
  END
END 
//___________________________________________________________________________________


//CHANGE BARD STRONGHOLDS____________________________________________________________
//
// give theater to bard, blade, jester, gallant, loresinger
ACTION_IF GAME_IS ~BG2EE EET~ BEGIN

<<<<<<<< d5/raelis+.d
EXTEND_BOTTOM RAELIS 71 
  IF ~Global("PlayerHasStronghold","GLOBAL",0)
  	  OR(11)
		Kit(Player1,D5_BARD)
		Kit(Player1,D5_BLADE)
		Kit(Player1,D5_JESTER)
		Kit(Player1,D5_SKALD)
		Kit(Player1,D5_GALLANT)
		Kit(Player1,D5_HERALD)
		Kit(Player1,D5_MEISTER)
		Kit(Player1,D5_JINXER)
		Kit(Player1,D5_HEXBLADE)
		Kit(Player1,D5_AGENT)
//		Kit(Player1,D5_LORESINGER)
~ THEN DO ~EraseJournalEntry(4685)
EraseJournalEntry(46846)
EraseJournalEntry(46847)
EraseJournalEntry(46848)
EraseJournalEntry(46849)
EraseJournalEntry(46850)
EraseJournalEntry(46851)
AddXPObject(Player1,44000)
AddXPObject(Player2,44000)
AddXPObject(Player3,44000)
AddXPObject(Player4,44000)
AddXPObject(Player5,44000)
AddXPObject(Player6,44000)
~ SOLVED_JOURNAL #47761 GOTO 61
END

EXTEND_BOTTOM RAELIS 72
  IF ~  OR(11)
		Kit(Player1,D5_BARD)
		Kit(Player1,D5_BLADE)
		Kit(Player1,D5_JESTER)
		Kit(Player1,D5_SKALD)
		Kit(Player1,D5_GALLANT)
		Kit(Player1,D5_HERALD)
		Kit(Player1,D5_MEISTER)
		Kit(Player1,D5_JINXER)
		Kit(Player1,D5_HEXBLADE)
		Kit(Player1,D5_AGENT)
//		Kit(Player1,D5_LORESINGER)
  ~ THEN GOTO 73
END

EXTEND_BOTTOM HAERDA 99
  IF ~  OR(11)
		Kit(Player1,D5_BARD)
		Kit(Player1,D5_BLADE)
		Kit(Player1,D5_JESTER)
		Kit(Player1,D5_SKALD)
		Kit(Player1,D5_GALLANT)
		Kit(Player1,D5_HERALD)
		Kit(Player1,D5_MEISTER)
		Kit(Player1,D5_JINXER)
		Kit(Player1,D5_HEXBLADE)
		Kit(Player1,D5_AGENT)
//		Kit(Player1,D5_LORESINGER)
  ~ THEN EXTERN ~RAELIS~ 59
END
>>>>>>>> 

COMPILE ~d5/raelis+.d~

// take guild away from bard, jester, skald, gallant, herald, meistersinger, loresinger

<<<<<<<< d5/renal+.d
ADD_TRANS_TRIGGER RENAL 7 ~!Kit(Player1,D5_BARD)
		!Kit(Player1,D5_BLADE)
		!Kit(Player1,D5_JESTER)
		!Kit(Player1,D5_MEISTER)
//		!Kit(Player1,D5_LORESINGER)~ DO 1
EXTEND_BOTTOM RENAL 7
  IF ~OR(5)
		Kit(Player1,D5_BARD)
		Kit(Player1,D5_BLADE)
		Kit(Player1,D5_JESTER)
		Kit(Player1,D5_MEISTER)
//		Kit(Player1,D5_LORESINGER)
  ~ THEN REPLY #21233 GOTO 18
END
>>>>>>>> 

COMPILE ~d5/renal+.d~

// give ranger cabin to meistersinger

<<<<<<<< d5/uhmayor+.d
EXTEND_BOTTOM UHMAY01 31
  IF ~ Global("PlayerHasStronghold","GLOBAL",0)
	Global("MayorPay","GLOBAL",0)
	OR(2)
	  Kit(Player1,D5_WHISTLER)
	  Kit(Player1,D5_MEISTER)
~ THEN GOTO 34
END 

EXTEND_BOTTOM UHMAY01 33
  IF ~  Global("PlayerHasStronghold","GLOBAL",0)
	OR(2)
	  Kit(Player1,D5_WHISTLER)
	  Kit(Player1,D5_MEISTER)
~ THEN GOTO 34
END
>>>>>>>> 

COMPILE ~d5/uhmayor+.d~

END	//	end game_is
//____________________________________________________________________________________


// IWDEE BARD INTERACTIONS____________________________________________________________
//
ACTION_IF GAME_IS ~iwdee~ BEGIN
/*
  COPY_EXISTING ~delisia.dlg~ ~OVERRIDE~
	DECOMPILE_AND_PATCH BEGIN
	  REPLACE_TEXTUALLY ~Class(LastTalkedToBy,BARD_ALL)~ ~OR(11)
		Class(LastTalkedToBy,BARD_ALL)
		Kit(LastTalkedToBy,D5_BARD)
		Kit(LastTalkedToBy,D5_BLADE)
		Kit(LastTalkedToBy,D5_JESTER)
		Kit(LastTalkedToBy,D5_SKALD)
		Kit(LastTalkedToBy,D5_GALLANT)
		Kit(LastTalkedToBy,D5_HERALD)
		Kit(LastTalkedToBy,D5_MEISTER)
		Kit(LastTalkedToBy,D5_JINXER)
		Kit(LastTalkedToBy,D5_HEXBLADE)
		Kit(LastTalkedToBy,D5_AGENT)
//		Kit(LastTalkedToBy,D5_LORESINGER)
~
	END
  BUT_ONLY
*/

<<<<<<<< d5/delisia+.d
EXTEND_BOTTOM DELISIA 0 
  IF ~Global("Bard_Greeting","GLOBAL",0)
  		OR(11)
		Kit(LastTalkedToBy,D5_BARD)
		Kit(LastTalkedToBy,D5_BLADE)
		Kit(LastTalkedToBy,D5_JESTER)
		Kit(LastTalkedToBy,D5_SKALD)
		Kit(LastTalkedToBy,D5_GALLANT)
		Kit(LastTalkedToBy,D5_HERALD)
		Kit(LastTalkedToBy,D5_MEISTER)
		Kit(LastTalkedToBy,D5_JINXER)
		Kit(LastTalkedToBy,D5_HEXBLADE)
//		Kit(LastTalkedToBy,D5_LORESINGER)
		Kit(LastTalkedToBy,D5_AGENT)~
	THEN REPLY #5153 
	DO ~SetGlobal("Bard_Greeting","GLOBAL",1)
		AddXP2DA("Level_1_Easy")
		DisplayStringNoNameDlg(Myself,30979)
		SetGlobal("Know_Elisia","GLOBAL",1)
		AddJournalEntry(23507,QUEST)~ 
	GOTO 3
  IF ~Global("Bard_Greeting","GLOBAL",1)
  		OR(11)
		Kit(LastTalkedToBy,D5_BARD)
		Kit(LastTalkedToBy,D5_BLADE)
		Kit(LastTalkedToBy,D5_JESTER)
		Kit(LastTalkedToBy,D5_SKALD)
		Kit(LastTalkedToBy,D5_GALLANT)
		Kit(LastTalkedToBy,D5_HERALD)
		Kit(LastTalkedToBy,D5_MEISTER)
		Kit(LastTalkedToBy,D5_JINXER)
		Kit(LastTalkedToBy,D5_HEXBLADE)
//		Kit(LastTalkedToBy,D5_LORESINGER)
		Kit(LastTalkedToBy,D5_AGENT)~ 
	THEN REPLY #5157 
	EXIT
END

EXTEND_BOTTOM DELISIA 1
  IF ~Global("Bard_Greeting","GLOBAL",0)
  		OR(11)
		Kit(LastTalkedToBy,D5_BARD)
		Kit(LastTalkedToBy,D5_BLADE)
		Kit(LastTalkedToBy,D5_JESTER)
		Kit(LastTalkedToBy,D5_SKALD)
		Kit(LastTalkedToBy,D5_GALLANT)
		Kit(LastTalkedToBy,D5_HERALD)
		Kit(LastTalkedToBy,D5_MEISTER)
		Kit(LastTalkedToBy,D5_JINXER)
		Kit(LastTalkedToBy,D5_HEXBLADE)
//		Kit(LastTalkedToBy,D5_LORESINGER)
		Kit(LastTalkedToBy,D5_AGENT)~
	THEN REPLY #5153 
	DO ~SetGlobal("Bard_Greeting","GLOBAL",1)
		AddXP2DA("Level_1_Easy")
		DisplayStringNoNameDlg(Myself,30979)~ 
	GOTO 3
  IF ~Global("Bard_Greeting","GLOBAL",1)
  		OR(11)
		Kit(LastTalkedToBy,D5_BARD)
		Kit(LastTalkedToBy,D5_BLADE)
		Kit(LastTalkedToBy,D5_JESTER)
		Kit(LastTalkedToBy,D5_SKALD)
		Kit(LastTalkedToBy,D5_GALLANT)
		Kit(LastTalkedToBy,D5_HERALD)
		Kit(LastTalkedToBy,D5_MEISTER)
		Kit(LastTalkedToBy,D5_JINXER)
		Kit(LastTalkedToBy,D5_HEXBLADE)
//		Kit(LastTalkedToBy,D5_LORESINGER)
		Kit(LastTalkedToBy,D5_AGENT)~
	THEN REPLY #5157 
	EXIT
END

EXTEND_BOTTOM DELISIA 10
  IF ~!Class(LastTalkedToBy,BARD_ALL)
	OR(11)
		Kit(LastTalkedToBy,D5_BARD)
		Kit(LastTalkedToBy,D5_BLADE)
		Kit(LastTalkedToBy,D5_JESTER)
		Kit(LastTalkedToBy,D5_SKALD)
		Kit(LastTalkedToBy,D5_GALLANT)
		Kit(LastTalkedToBy,D5_HERALD)
		Kit(LastTalkedToBy,D5_MEISTER)
		Kit(LastTalkedToBy,D5_JINXER)
		Kit(LastTalkedToBy,D5_HEXBLADE)
//		Kit(LastTalkedToBy,D5_LORESINGER)
		Kit(LastTalkedToBy,D5_AGENT)~ 
	THEN REPLY #34554 
	GOTO 13
END
>>>>>>>> 
COMPILE ~d5/delisia+.d~

END
//____________________________________________________________________________________

// SOD BARD INTERACTIONS______________________________________________________________
//
ACTION_IF FILE_EXISTS_IN_GAME ~bdaraya.dlg~ BEGIN

<<<<<<<< d5/bdaraya+.d
EXTEND_BOTTOM BDARAYA 2

IF ~CheckStatGT(Player1,12,CHR) 
	OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #54887  EXTERN ~bdmaxwel~ 2

IF ~CheckStatLT(Player1,13,CHR)
	OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #54887  GOTO 4
END
>>>>>>>> 
COMPILE ~d5/bdaraya+.d~

<<<<<<<< d5/bdautinn+.d
EXTEND_BOTTOM BDAUTINN 1

 IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #44392  GOTO 9
END
>>>>>>>> 
COMPILE ~d5/bdautinn+.d~

<<<<<<<< d5/BDBFORT4+.d
EXTEND_BOTTOM BDBFORT4 7
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #43682 DO ~GiveItemCreate("bdscrl3b",Player1,0,0,0)
~ GOTO 9
END
>>>>>>>> 
COMPILE ~d5/bdautinn+.d~

<<<<<<<< d5/BDCORWIJ+.d
EXTEND_BOTTOM BDCORWIJ 82
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #52066  GOTO 84
END
>>>>>>>> 
COMPILE ~d5/BDCORWIJ+.d~

<<<<<<<< d5/BDDELEND+.d
EXTEND_BOTTOM BDDELEND 14
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #44605 DO ~SetGlobal("BD_SDD117_PLAY","BD0108",1)
~ GOTO 24
END

EXTEND_BOTTOM BDDELEND 28
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #44640  GOTO 37
END

/* this is a condition for the state itself.  need to figure out how to do this
EXTEND_BOTTOM BDDELEND 46
IF ~ Class(Player1,BARD_ALL)
	Global("bd_delenda_conned","BD0108",1)
~ THEN BEGIN 46 
...
END
*/
>>>>>>>> 
COMPILE ~d5/BDDELEND+.d~

<<<<<<<< d5/BDDENELD+.d
EXTEND_BOTTOM BDDENELD 18
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #48995  GOTO 20
END

EXTEND_BOTTOM BDDENELD 36
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #62096  GOTO 37
END
>>>>>>>> 
COMPILE ~d5/BDDENELD+.d~

<<<<<<<< d5/BDDREON+.d
EXTEND_BOTTOM BDDREON 5
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #61237  GOTO 7
END
EXTEND_BOTTOM BDDREON 8
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #61246  GOTO 9
END
>>>>>>>> 
COMPILE ~d5/BDDREON+.d~

<<<<<<<< d5/BDDSSEN+.d
EXTEND_BOTTOM BDDSSEN 2
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #44056  GOTO 4
END

EXTEND_BOTTOM BDDSSEN 7
  IF ~OR(11)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #58567  GOTO 10
END
>>>>>>>> 
COMPILE ~d5/BDDSSEN+.d~

<<<<<<<< d5/BDFAMARI+.d
EXTEND_BOTTOM BDFAMARI 2
  IF ~ CheckStatGT(Player1,16,CHR)
   OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #58488  GOTO 3
END
>>>>>>>> 
COMPILE ~d5/BDFAMARI+.d~

<<<<<<<< d5/BDGUAR20+.d
EXTEND_BOTTOM BDGUAR20 18
  IF ~OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #64235  GOTO 19
END
>>>>>>>> 
COMPILE ~d5/BDGUAR20+.d~

<<<<<<<< d5/BDHESTER+.d
EXTEND_BOTTOM BDHESTER 6
  IF ~  OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #47990  GOTO 14

END

EXTEND_BOTTOM BDHESTER 7
  IF ~  OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #47998  GOTO 14
END
>>>>>>>> 
COMPILE ~d5/BDHESTER+.d~

<<<<<<<< d5/BDJENKS+.d
EXTEND_BOTTOM BDJENKS 3
  IF ~CheckStatGT(Player1,12,CHR)
  OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #58765  GOTO 4
END
>>>>>>>> 
COMPILE ~d5/BDJENKS+.d~

<<<<<<<< d5/BDJOSPIL+.d
EXTEND_BOTTOM BDJOSPIL 23
  IF ~  OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #44809  DO ~SetGlobal("bd_wah029","LOCALS",1)
	IncrementGlobal("bd_jospil_score","LOCALS",2)
~ GOTO 24
END
>>>>>>>> 
COMPILE ~d5/BDJOSPIL+.d~

<<<<<<<< d5/BDKATHEE+.d
EXTEND_BOTTOM BDKATHEE 8
  IF ~  OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #57619  GOTO 9
END
>>>>>>>> 
COMPILE ~d5/BDKATHEE+.d~

<<<<<<<< d5/BDKHALID+.d
EXTEND_BOTTOM BDKHALID 36
  IF ~  OR(14)
	CheckStatGT(Player1,14,INT)
	CheckStatGT(Player1,13,WIS)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #57945  GOTO 37
END
>>>>>>>> 
COMPILE ~d5/BDKHALID+.d~

<<<<<<<< d5/BDLEOPAS+.d
EXTEND_BOTTOM BDLEOPAS 20
  IF ~  OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #47853  EXTERN ~BDVALIS~ 24
END

EXTEND_BOTTOM BDLEOPAS 20
  IF ~  OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #47854  EXTERN ~BDCORINT~ 21
END

EXTEND_BOTTOM BDLEOPAS 20
  IF ~ CheckStatGT(Player1,15,CHR)
	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #47856  GOTO 28
END

EXTEND_BOTTOM BDLEOPAS 20
  IF ~ CheckStatLT(Player1,16,CHR)
	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #47856  GOTO 27
END
>>>>>>>> 
COMPILE ~d5/BDLEOPAS+.d~

<<<<<<<< d5/BDRASAAD+.d
EXTEND_BOTTOM BDRASAAD 20
  IF ~  IsValidForPartyDialogue("Safana")
	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #34589  DO ~SetGlobal("BD_Spoken_Rasaad","GLOBAL",1)
SetGlobal("bd_invited_rasaad","bd0111",1)
~ EXTERN ~BDSAFANJ~ 14
END

EXTEND_BOTTOM BDRASAAD 20
  IF ~  !IsValidForPartyDialogue("Safana")
	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #34589  DO ~SetGlobal("BD_Spoken_Rasaad","GLOBAL",1)
SetGlobal("bd_invited_rasaad","bd0111",1)
~ GOTO 21
END
>>>>>>>> 
COMPILE ~d5/BDRASAAD+.d~

<<<<<<<< d5/BDRIGAH+.d
EXTEND_BOTTOM BDRIGAH 20
  IF ~ 	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #52579  GOTO 21
END
>>>>>>>> 
COMPILE ~d5/BDRIGAH+.d~

<<<<<<<< d5/BDSHAPUR+.d
EXTEND_BOTTOM BDSHAPUR 8
  IF ~ 	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #41754  GOTO 14
END

EXTEND_BOTTOM BDSHAPUR 25
  IF ~ 	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
		OR(2)
	PartyHasItem("bdinsigc")
	PartyHasItem("bdinsigr")
~ THEN REPLY #41903  GOTO 26
END
>>>>>>>> 
COMPILE ~d5/BDSHAPUR+.d~

<<<<<<<< d5/BDSIMONE+.d
EXTEND_BOTTOM BDSIMONE 14
  IF ~ 	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #50976  GOTO 15
END
>>>>>>>> 
COMPILE ~d5/BDSIMONE+.d~

<<<<<<<< d5/BDSKIE+.d
EXTEND_BOTTOM BDSKIE 41
  IF ~ 	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #44078  GOTO 47
END

EXTEND_BOTTOM BDSKIE 45
  IF ~  OR(14)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
	CheckStatGT(Player1,14,INT)
	CheckStatGT(Player1,14,WIS)
~ THEN REPLY #44084  GOTO 46
END
>>>>>>>> 
COMPILE ~d5/BDSKIE+.d~

<<<<<<<< d5/BDTAKOS+.d
EXTEND_BOTTOM BDTAKOS 21
  IF ~ 	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #42957  GOTO 23
END

EXTEND_BOTTOM BDTAKOS 22
  IF ~ 	OR(12)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #42962  GOTO 23
END
>>>>>>>> 
COMPILE ~d5/BDTAKOS+.d~

<<<<<<<< d5/BDULORI+.d
EXTEND_BOTTOM BDULORI 3
  IF ~  Race(Player1,ELF)
	OR(12)
		Class(Player1,BARD_ALL)
		Kit(Player1,D5_BARD)
		Kit(Player1,D5_BLADE)
		Kit(Player1,D5_JESTER)
		Kit(Player1,D5_SKALD)
		Kit(Player1,D5_GALLANT)
		Kit(Player1,D5_HERALD)
		Kit(Player1,D5_MEISTER)
		Kit(Player1,D5_JINXER)
		Kit(Player1,D5_HEXBLADE)
//		Kit(Player1,D5_LORESINGER)
		Kit(Player1,D5_AGENT)
~ THEN REPLY #49207  GOTO 4
END

EXTEND_BOTTOM BDULORI 3
  IF ~  !Race(Player1,ELF)
	OR(12)
		Class(Player1,BARD_ALL)
		Kit(Player1,D5_BARD)
		Kit(Player1,D5_BLADE)
		Kit(Player1,D5_JESTER)
		Kit(Player1,D5_SKALD)
		Kit(Player1,D5_GALLANT)
		Kit(Player1,D5_HERALD)
		Kit(Player1,D5_MEISTER)
		Kit(Player1,D5_JINXER)
		Kit(Player1,D5_HEXBLADE)
//		Kit(Player1,D5_LORESINGER)
		Kit(Player1,D5_AGENT)
~ THEN REPLY #49207  GOTO 8
END
>>>>>>>> 
COMPILE ~d5/BDULORI+.d~

<<<<<<<< d5/BDWAIZAH+.d
EXTEND_BOTTOM BDWAIZAH 1
  IF ~  OR(13)
	CheckStatGT(Player1,13,CHR)
	Class(Player1,BARD_ALL)
	Kit(Player1,D5_BARD)
	Kit(Player1,D5_BLADE)
	Kit(Player1,D5_JESTER)
	Kit(Player1,D5_SKALD)
	Kit(Player1,D5_GALLANT)
	Kit(Player1,D5_HERALD)
	Kit(Player1,D5_MEISTER)
	Kit(Player1,D5_JINXER)
	Kit(Player1,D5_HEXBLADE)
//	Kit(Player1,D5_LORESINGER)
	Kit(Player1,D5_AGENT)
~ THEN REPLY #48805  GOTO 0
END
>>>>>>>> 
COMPILE ~d5/BDWAIZAH+.d~

END 	// 	end game includes sod
//____________________________________________________________________________________


//CHANGE SOD BARD'S HAT______________________________________________________________
//
// ... have to do something with Wondrous Gloves too

COPY ~might_and_guile/nubards/bdhelm11.itm~ ~override~
	SAY IDENTIFIED_DESC @21900
COPY ~might_and_guile/nubards/d5bdh11.spl~ ~override~
	SAY NAME1 @7
COPY ~might_and_guile/nubards/d5bdh11.eff~ ~override~
//	SAY NAME1 @7
//___________________________________________________________________________________


//MAKE +SPELL SLOT ITEMS WORK________________________________________________________
//
// make EFFs to increase spontaneous casting slots
ACTION_IF NOT FILE_EXISTS_IN_GAME ~d5slc1e.eff~ BEGIN
  CREATE EFF ~d5slc1e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 4)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC1E~ #8
  CREATE EFF ~d5slc2e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 8)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC2E~ #8
  CREATE EFF ~d5slc3e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 12)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC3E~ #8
  CREATE EFF ~d5slc4e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 16)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC4E~ #8
  CREATE EFF ~d5slc5e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 20)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC5E~ #8
  CREATE EFF ~d5slc6e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 24)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC6E~ #8
  CREATE EFF ~d5slc7e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 28)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC7E~ #8
  CREATE EFF ~d5slc8e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 24)
	WRITE_LONG 0x20 (109 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC8E~ #8
  CREATE EFF ~d5slc9e~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (1 << 28)
	WRITE_LONG 0x20 (109 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC9E~ #8
  CREATE EFF ~d5slc1f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 4)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC1F~ #8
  CREATE EFF ~d5slc2f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 8)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC2F~ #8
  CREATE EFF ~d5slc3f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 12)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC3F~ #8
  CREATE EFF ~d5slc4f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 16)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC4F~ #8
  CREATE EFF ~d5slc5f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 20)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC5F~ #8
  CREATE EFF ~d5slc6f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 24)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC6F~ #8
  CREATE EFF ~d5slc7f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 28)
	WRITE_LONG 0x20 (108 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC7F~ #8
  CREATE EFF ~d5slc8f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 24)
	WRITE_LONG 0x20 (109 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC8F~ #8
  CREATE EFF ~d5slc9f~
	WRITE_LONG 0x10 233
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c (2 << 28)
	WRITE_LONG 0x20 (109 + (0x10000 * 1))
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5SLC9F~ #8
END

ACTION_IF NOT FILE_EXISTS_IN_GAME ~d51l1spl.eff~ BEGIN
// make EFFs to increase traditional mem/cast slots by 1
  CREATE EFF ~d51l1spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L1SPL~ #8
  CREATE EFF ~d51l2spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 2
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L2SPL~ #8
  CREATE EFF ~d51l3spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 4
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L3SPL~ #8
  CREATE EFF ~d51l4spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 8
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L4SPL~ #8
  CREATE EFF ~d51l5spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 16
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L5SPL~ #8
  CREATE EFF ~d51l6spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 32
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L6SPL~ #8
  CREATE EFF ~d51l7spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 64
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L7SPL~ #8
  CREATE EFF ~d51l8spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 128
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L8SPL~ #8
  CREATE EFF ~d51l9spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 256
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D51L9SPL~ #8

// make EFFs to increase traditional mem/cast slots by 2
  CREATE EFF ~D52L1spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 1
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L1SPL~ #8
  CREATE EFF ~D52L2spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 2
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L2SPL~ #8
  CREATE EFF ~D52L3spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 4
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L3SPL~ #8
  CREATE EFF ~D52L4spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 8
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L4SPL~ #8
  CREATE EFF ~D52L5spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 16
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L5SPL~ #8
  CREATE EFF ~D52L6spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 32
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L6SPL~ #8
  CREATE EFF ~D52L7spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 64
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L7SPL~ #8
  CREATE EFF ~D52L8spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 128
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L8SPL~ #8
  CREATE EFF ~D52L9spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 256
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D52L9SPL~ #8

// make EFFs to double traditional mem/cast slots
  CREATE EFF ~D5XL1spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 1
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL1SPL~ #8
  CREATE EFF ~D5XL2spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 2
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL2SPL~ #8
  CREATE EFF ~D5XL3spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 3
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL3SPL~ #8
  CREATE EFF ~D5XL4spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 4
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL4SPL~ #8
  CREATE EFF ~D5XL5spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 5
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL5SPL~ #8
  CREATE EFF ~D5XL6spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 6
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL6SPL~ #8
  CREATE EFF ~D5XL7spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 7
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL7SPL~ #8
  CREATE EFF ~D5XL8spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 8
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL8SPL~ #8
  CREATE EFF ~D5XL9spl~
	WRITE_LONG 0x10 42
	WRITE_LONG 0x14 1
	WRITE_LONG 0x1c 9
	WRITE_LONG 0x20 0
	WRITE_LONG 0x24 2
	WRITE_SHORT 0x2c 100
	WRITE_LONG 0x90 1
	WRITE_EVALUATED_ASCII 0x94 ~D5XL9SPL~ #8

 OUTER_SET mageslot_item_ind = 0
 OUTER_SPRINT $mage_slot_items(~%mageslot_item_ind%~) ~mage_slot_item~
 COPY_EXISTING_REGEXP GLOB ~^.+\.itm$~ ~override~
  PATCH_IF (%SOURCE_SIZE% > 0x72) BEGIN
  	SET plus_slots = 0
	READ_LONG 0x6a effectsoffset ELSE 0
	READ_SHORT 0x70 effectscount ELSE 0
	FOR (effcyc = 0; effcyc < effectscount; effcyc = effcyc + 1) BEGIN
	  READ_SHORT (effectsoffset + (effcyc * 0x30)) opcode ELSE 0
	  PATCH_IF (opcode = 42) BEGIN
		SET plus_slots = 1
	  END
	END
	PATCH_IF (plus_slots = 1) BEGIN
	  SPRINT $mage_slot_items(~%mageslot_item_ind%~) ~%SOURCE_RES%~
	  SET ++mageslot_item_ind
	END
  END
 BUT_ONLY
	  
 ACTION_PHP_EACH mage_slot_items AS ind => slot_item BEGIN
  COPY_EXISTING ~%slot_item%.itm~ ~override~
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 1   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc1e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 2   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc2e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 4   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc3e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 8   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc4e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 16  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc5e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 32  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc6e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 64  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc7e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 128 opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc8e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 256 opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc9e~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 1   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc1f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 2   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc2f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 4   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc3f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 8   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc4f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 16  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc5f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 32  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc6f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 64  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc7f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 128 opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc8f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 256 opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5slc9f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 0   opcode = 177 parameter1 = 1 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc1f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 0   opcode = 177 parameter1 = 2 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc2f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 3 match_parameter2 = 0   opcode = 177 parameter1 = 3 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc3f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 4 match_parameter2 = 0   opcode = 177 parameter1 = 4 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc4f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 5 match_parameter2 = 0   opcode = 177 parameter1 = 5 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc5f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 6 match_parameter2 = 0   opcode = 177 parameter1 = 6 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc6f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 7 match_parameter2 = 0   opcode = 177 parameter1 = 7 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc7f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 8 match_parameter2 = 0   opcode = 177 parameter1 = 8 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc8f~ insert = ~first~ END
	LPF CLONE_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 9 match_parameter2 = 0   opcode = 177 parameter1 = 9 parameter2 = 0 timing = 2 STR_VAR resource = ~d5slc9f~ insert = ~first~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 1   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l1spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 2   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l2spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 4   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l3spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 8   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l4spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 16  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l5spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 32  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l6spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 64  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l7spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 128 opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l8spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 256 opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d51l9spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 1   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l1spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 2   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l2spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 4   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l3spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 8   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l4spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 16  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l5spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 32  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l6spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 64  opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l7spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 128 opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l8spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 256 opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d52l9spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 1 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl1spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 2 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl2spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 3 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl3spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 4 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl4spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 5 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl5spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 6 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl6spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 7 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl7spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 8 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl8spl~ END
	LPF ALTER_EFFECT INT_VAR silent = 1 multi_match = 1 match_opcode = 42 match_parameter1 = 9 match_parameter2 = 0   opcode = 177 parameter1 = 0 parameter2 = 2 timing = 2 STR_VAR resource = ~d5xl9spl~ END
	LPF ADD_ITEM_EQEFFECT INT_VAR insert_point = 0 opcode = 318 target = 1 parameter1 = 202 parameter2 = 115 timing = 2 STR_VAR resource = EVAL ~%SOURCE_RES%~ END
	LPF ADD_ITEM_EQEFFECT INT_VAR opcode = 146 target = 1 parameter2 = 1 timing = 1 STR_VAR resource = ~d5bsplz~ END
  IF_EXISTS BUT_ONLY
 END

END // end if not already done
//___________________________________________________________________________________


//HUMANS CAN BE MULTICLASS BARDS______________________________________________________
//
ACTION_IF FILE_EXISTS_IN_GAME ~CLSRCREQ.2da~ BEGIN
  COPY_EXISTING ~clsrcreq.2da~ ~override~
	COUNT_2DA_ROWS 8 rows
	FOR (row = 0 ; row < rows ; ++row) BEGIN
      READ_2DA_ENTRY row 0 8 entry
      PATCH_IF ("%entry%" STRING_COMPARE_CASE "FIGHTER_MAGE"      = 0) OR
                ("%entry%" STRING_COMPARE_CASE "FIGHTER_THIEF" 	 = 0) OR
                ("%entry%" STRING_COMPARE_CASE "MAGE_THIEF" 	 = 0) OR
                ("%entry%" STRING_COMPARE_CASE "CLERIC_THIEF" 	 = 0) BEGIN
    	SET_2DA_ENTRY  row 1 8 1
    	SET_2DA_ENTRY  row 2 8 1
    	SET_2DA_ENTRY  row 3 8 1
      END
	END
  BUT_ONLY
END

/* don't think need to do this.  also why did I limit it to humans??
ACTION_FOR_EACH multi IN ~FM~ ~MT~ BEGIN
  ACTION_IF FILE_EXISTS_IN_GAME ~K_%multi%_H.2da~ BEGIN
	COPY_EXISTING ~K_%multi%_H.2da~ ~override~
	  COUNT_2DA_COLS cols
	  READ_2DA_ENTRIES_NOW rows cols
	  SET rows_removed = 0
	  FOR (row = 1; row < rows; ++row) BEGIN
		READ_2DA_ENTRY_FORMER rows row 1 kit
		PATCH_IF (%kit% = 0) BEGIN
		  REMOVE_2DA_ROW (row - rows_removed) cols
		  SET rows_removed += 1
		END
	  END
	BUT_ONLY
  END
END
*/
//____________________________________________________________________________________


//DISABLE OLD BARD KITS_______________________________________________________________
//
ACTION_FOR_EACH race IN ~D~ ~E~ ~G~ ~H~ ~HE~ ~HL~ ~HO~ BEGIN
  ACTION_IF FILE_EXISTS_IN_GAME ~K_B_%race%.2da~ BEGIN
	COPY_EXISTING ~K_B_%race%.2da~ ~override~
	  COUNT_2DA_COLS cols
	  READ_2DA_ENTRIES_NOW rows cols
	  SET rows_removed = 0
	  FOR (row = 1; row < rows; ++row) BEGIN
		READ_2DA_ENTRY_FORMER rows row 1 kit
		PATCH_IF (%kit% = 0) OR 
		  		 (%kit% = 13) OR 
		  		 (%kit% = 14) OR 
		  		 (%kit% = 15) BEGIN
		  REMOVE_2DA_ROW (row - rows_removed) cols
		  SET rows_removed += 1
		END
	  END
	BUT_ONLY
  END
END

// and change clsrcreq.2da etc.
ACTION_IF FILE_EXISTS_IN_GAME ~CLSRCREQ.2da~ BEGIN
  COPY_EXISTING ~clsrcreq.2da~ ~override~
	COUNT_2DA_ROWS 8 rows
	FOR (row = 0 ; row < rows ; ++row) BEGIN
      READ_2DA_ENTRY row 0 8 entry
      PATCH_IF (("%entry%" STRING_COMPARE_CASE "BLADE"		= 0) OR
                ("%entry%" STRING_COMPARE_CASE "JESTER"		= 0) OR
                ("%entry%" STRING_COMPARE_CASE "SKALD"		= 0)) BEGIN
		SET_2DA_ENTRY  row 1 8 0
		SET_2DA_ENTRY  row 2 8 0
		SET_2DA_ENTRY  row 3 8 0
		SET_2DA_ENTRY  row 4 8 0
		SET_2DA_ENTRY  row 5 8 0
		SET_2DA_ENTRY  row 6 8 0
		SET_2DA_ENTRY  row 7 8 0
      END
	END
  BUT_ONLY
END
//___________________________________________________________________________________

